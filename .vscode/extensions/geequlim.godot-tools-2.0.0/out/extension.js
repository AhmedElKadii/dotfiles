var Wy=Object.create;var Ps=Object.defineProperty;var Hy=Object.getOwnPropertyDescriptor;var Ky=Object.getOwnPropertyNames;var Yy=Object.getPrototypeOf,Xy=Object.prototype.hasOwnProperty;var Qy=(r,e,t)=>e in r?Ps(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var B=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Zy=(r,e)=>{for(var t in e)Ps(r,t,{get:e[t],enumerable:!0})},Jh=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ky(e))!Xy.call(r,i)&&i!==t&&Ps(r,i,{get:()=>e[i],enumerable:!(n=Hy(e,i))||n.enumerable});return r};var Se=(r,e,t)=>(t=r!=null?Wy(Yy(r)):{},Jh(e||!r||!r.__esModule?Ps(t,"default",{value:r,enumerable:!0}):t,r)),Jy=r=>Jh(Ps({},"__esModule",{value:!0}),r);var ep=(r,e,t)=>(Qy(r,typeof e!="symbol"?e+"":e,t),t);var Ns=B((cO,vp)=>{var uw="2.0.0",lw=Number.MAX_SAFE_INTEGER||9007199254740991,dw=16,fw=256-6,hw=["major","premajor","minor","preminor","patch","prepatch","prerelease"];vp.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:dw,MAX_SAFE_BUILD_LENGTH:fw,MAX_SAFE_INTEGER:lw,RELEASE_TYPES:hw,SEMVER_SPEC_VERSION:uw,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Ls=B((uO,yp)=>{var pw=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};yp.exports=pw});var Ii=B((or,wp)=>{var{MAX_SAFE_COMPONENT_LENGTH:uu,MAX_SAFE_BUILD_LENGTH:gw,MAX_LENGTH:mw}=Ns(),_w=Ls();or=wp.exports={};var bw=or.re=[],vw=or.safeRe=[],ce=or.src=[],ue=or.t={},yw=0,lu="[a-zA-Z0-9-]",ww=[["\\s",1],["\\d",mw],[lu,gw]],Rw=r=>{for(let[e,t]of ww)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},Fe=(r,e,t)=>{let n=Rw(e),i=yw++;_w(r,i,e),ue[r]=i,ce[i]=e,bw[i]=new RegExp(e,t?"g":void 0),vw[i]=new RegExp(n,t?"g":void 0)};Fe("NUMERICIDENTIFIER","0|[1-9]\\d*");Fe("NUMERICIDENTIFIERLOOSE","\\d+");Fe("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${lu}*`);Fe("MAINVERSION",`(${ce[ue.NUMERICIDENTIFIER]})\\.(${ce[ue.NUMERICIDENTIFIER]})\\.(${ce[ue.NUMERICIDENTIFIER]})`);Fe("MAINVERSIONLOOSE",`(${ce[ue.NUMERICIDENTIFIERLOOSE]})\\.(${ce[ue.NUMERICIDENTIFIERLOOSE]})\\.(${ce[ue.NUMERICIDENTIFIERLOOSE]})`);Fe("PRERELEASEIDENTIFIER",`(?:${ce[ue.NUMERICIDENTIFIER]}|${ce[ue.NONNUMERICIDENTIFIER]})`);Fe("PRERELEASEIDENTIFIERLOOSE",`(?:${ce[ue.NUMERICIDENTIFIERLOOSE]}|${ce[ue.NONNUMERICIDENTIFIER]})`);Fe("PRERELEASE",`(?:-(${ce[ue.PRERELEASEIDENTIFIER]}(?:\\.${ce[ue.PRERELEASEIDENTIFIER]})*))`);Fe("PRERELEASELOOSE",`(?:-?(${ce[ue.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ce[ue.PRERELEASEIDENTIFIERLOOSE]})*))`);Fe("BUILDIDENTIFIER",`${lu}+`);Fe("BUILD",`(?:\\+(${ce[ue.BUILDIDENTIFIER]}(?:\\.${ce[ue.BUILDIDENTIFIER]})*))`);Fe("FULLPLAIN",`v?${ce[ue.MAINVERSION]}${ce[ue.PRERELEASE]}?${ce[ue.BUILD]}?`);Fe("FULL",`^${ce[ue.FULLPLAIN]}$`);Fe("LOOSEPLAIN",`[v=\\s]*${ce[ue.MAINVERSIONLOOSE]}${ce[ue.PRERELEASELOOSE]}?${ce[ue.BUILD]}?`);Fe("LOOSE",`^${ce[ue.LOOSEPLAIN]}$`);Fe("GTLT","((?:<|>)?=?)");Fe("XRANGEIDENTIFIERLOOSE",`${ce[ue.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);Fe("XRANGEIDENTIFIER",`${ce[ue.NUMERICIDENTIFIER]}|x|X|\\*`);Fe("XRANGEPLAIN",`[v=\\s]*(${ce[ue.XRANGEIDENTIFIER]})(?:\\.(${ce[ue.XRANGEIDENTIFIER]})(?:\\.(${ce[ue.XRANGEIDENTIFIER]})(?:${ce[ue.PRERELEASE]})?${ce[ue.BUILD]}?)?)?`);Fe("XRANGEPLAINLOOSE",`[v=\\s]*(${ce[ue.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[ue.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[ue.XRANGEIDENTIFIERLOOSE]})(?:${ce[ue.PRERELEASELOOSE]})?${ce[ue.BUILD]}?)?)?`);Fe("XRANGE",`^${ce[ue.GTLT]}\\s*${ce[ue.XRANGEPLAIN]}$`);Fe("XRANGELOOSE",`^${ce[ue.GTLT]}\\s*${ce[ue.XRANGEPLAINLOOSE]}$`);Fe("COERCE",`(^|[^\\d])(\\d{1,${uu}})(?:\\.(\\d{1,${uu}}))?(?:\\.(\\d{1,${uu}}))?(?:$|[^\\d])`);Fe("COERCERTL",ce[ue.COERCE],!0);Fe("LONETILDE","(?:~>?)");Fe("TILDETRIM",`(\\s*)${ce[ue.LONETILDE]}\\s+`,!0);or.tildeTrimReplace="$1~";Fe("TILDE",`^${ce[ue.LONETILDE]}${ce[ue.XRANGEPLAIN]}$`);Fe("TILDELOOSE",`^${ce[ue.LONETILDE]}${ce[ue.XRANGEPLAINLOOSE]}$`);Fe("LONECARET","(?:\\^)");Fe("CARETTRIM",`(\\s*)${ce[ue.LONECARET]}\\s+`,!0);or.caretTrimReplace="$1^";Fe("CARET",`^${ce[ue.LONECARET]}${ce[ue.XRANGEPLAIN]}$`);Fe("CARETLOOSE",`^${ce[ue.LONECARET]}${ce[ue.XRANGEPLAINLOOSE]}$`);Fe("COMPARATORLOOSE",`^${ce[ue.GTLT]}\\s*(${ce[ue.LOOSEPLAIN]})$|^$`);Fe("COMPARATOR",`^${ce[ue.GTLT]}\\s*(${ce[ue.FULLPLAIN]})$|^$`);Fe("COMPARATORTRIM",`(\\s*)${ce[ue.GTLT]}\\s*(${ce[ue.LOOSEPLAIN]}|${ce[ue.XRANGEPLAIN]})`,!0);or.comparatorTrimReplace="$1$2$3";Fe("HYPHENRANGE",`^\\s*(${ce[ue.XRANGEPLAIN]})\\s+-\\s+(${ce[ue.XRANGEPLAIN]})\\s*$`);Fe("HYPHENRANGELOOSE",`^\\s*(${ce[ue.XRANGEPLAINLOOSE]})\\s+-\\s+(${ce[ue.XRANGEPLAINLOOSE]})\\s*$`);Fe("STAR","(<|>)?=?\\s*\\*");Fe("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");Fe("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Jo=B((lO,Rp)=>{var Sw=Object.freeze({loose:!0}),Cw=Object.freeze({}),xw=r=>r?typeof r!="object"?Sw:r:Cw;Rp.exports=xw});var du=B((dO,xp)=>{var Sp=/^[0-9]+$/,Cp=(r,e)=>{let t=Sp.test(r),n=Sp.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},Ew=(r,e)=>Cp(e,r);xp.exports={compareIdentifiers:Cp,rcompareIdentifiers:Ew}});var Wt=B((fO,Pp)=>{var ea=Ls(),{MAX_LENGTH:Ep,MAX_SAFE_INTEGER:ta}=Ns(),{safeRe:kp,t:Tp}=Ii(),kw=Jo(),{compareIdentifiers:Di}=du(),_n=class{constructor(e,t){if(t=kw(t),e instanceof _n){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ep)throw new TypeError(`version is longer than ${Ep} characters`);ea("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?kp[Tp.LOOSE]:kp[Tp.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ta||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ta||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ta||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<ta)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ea("SemVer.compare",this.version,this.options,e),!(e instanceof _n)){if(typeof e=="string"&&e===this.version)return 0;e=new _n(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof _n||(e=new _n(e,this.options)),Di(this.major,e.major)||Di(this.minor,e.minor)||Di(this.patch,e.patch)}comparePre(e){if(e instanceof _n||(e=new _n(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(ea("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Di(n,i)}while(++t)}compareBuild(e){e instanceof _n||(e=new _n(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(ea("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Di(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];n===!1&&(s=[t]),Di(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Pp.exports=_n});var Wr=B((hO,Dp)=>{var Ip=Wt(),Tw=(r,e,t=!1)=>{if(r instanceof Ip)return r;try{return new Ip(r,e)}catch(n){if(!t)return null;throw n}};Dp.exports=Tw});var Ap=B((pO,Op)=>{var Pw=Wr(),Iw=(r,e)=>{let t=Pw(r,e);return t?t.version:null};Op.exports=Iw});var Lp=B((gO,Np)=>{var Dw=Wr(),Ow=(r,e)=>{let t=Dw(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Np.exports=Ow});var Mp=B((mO,Fp)=>{var qp=Wt(),Aw=(r,e,t,n,i)=>{typeof t=="string"&&(i=n,n=t,t=void 0);try{return new qp(r instanceof qp?r.version:r,t).inc(e,n,i).version}catch{return null}};Fp.exports=Aw});var Bp=B((_O,jp)=>{var $p=Wr(),Nw=(r,e)=>{let t=$p(r,null,!0),n=$p(e,null,!0),i=t.compare(n);if(i===0)return null;let s=i>0,o=s?t:n,a=s?n:t,c=!!o.prerelease.length;if(!!a.prerelease.length&&!c)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";let h=c?"pre":"";return t.major!==n.major?h+"major":t.minor!==n.minor?h+"minor":t.patch!==n.patch?h+"patch":"prerelease"};jp.exports=Nw});var zp=B((bO,Up)=>{var Lw=Wt(),qw=(r,e)=>new Lw(r,e).major;Up.exports=qw});var Vp=B((vO,Gp)=>{var Fw=Wt(),Mw=(r,e)=>new Fw(r,e).minor;Gp.exports=Mw});var Hp=B((yO,Wp)=>{var $w=Wt(),jw=(r,e)=>new $w(r,e).patch;Wp.exports=jw});var Yp=B((wO,Kp)=>{var Bw=Wr(),Uw=(r,e)=>{let t=Bw(r,e);return t&&t.prerelease.length?t.prerelease:null};Kp.exports=Uw});var xn=B((RO,Qp)=>{var Xp=Wt(),zw=(r,e,t)=>new Xp(r,t).compare(new Xp(e,t));Qp.exports=zw});var Jp=B((SO,Zp)=>{var Gw=xn(),Vw=(r,e,t)=>Gw(e,r,t);Zp.exports=Vw});var tg=B((CO,eg)=>{var Ww=xn(),Hw=(r,e)=>Ww(r,e,!0);eg.exports=Hw});var na=B((xO,rg)=>{var ng=Wt(),Kw=(r,e,t)=>{let n=new ng(r,t),i=new ng(e,t);return n.compare(i)||n.compareBuild(i)};rg.exports=Kw});var sg=B((EO,ig)=>{var Yw=na(),Xw=(r,e)=>r.sort((t,n)=>Yw(t,n,e));ig.exports=Xw});var ag=B((kO,og)=>{var Qw=na(),Zw=(r,e)=>r.sort((t,n)=>Qw(n,t,e));og.exports=Zw});var qs=B((TO,cg)=>{var Jw=xn(),eR=(r,e,t)=>Jw(r,e,t)>0;cg.exports=eR});var ra=B((PO,ug)=>{var tR=xn(),nR=(r,e,t)=>tR(r,e,t)<0;ug.exports=nR});var fu=B((IO,lg)=>{var rR=xn(),iR=(r,e,t)=>rR(r,e,t)===0;lg.exports=iR});var hu=B((DO,dg)=>{var sR=xn(),oR=(r,e,t)=>sR(r,e,t)!==0;dg.exports=oR});var ia=B((OO,fg)=>{var aR=xn(),cR=(r,e,t)=>aR(r,e,t)>=0;fg.exports=cR});var sa=B((AO,hg)=>{var uR=xn(),lR=(r,e,t)=>uR(r,e,t)<=0;hg.exports=lR});var pu=B((NO,pg)=>{var dR=fu(),fR=hu(),hR=qs(),pR=ia(),gR=ra(),mR=sa(),_R=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return dR(r,t,n);case"!=":return fR(r,t,n);case">":return hR(r,t,n);case">=":return pR(r,t,n);case"<":return gR(r,t,n);case"<=":return mR(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};pg.exports=_R});var mg=B((LO,gg)=>{var bR=Wt(),vR=Wr(),{safeRe:oa,t:aa}=Ii(),yR=(r,e)=>{if(r instanceof bR)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(oa[aa.COERCE]);else{let n;for(;(n=oa[aa.COERCERTL].exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||n.index+n[0].length!==t.index+t[0].length)&&(t=n),oa[aa.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;oa[aa.COERCERTL].lastIndex=-1}return t===null?null:vR(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};gg.exports=yR});var bg=B((qO,_g)=>{"use strict";_g.exports=function(r){r.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var yg=B((FO,vg)=>{"use strict";vg.exports=ze;ze.Node=Hr;ze.create=ze;function ze(r){var e=this;if(e instanceof ze||(e=new ze),e.tail=null,e.head=null,e.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)e.push(arguments[t]);return e}ze.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var e=r.next,t=r.prev;return e&&(e.prev=t),t&&(t.next=e),r===this.head&&(this.head=e),r===this.tail&&(this.tail=t),r.list.length--,r.next=null,r.prev=null,r.list=null,e};ze.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var e=this.head;r.list=this,r.next=e,e&&(e.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};ze.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var e=this.tail;r.list=this,r.prev=e,e&&(e.next=r),this.tail=r,this.head||(this.head=r),this.length++}};ze.prototype.push=function(){for(var r=0,e=arguments.length;r<e;r++)RR(this,arguments[r]);return this.length};ze.prototype.unshift=function(){for(var r=0,e=arguments.length;r<e;r++)SR(this,arguments[r]);return this.length};ze.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};ze.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};ze.prototype.forEach=function(r,e){e=e||this;for(var t=this.head,n=0;t!==null;n++)r.call(e,t.value,n,this),t=t.next};ze.prototype.forEachReverse=function(r,e){e=e||this;for(var t=this.tail,n=this.length-1;t!==null;n--)r.call(e,t.value,n,this),t=t.prev};ze.prototype.get=function(r){for(var e=0,t=this.head;t!==null&&e<r;e++)t=t.next;if(e===r&&t!==null)return t.value};ze.prototype.getReverse=function(r){for(var e=0,t=this.tail;t!==null&&e<r;e++)t=t.prev;if(e===r&&t!==null)return t.value};ze.prototype.map=function(r,e){e=e||this;for(var t=new ze,n=this.head;n!==null;)t.push(r.call(e,n.value,this)),n=n.next;return t};ze.prototype.mapReverse=function(r,e){e=e||this;for(var t=new ze,n=this.tail;n!==null;)t.push(r.call(e,n.value,this)),n=n.prev;return t};ze.prototype.reduce=function(r,e){var t,n=this.head;if(arguments.length>1)t=e;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)t=r(t,n.value,i),n=n.next;return t};ze.prototype.reduceReverse=function(r,e){var t,n=this.tail;if(arguments.length>1)t=e;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)t=r(t,n.value,i),n=n.prev;return t};ze.prototype.toArray=function(){for(var r=new Array(this.length),e=0,t=this.head;t!==null;e++)r[e]=t.value,t=t.next;return r};ze.prototype.toArrayReverse=function(){for(var r=new Array(this.length),e=0,t=this.tail;t!==null;e++)r[e]=t.value,t=t.prev;return r};ze.prototype.slice=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new ze;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<e;n++,i=i.next)t.push(i.value);return t};ze.prototype.sliceReverse=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new ze;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=this.length,i=this.tail;i!==null&&n>e;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)t.push(i.value);return t};ze.prototype.splice=function(r,e,...t){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var s=[],n=0;i&&n<e;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<t.length;n++)i=wR(this,i,t[n]);return s};ze.prototype.reverse=function(){for(var r=this.head,e=this.tail,t=r;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=e,this.tail=r,this};function wR(r,e,t){var n=e===r.head?new Hr(t,null,e,r):new Hr(t,e,e.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function RR(r,e){r.tail=new Hr(e,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function SR(r,e){r.head=new Hr(e,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function Hr(r,e,t,n){if(!(this instanceof Hr))return new Hr(r,e,t,n);this.list=n,this.value=r,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{bg()(ze)}catch{}});var xg=B((MO,Cg)=>{"use strict";var CR=yg(),Kr=Symbol("max"),cr=Symbol("length"),Oi=Symbol("lengthCalculator"),Ms=Symbol("allowStale"),Yr=Symbol("maxAge"),ar=Symbol("dispose"),wg=Symbol("noDisposeOnSet"),Pt=Symbol("lruList"),Dn=Symbol("cache"),Sg=Symbol("updateAgeOnGet"),gu=()=>1,_u=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[Kr]=e.max||1/0,n=e.length||gu;if(this[Oi]=typeof n!="function"?gu:n,this[Ms]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Yr]=e.maxAge||0,this[ar]=e.dispose,this[wg]=e.noDisposeOnSet||!1,this[Sg]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Kr]=e||1/0,Fs(this)}get max(){return this[Kr]}set allowStale(e){this[Ms]=!!e}get allowStale(){return this[Ms]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Yr]=e,Fs(this)}get maxAge(){return this[Yr]}set lengthCalculator(e){typeof e!="function"&&(e=gu),e!==this[Oi]&&(this[Oi]=e,this[cr]=0,this[Pt].forEach(t=>{t.length=this[Oi](t.value,t.key),this[cr]+=t.length})),Fs(this)}get lengthCalculator(){return this[Oi]}get length(){return this[cr]}get itemCount(){return this[Pt].length}rforEach(e,t){t=t||this;for(let n=this[Pt].tail;n!==null;){let i=n.prev;Rg(this,e,n,t),n=i}}forEach(e,t){t=t||this;for(let n=this[Pt].head;n!==null;){let i=n.next;Rg(this,e,n,t),n=i}}keys(){return this[Pt].toArray().map(e=>e.key)}values(){return this[Pt].toArray().map(e=>e.value)}reset(){this[ar]&&this[Pt]&&this[Pt].length&&this[Pt].forEach(e=>this[ar](e.key,e.value)),this[Dn]=new Map,this[Pt]=new CR,this[cr]=0}dump(){return this[Pt].map(e=>ca(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Pt]}set(e,t,n){if(n=n||this[Yr],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let i=n?Date.now():0,s=this[Oi](t,e);if(this[Dn].has(e)){if(s>this[Kr])return Ai(this,this[Dn].get(e)),!1;let c=this[Dn].get(e).value;return this[ar]&&(this[wg]||this[ar](e,c.value)),c.now=i,c.maxAge=n,c.value=t,this[cr]+=s-c.length,c.length=s,this.get(e),Fs(this),!0}let o=new bu(e,t,s,i,n);return o.length>this[Kr]?(this[ar]&&this[ar](e,t),!1):(this[cr]+=o.length,this[Pt].unshift(o),this[Dn].set(e,this[Pt].head),Fs(this),!0)}has(e){if(!this[Dn].has(e))return!1;let t=this[Dn].get(e).value;return!ca(this,t)}get(e){return mu(this,e,!0)}peek(e){return mu(this,e,!1)}pop(){let e=this[Pt].tail;return e?(Ai(this,e),e.value):null}del(e){Ai(this,this[Dn].get(e))}load(e){this.reset();let t=Date.now();for(let n=e.length-1;n>=0;n--){let i=e[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[Dn].forEach((e,t)=>mu(this,t,!1))}},mu=(r,e,t)=>{let n=r[Dn].get(e);if(n){let i=n.value;if(ca(r,i)){if(Ai(r,n),!r[Ms])return}else t&&(r[Sg]&&(n.value.now=Date.now()),r[Pt].unshiftNode(n));return i.value}},ca=(r,e)=>{if(!e||!e.maxAge&&!r[Yr])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:r[Yr]&&t>r[Yr]},Fs=r=>{if(r[cr]>r[Kr])for(let e=r[Pt].tail;r[cr]>r[Kr]&&e!==null;){let t=e.prev;Ai(r,e),e=t}},Ai=(r,e)=>{if(e){let t=e.value;r[ar]&&r[ar](t.key,t.value),r[cr]-=t.length,r[Dn].delete(t.key),r[Pt].removeNode(e)}},bu=class{constructor(e,t,n,i,s){this.key=e,this.value=t,this.length=n,this.now=i,this.maxAge=s||0}},Rg=(r,e,t,n)=>{let i=t.value;ca(r,i)&&(Ai(r,t),r[Ms]||(i=void 0)),i&&e.call(n,i.value,i.key,r)};Cg.exports=_u});var En=B(($O,Pg)=>{var Xr=class{constructor(e,t){if(t=ER(t),e instanceof Xr)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Xr(e.raw,t);if(e instanceof vu)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!kg(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&AR(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&DR)|(this.options.loose&&OR))+":"+e,i=Eg.get(n);if(i)return i;let s=this.options.loose,o=s?dn[rn.HYPHENRANGELOOSE]:dn[rn.HYPHENRANGE];e=e.replace(o,zR(this.options.includePrerelease)),at("hyphen replace",e),e=e.replace(dn[rn.COMPARATORTRIM],TR),at("comparator trim",e),e=e.replace(dn[rn.TILDETRIM],PR),at("tilde trim",e),e=e.replace(dn[rn.CARETTRIM],IR),at("caret trim",e);let a=e.split(" ").map(v=>NR(v,this.options)).join(" ").split(/\s+/).map(v=>UR(v,this.options));s&&(a=a.filter(v=>(at("loose invalid filter",v,this.options),!!v.match(dn[rn.COMPARATORLOOSE])))),at("range list",a);let c=new Map,u=a.map(v=>new vu(v,this.options));for(let v of u){if(kg(v))return[v];c.set(v.value,v)}c.size>1&&c.has("")&&c.delete("");let h=[...c.values()];return Eg.set(n,h),h}intersects(e,t){if(!(e instanceof Xr))throw new TypeError("a Range is required");return this.set.some(n=>Tg(n,t)&&e.set.some(i=>Tg(i,t)&&n.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new kR(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(GR(this.set[t],e,this.options))return!0;return!1}};Pg.exports=Xr;var xR=xg(),Eg=new xR({max:1e3}),ER=Jo(),vu=$s(),at=Ls(),kR=Wt(),{safeRe:dn,t:rn,comparatorTrimReplace:TR,tildeTrimReplace:PR,caretTrimReplace:IR}=Ii(),{FLAG_INCLUDE_PRERELEASE:DR,FLAG_LOOSE:OR}=Ns(),kg=r=>r.value==="<0.0.0-0",AR=r=>r.value==="",Tg=(r,e)=>{let t=!0,n=r.slice(),i=n.pop();for(;t&&n.length;)t=n.every(s=>i.intersects(s,e)),i=n.pop();return t},NR=(r,e)=>(at("comp",r,e),r=FR(r,e),at("caret",r),r=LR(r,e),at("tildes",r),r=$R(r,e),at("xrange",r),r=BR(r,e),at("stars",r),r),sn=r=>!r||r.toLowerCase()==="x"||r==="*",LR=(r,e)=>r.trim().split(/\s+/).map(t=>qR(t,e)).join(" "),qR=(r,e)=>{let t=e.loose?dn[rn.TILDELOOSE]:dn[rn.TILDE];return r.replace(t,(n,i,s,o,a)=>{at("tilde",r,n,i,s,o,a);let c;return sn(i)?c="":sn(s)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:sn(o)?c=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(at("replaceTilde pr",a),c=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):c=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,at("tilde return",c),c})},FR=(r,e)=>r.trim().split(/\s+/).map(t=>MR(t,e)).join(" "),MR=(r,e)=>{at("caret",r,e);let t=e.loose?dn[rn.CARETLOOSE]:dn[rn.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(i,s,o,a,c)=>{at("caret",r,i,s,o,a,c);let u;return sn(s)?u="":sn(o)?u=`>=${s}.0.0${n} <${+s+1}.0.0-0`:sn(a)?s==="0"?u=`>=${s}.${o}.0${n} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.0${n} <${+s+1}.0.0-0`:c?(at("replaceCaret pr",c),s==="0"?o==="0"?u=`>=${s}.${o}.${a}-${c} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}-${c} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a}-${c} <${+s+1}.0.0-0`):(at("no pr"),s==="0"?o==="0"?u=`>=${s}.${o}.${a}${n} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}${n} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),at("caret return",u),u})},$R=(r,e)=>(at("replaceXRanges",r,e),r.split(/\s+/).map(t=>jR(t,e)).join(" ")),jR=(r,e)=>{r=r.trim();let t=e.loose?dn[rn.XRANGELOOSE]:dn[rn.XRANGE];return r.replace(t,(n,i,s,o,a,c)=>{at("xRange",r,n,i,s,o,a,c);let u=sn(s),h=u||sn(o),v=h||sn(a),m=v;return i==="="&&m&&(i=""),c=e.includePrerelease?"-0":"",u?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&m?(h&&(o=0),a=0,i===">"?(i=">=",h?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",h?s=+s+1:o=+o+1),i==="<"&&(c="-0"),n=`${i+s}.${o}.${a}${c}`):h?n=`>=${s}.0.0${c} <${+s+1}.0.0-0`:v&&(n=`>=${s}.${o}.0${c} <${s}.${+o+1}.0-0`),at("xRange return",n),n})},BR=(r,e)=>(at("replaceStars",r,e),r.trim().replace(dn[rn.STAR],"")),UR=(r,e)=>(at("replaceGTE0",r,e),r.trim().replace(dn[e.includePrerelease?rn.GTE0PRE:rn.GTE0],"")),zR=r=>(e,t,n,i,s,o,a,c,u,h,v,m,b)=>(sn(n)?t="":sn(i)?t=`>=${n}.0.0${r?"-0":""}`:sn(s)?t=`>=${n}.${i}.0${r?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,sn(u)?c="":sn(h)?c=`<${+u+1}.0.0-0`:sn(v)?c=`<${u}.${+h+1}.0-0`:m?c=`<=${u}.${h}.${v}-${m}`:r?c=`<${u}.${h}.${+v+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),GR=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(at(r[n].semver),r[n].semver!==vu.ANY&&r[n].semver.prerelease.length>0){let i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var $s=B((jO,Lg)=>{var js=Symbol("SemVer ANY"),Ni=class{static get ANY(){return js}constructor(e,t){if(t=Ig(t),e instanceof Ni){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),wu("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===js?this.value="":this.value=this.operator+this.semver.version,wu("comp",this)}parse(e){let t=this.options.loose?Dg[Og.COMPARATORLOOSE]:Dg[Og.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Ag(n[2],this.options.loose):this.semver=js}toString(){return this.value}test(e){if(wu("Comparator.test",e,this.options.loose),this.semver===js||e===js)return!0;if(typeof e=="string")try{e=new Ag(e,this.options)}catch{return!1}return yu(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Ni))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Ng(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Ng(this.value,t).test(e.semver):(t=Ig(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||yu(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||yu(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Lg.exports=Ni;var Ig=Jo(),{safeRe:Dg,t:Og}=Ii(),yu=pu(),wu=Ls(),Ag=Wt(),Ng=En()});var Bs=B((BO,qg)=>{var VR=En(),WR=(r,e,t)=>{try{e=new VR(e,t)}catch{return!1}return e.test(r)};qg.exports=WR});var Mg=B((UO,Fg)=>{var HR=En(),KR=(r,e)=>new HR(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));Fg.exports=KR});var jg=B((zO,$g)=>{var YR=Wt(),XR=En(),QR=(r,e,t)=>{let n=null,i=null,s=null;try{s=new XR(e,t)}catch{return null}return r.forEach(o=>{s.test(o)&&(!n||i.compare(o)===-1)&&(n=o,i=new YR(n,t))}),n};$g.exports=QR});var Ug=B((GO,Bg)=>{var ZR=Wt(),JR=En(),eS=(r,e,t)=>{let n=null,i=null,s=null;try{s=new JR(e,t)}catch{return null}return r.forEach(o=>{s.test(o)&&(!n||i.compare(o)===1)&&(n=o,i=new ZR(n,t))}),n};Bg.exports=eS});var Vg=B((VO,Gg)=>{var Ru=Wt(),tS=En(),zg=qs(),nS=(r,e)=>{r=new tS(r,e);let t=new Ru("0.0.0");if(r.test(t)||(t=new Ru("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let i=r.set[n],s=null;i.forEach(o=>{let a=new Ru(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||zg(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!t||zg(t,s))&&(t=s)}return t&&r.test(t)?t:null};Gg.exports=nS});var Hg=B((WO,Wg)=>{var rS=En(),iS=(r,e)=>{try{return new rS(r,e).range||"*"}catch{return null}};Wg.exports=iS});var ua=B((HO,Qg)=>{var sS=Wt(),Xg=$s(),{ANY:oS}=Xg,aS=En(),cS=Bs(),Kg=qs(),Yg=ra(),uS=sa(),lS=ia(),dS=(r,e,t,n)=>{r=new sS(r,n),e=new aS(e,n);let i,s,o,a,c;switch(t){case">":i=Kg,s=uS,o=Yg,a=">",c=">=";break;case"<":i=Yg,s=lS,o=Kg,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(cS(r,e,n))return!1;for(let u=0;u<e.set.length;++u){let h=e.set[u],v=null,m=null;if(h.forEach(b=>{b.semver===oS&&(b=new Xg(">=0.0.0")),v=v||b,m=m||b,i(b.semver,v.semver,n)?v=b:o(b.semver,m.semver,n)&&(m=b)}),v.operator===a||v.operator===c||(!m.operator||m.operator===a)&&s(r,m.semver))return!1;if(m.operator===c&&o(r,m.semver))return!1}return!0};Qg.exports=dS});var Jg=B((KO,Zg)=>{var fS=ua(),hS=(r,e,t)=>fS(r,e,">",t);Zg.exports=hS});var tm=B((YO,em)=>{var pS=ua(),gS=(r,e,t)=>pS(r,e,"<",t);em.exports=gS});var im=B((XO,rm)=>{var nm=En(),mS=(r,e,t)=>(r=new nm(r,t),e=new nm(e,t),r.intersects(e,t));rm.exports=mS});var om=B((QO,sm)=>{var _S=Bs(),bS=xn();sm.exports=(r,e,t)=>{let n=[],i=null,s=null,o=r.sort((h,v)=>bS(h,v,t));for(let h of o)_S(h,e,t)?(s=h,i||(i=h)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);let a=[];for(let[h,v]of n)h===v?a.push(h):!v&&h===o[0]?a.push("*"):v?h===o[0]?a.push(`<=${v}`):a.push(`${h} - ${v}`):a.push(`>=${h}`);let c=a.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return c.length<u.length?c:e}});var fm=B((ZO,dm)=>{var am=En(),Cu=$s(),{ANY:Su}=Cu,Us=Bs(),xu=xn(),vS=(r,e,t={})=>{if(r===e)return!0;r=new am(r,t),e=new am(e,t);let n=!1;e:for(let i of r.set){for(let s of e.set){let o=wS(i,s,t);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},yS=[new Cu(">=0.0.0-0")],cm=[new Cu(">=0.0.0")],wS=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===Su){if(e.length===1&&e[0].semver===Su)return!0;t.includePrerelease?r=yS:r=cm}if(e.length===1&&e[0].semver===Su){if(t.includePrerelease)return!0;e=cm}let n=new Set,i,s;for(let b of r)b.operator===">"||b.operator===">="?i=um(i,b,t):b.operator==="<"||b.operator==="<="?s=lm(s,b,t):n.add(b.semver);if(n.size>1)return null;let o;if(i&&s){if(o=xu(i.semver,s.semver,t),o>0)return null;if(o===0&&(i.operator!==">="||s.operator!=="<="))return null}for(let b of n){if(i&&!Us(b,String(i),t)||s&&!Us(b,String(s),t))return null;for(let k of e)if(!Us(b,String(k),t))return!1;return!0}let a,c,u,h,v=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,m=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;v&&v.prerelease.length===1&&s.operator==="<"&&v.prerelease[0]===0&&(v=!1);for(let b of e){if(h=h||b.operator===">"||b.operator===">=",u=u||b.operator==="<"||b.operator==="<=",i){if(m&&b.semver.prerelease&&b.semver.prerelease.length&&b.semver.major===m.major&&b.semver.minor===m.minor&&b.semver.patch===m.patch&&(m=!1),b.operator===">"||b.operator===">="){if(a=um(i,b,t),a===b&&a!==i)return!1}else if(i.operator===">="&&!Us(i.semver,String(b),t))return!1}if(s){if(v&&b.semver.prerelease&&b.semver.prerelease.length&&b.semver.major===v.major&&b.semver.minor===v.minor&&b.semver.patch===v.patch&&(v=!1),b.operator==="<"||b.operator==="<="){if(c=lm(s,b,t),c===b&&c!==s)return!1}else if(s.operator==="<="&&!Us(s.semver,String(b),t))return!1}if(!b.operator&&(s||i)&&o!==0)return!1}return!(i&&u&&!s&&o!==0||s&&h&&!i&&o!==0||m||v)},um=(r,e,t)=>{if(!r)return e;let n=xu(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},lm=(r,e,t)=>{if(!r)return e;let n=xu(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};dm.exports=vS});var mm=B((JO,gm)=>{var Eu=Ii(),hm=Ns(),RS=Wt(),pm=du(),SS=Wr(),CS=Ap(),xS=Lp(),ES=Mp(),kS=Bp(),TS=zp(),PS=Vp(),IS=Hp(),DS=Yp(),OS=xn(),AS=Jp(),NS=tg(),LS=na(),qS=sg(),FS=ag(),MS=qs(),$S=ra(),jS=fu(),BS=hu(),US=ia(),zS=sa(),GS=pu(),VS=mg(),WS=$s(),HS=En(),KS=Bs(),YS=Mg(),XS=jg(),QS=Ug(),ZS=Vg(),JS=Hg(),eC=ua(),tC=Jg(),nC=tm(),rC=im(),iC=om(),sC=fm();gm.exports={parse:SS,valid:CS,clean:xS,inc:ES,diff:kS,major:TS,minor:PS,patch:IS,prerelease:DS,compare:OS,rcompare:AS,compareLoose:NS,compareBuild:LS,sort:qS,rsort:FS,gt:MS,lt:$S,eq:jS,neq:BS,gte:US,lte:zS,cmp:GS,coerce:VS,Comparator:WS,Range:HS,satisfies:KS,toComparators:YS,maxSatisfying:XS,minSatisfying:QS,minVersion:ZS,validRange:JS,outside:eC,gtr:tC,ltr:nC,intersects:rC,simplifyRange:iC,subset:sC,SemVer:RS,re:Eu.re,src:Eu.src,tokens:Eu.t,SEMVER_SPEC_VERSION:hm.SEMVER_SPEC_VERSION,RELEASE_TYPES:hm.RELEASE_TYPES,compareIdentifiers:pm.compareIdentifiers,rcompareIdentifiers:pm.rcompareIdentifiers}});var Cr=B(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.asPromise=gt.thenable=gt.typedArray=gt.stringArray=gt.array=gt.func=gt.error=gt.number=gt.string=gt.boolean=void 0;function oC(r){return r===!0||r===!1}gt.boolean=oC;function _m(r){return typeof r=="string"||r instanceof String}gt.string=_m;function aC(r){return typeof r=="number"||r instanceof Number}gt.number=aC;function cC(r){return r instanceof Error}gt.error=cC;function bm(r){return typeof r=="function"}gt.func=bm;function vm(r){return Array.isArray(r)}gt.array=vm;function uC(r){return vm(r)&&r.every(e=>_m(e))}gt.stringArray=uC;function lC(r,e){return Array.isArray(r)&&r.every(e)}gt.typedArray=lC;function ym(r){return r&&bm(r.then)}gt.thenable=ym;function dC(r){return r instanceof Promise?r:ym(r)?new Promise((e,t)=>{r.then(n=>e(n),n=>t(n))}):Promise.resolve(r)}gt.asPromise=dC});var ur=B(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});var ku;function Tu(){if(ku===void 0)throw new Error("No runtime abstraction layer installed");return ku}(function(r){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");ku=t}r.install=e})(Tu||(Tu={}));Pu.default=Tu});var Iu=B(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});zs.Disposable=void 0;var fC;(function(r){function e(t){return{dispose:t}}r.create=e})(fC=zs.Disposable||(zs.Disposable={}))});var wm=B(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.AbstractMessageBuffer=void 0;var hC=13,pC=10,gC=`\r
`,Du=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(this._chunks.length===0)return;let e=0,t=0,n=0,i=0;e:for(;t<this._chunks.length;){let c=this._chunks[t];n=0;t:for(;n<c.length;){switch(c[n]){case hC:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case pC:switch(e){case 1:e=2;break;case 3:e=4,n++;break e;default:e=0}break;default:e=0}n++}i+=c.byteLength,t++}if(e!==4)return;let s=this._read(i+n),o=new Map,a=this.toString(s,"ascii").split(gC);if(a.length<2)return o;for(let c=0;c<a.length-2;c++){let u=a[c],h=u.indexOf(":");if(h===-1)throw new Error("Message header must separate key and value using :");let v=u.substr(0,h),m=u.substr(h+1).trim();o.set(v,m)}return o}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),n=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,n),n+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,n),n+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};la.AbstractMessageBuffer=Du});var Cm=B(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});var mC=ur(),Rm=require("util"),Qr=Iu(),_C=wm(),Li=class extends _C.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return Li.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Rm.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Li.emptyBuffer=Buffer.allocUnsafe(0);var Ou=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Qr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Qr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Qr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Qr.Disposable.create(()=>this.stream.off("data",e))}},Au=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Qr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Qr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Qr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((n,i)=>{let s=o=>{o==null?n():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},Sm=Object.freeze({messageBuffer:Object.freeze({create:r=>new Li(r)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(r,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(r,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(r,e)=>{try{return r instanceof Buffer?Promise.resolve(JSON.parse(r.toString(e.charset))):Promise.resolve(JSON.parse(new Rm.TextDecoder(e.charset).decode(r)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:r=>new Ou(r),asWritableStream:r=>new Au(r)}),console,timer:Object.freeze({setTimeout(r,e,...t){return setTimeout(r,e,...t)},clearTimeout(r){clearTimeout(r)},setImmediate(r,...e){return setImmediate(r,...e)},clearImmediate(r){clearImmediate(r)}})});function Nu(){return Sm}(function(r){function e(){mC.default.install(Sm)}r.install=e})(Nu||(Nu={}));Lu.default=Nu});var qi=B(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.stringArray=Ht.array=Ht.func=Ht.error=Ht.number=Ht.string=Ht.boolean=void 0;function bC(r){return r===!0||r===!1}Ht.boolean=bC;function xm(r){return typeof r=="string"||r instanceof String}Ht.string=xm;function vC(r){return typeof r=="number"||r instanceof Number}Ht.number=vC;function yC(r){return r instanceof Error}Ht.error=yC;function wC(r){return typeof r=="function"}Ht.func=wC;function Em(r){return Array.isArray(r)}Ht.array=Em;function RC(r){return Em(r)&&r.every(e=>xm(e))}Ht.stringArray=RC});var il=B(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.isResponseMessage=le.isNotificationMessage=le.isRequestMessage=le.NotificationType9=le.NotificationType8=le.NotificationType7=le.NotificationType6=le.NotificationType5=le.NotificationType4=le.NotificationType3=le.NotificationType2=le.NotificationType1=le.NotificationType0=le.NotificationType=le.RequestType9=le.RequestType8=le.RequestType7=le.RequestType6=le.RequestType5=le.RequestType4=le.RequestType3=le.RequestType2=le.RequestType1=le.RequestType=le.RequestType0=le.AbstractMessageSignature=le.ParameterStructures=le.ResponseError=le.ErrorCodes=void 0;var Zr=qi(),km;(function(r){r.ParseError=-32700,r.InvalidRequest=-32600,r.MethodNotFound=-32601,r.InvalidParams=-32602,r.InternalError=-32603,r.jsonrpcReservedErrorRangeStart=-32099,r.serverErrorStart=r.jsonrpcReservedErrorRangeStart,r.MessageWriteError=-32099,r.MessageReadError=-32098,r.ServerNotInitialized=-32002,r.UnknownErrorCode=-32001,r.jsonrpcReservedErrorRangeEnd=-32e3,r.serverErrorEnd=r.jsonrpcReservedErrorRangeEnd})(km=le.ErrorCodes||(le.ErrorCodes={}));var Gs=class extends Error{constructor(e,t,n){super(t),this.code=Zr.number(e)?e:km.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,Gs.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}};le.ResponseError=Gs;var It=class{constructor(e){this.kind=e}static is(e){return e===It.auto||e===It.byName||e===It.byPosition}toString(){return this.kind}};le.ParameterStructures=It;It.auto=new It("auto");It.byPosition=new It("byPosition");It.byName=new It("byName");var ct=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return It.auto}};le.AbstractMessageSignature=ct;var qu=class extends ct{constructor(e){super(e,0)}};le.RequestType0=qu;var Fu=class extends ct{constructor(e,t=It.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};le.RequestType=Fu;var Mu=class extends ct{constructor(e,t=It.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};le.RequestType1=Mu;var $u=class extends ct{constructor(e){super(e,2)}};le.RequestType2=$u;var ju=class extends ct{constructor(e){super(e,3)}};le.RequestType3=ju;var Bu=class extends ct{constructor(e){super(e,4)}};le.RequestType4=Bu;var Uu=class extends ct{constructor(e){super(e,5)}};le.RequestType5=Uu;var zu=class extends ct{constructor(e){super(e,6)}};le.RequestType6=zu;var Gu=class extends ct{constructor(e){super(e,7)}};le.RequestType7=Gu;var Vu=class extends ct{constructor(e){super(e,8)}};le.RequestType8=Vu;var Wu=class extends ct{constructor(e){super(e,9)}};le.RequestType9=Wu;var Hu=class extends ct{constructor(e,t=It.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};le.NotificationType=Hu;var Ku=class extends ct{constructor(e){super(e,0)}};le.NotificationType0=Ku;var Yu=class extends ct{constructor(e,t=It.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};le.NotificationType1=Yu;var Xu=class extends ct{constructor(e){super(e,2)}};le.NotificationType2=Xu;var Qu=class extends ct{constructor(e){super(e,3)}};le.NotificationType3=Qu;var Zu=class extends ct{constructor(e){super(e,4)}};le.NotificationType4=Zu;var Ju=class extends ct{constructor(e){super(e,5)}};le.NotificationType5=Ju;var el=class extends ct{constructor(e){super(e,6)}};le.NotificationType6=el;var tl=class extends ct{constructor(e){super(e,7)}};le.NotificationType7=tl;var nl=class extends ct{constructor(e){super(e,8)}};le.NotificationType8=nl;var rl=class extends ct{constructor(e){super(e,9)}};le.NotificationType9=rl;function SC(r){let e=r;return e&&Zr.string(e.method)&&(Zr.string(e.id)||Zr.number(e.id))}le.isRequestMessage=SC;function CC(r){let e=r;return e&&Zr.string(e.method)&&r.id===void 0}le.isNotificationMessage=CC;function xC(r){let e=r;return e&&(e.result!==void 0||!!e.error)&&(Zr.string(e.id)||Zr.number(e.id)||e.id===null)}le.isResponseMessage=xC});var Mi=B(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.Emitter=Jr.Event=void 0;var EC=ur(),kC;(function(r){let e={dispose(){}};r.None=function(){return e}})(kC=Jr.Event||(Jr.Event={}));var sl=class{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else n=!0;if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=n.length;s<o;s++)try{t.push(n[s].apply(i[s],e))}catch(a){EC.default().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Fi=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new sl),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=Fi._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Jr.Emitter=Fi;Fi._noop=function(){}});var ul=B(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.CancellationTokenSource=ei.CancellationToken=void 0;var Tm=ur(),TC=qi(),ol=Mi(),al;(function(r){r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ol.Event.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ol.Event.None});function e(t){let n=t;return n&&(n===r.None||n===r.Cancelled||TC.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}r.is=e})(al=ei.CancellationToken||(ei.CancellationToken={}));var PC=Object.freeze(function(r,e){let t=Tm.default().timer.setTimeout(r.bind(e),0);return{dispose(){Tm.default().timer.clearTimeout(t)}}}),da=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?PC:(this._emitter||(this._emitter=new ol.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},cl=class{get token(){return this._token||(this._token=new da),this._token}cancel(){this._token?this._token.cancel():this._token=al.Cancelled}dispose(){this._token?this._token instanceof da&&this._token.dispose():this._token=al.None}};ei.CancellationTokenSource=cl});var Pm=B(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.ReadableStreamMessageReader=lr.AbstractMessageReader=lr.MessageReader=void 0;var fa=ur(),$i=qi(),ll=Mi(),IC;(function(r){function e(t){let n=t;return n&&$i.func(n.listen)&&$i.func(n.dispose)&&$i.func(n.onError)&&$i.func(n.onClose)&&$i.func(n.onPartialMessage)}r.is=e})(IC=lr.MessageReader||(lr.MessageReader={}));var ha=class{constructor(){this.errorEmitter=new ll.Emitter,this.closeEmitter=new ll.Emitter,this.partialMessageEmitter=new ll.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${$i.string(e.message)?e.message:"unknown"}`)}};lr.AbstractMessageReader=ha;var dl;(function(r){function e(t){var n;let i,s,o,a=new Map,c,u=new Map;if(t===void 0||typeof t=="string")i=t??"utf-8";else{if(i=(n=t.charset)!==null&&n!==void 0?n:"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,a.set(o.name,o)),t.contentDecoders!==void 0)for(let h of t.contentDecoders)a.set(h.name,h);if(t.contentTypeDecoder!==void 0&&(c=t.contentTypeDecoder,u.set(c.name,c)),t.contentTypeDecoders!==void 0)for(let h of t.contentTypeDecoders)u.set(h.name,h)}return c===void 0&&(c=fa.default().applicationJson.decoder,u.set(c.name,c)),{charset:i,contentDecoder:o,contentDecoders:a,contentTypeDecoder:c,contentTypeDecoders:u}}r.fromOptions=e})(dl||(dl={}));var fl=class extends ha{constructor(e,t){super(),this.readable=e,this.options=dl.fromOptions(t),this.buffer=fa.default().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(n=>{this.onData(n)});return this.readable.onError(n=>this.fireError(n)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders();if(!i)return;let s=i.get("Content-Length");if(!s)throw new Error("Header must provide a Content-Length property.");let o=parseInt(s);if(isNaN(o))throw new Error("Content-Length value must be a number.");this.nextMessageLength=o}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1;let n;this.options.contentDecoder!==void 0?n=this.options.contentDecoder.decode(t):n=Promise.resolve(t),n.then(i=>{this.options.contentTypeDecoder.decode(i,this.options).then(s=>{this.callback(s)},s=>{this.fireError(s)})},i=>{this.fireError(i)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(fa.default().timer.clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=fa.default().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};lr.ReadableStreamMessageReader=fl});var Im=B(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.Semaphore=void 0;var DC=ur(),hl=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||DC.default().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};pa.Semaphore=hl});var Nm=B(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.WriteableStreamMessageWriter=dr.AbstractMessageWriter=dr.MessageWriter=void 0;var Dm=ur(),Vs=qi(),OC=Im(),Om=Mi(),AC="Content-Length: ",Am=`\r
`,NC;(function(r){function e(t){let n=t;return n&&Vs.func(n.dispose)&&Vs.func(n.onClose)&&Vs.func(n.onError)&&Vs.func(n.write)}r.is=e})(NC=dr.MessageWriter||(dr.MessageWriter={}));var ga=class{constructor(){this.errorEmitter=new Om.Emitter,this.closeEmitter=new Om.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Vs.string(e.message)?e.message:"unknown"}`)}};dr.AbstractMessageWriter=ga;var pl;(function(r){function e(t){var n,i;return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:Dm.default().applicationJson.encoder}:{charset:(n=t.charset)!==null&&n!==void 0?n:"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:(i=t.contentTypeEncoder)!==null&&i!==void 0?i:Dm.default().applicationJson.encoder}}r.fromOptions=e})(pl||(pl={}));var gl=class extends ga{constructor(e,t){super(),this.writable=e,this.options=pl.fromOptions(t),this.errorCount=0,this.writeSemaphore=new OC.Semaphore(1),this.writable.onError(n=>this.fireError(n)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(n=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(n):n).then(n=>{let i=[];return i.push(AC,n.byteLength.toString(),Am),i.push(Am),this.doWrite(e,i,n)},n=>{throw this.fireError(n),n}))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};dr.WriteableStreamMessageWriter=gl});var Lm=B(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.LRUCache=fr.LinkedMap=fr.Touch=void 0;var on;(function(r){r.None=0,r.First=1,r.AsOld=r.First,r.Last=2,r.AsNew=r.Last})(on=fr.Touch||(fr.Touch={}));var ma=class{constructor(){this[Symbol.toStringTag]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)===null||e===void 0?void 0:e.value}get last(){var e;return(e=this._tail)===null||e===void 0?void 0:e.value}has(e){return this._map.has(e)}get(e,t=on.None){let n=this._map.get(e);if(n)return t!==on.None&&this.touch(n,t),n.value}set(e,t,n=on.None){let i=this._map.get(e);if(i)i.value=t,n!==on.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case on.None:this.addItemLast(i);break;case on.First:this.addItemFirst(i);break;case on.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==on.First&&t!==on.Last)){if(t===on.First){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===on.Last){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};fr.LinkedMap=ma;var ml=class extends ma{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=on.AsNew){return super.get(e,t)}peek(e){return super.get(e,on.None)}set(e,t){return super.set(e,t,on.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};fr.LRUCache=ml});var jm=B(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.createMessageConnection=Oe.ConnectionOptions=Oe.CancellationStrategy=Oe.CancellationSenderStrategy=Oe.CancellationReceiverStrategy=Oe.ConnectionStrategy=Oe.ConnectionError=Oe.ConnectionErrors=Oe.LogTraceNotification=Oe.SetTraceNotification=Oe.TraceFormat=Oe.Trace=Oe.NullLogger=Oe.ProgressType=void 0;var qm=ur(),Dt=qi(),Pe=il(),Fm=Lm(),Ws=Mi(),_l=ul(),Hs;(function(r){r.type=new Pe.NotificationType("$/cancelRequest")})(Hs||(Hs={}));var ba;(function(r){r.type=new Pe.NotificationType("$/progress")})(ba||(ba={}));var bl=class{constructor(){}};Oe.ProgressType=bl;var vl;(function(r){function e(t){return Dt.func(t)}r.is=e})(vl||(vl={}));Oe.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Rt;(function(r){r[r.Off=0]="Off",r[r.Messages=1]="Messages",r[r.Verbose=2]="Verbose"})(Rt=Oe.Trace||(Oe.Trace={}));(function(r){function e(n){if(!Dt.string(n))return r.Off;switch(n=n.toLowerCase(),n){case"off":return r.Off;case"messages":return r.Messages;case"verbose":return r.Verbose;default:return r.Off}}r.fromString=e;function t(n){switch(n){case r.Off:return"off";case r.Messages:return"messages";case r.Verbose:return"verbose";default:return"off"}}r.toString=t})(Rt=Oe.Trace||(Oe.Trace={}));var On;(function(r){r.Text="text",r.JSON="json"})(On=Oe.TraceFormat||(Oe.TraceFormat={}));(function(r){function e(t){return t=t.toLowerCase(),t==="json"?r.JSON:r.Text}r.fromString=e})(On=Oe.TraceFormat||(Oe.TraceFormat={}));var Mm;(function(r){r.type=new Pe.NotificationType("$/setTrace")})(Mm=Oe.SetTraceNotification||(Oe.SetTraceNotification={}));var yl;(function(r){r.type=new Pe.NotificationType("$/logTrace")})(yl=Oe.LogTraceNotification||(Oe.LogTraceNotification={}));var _a;(function(r){r[r.Closed=1]="Closed",r[r.Disposed=2]="Disposed",r[r.AlreadyListening=3]="AlreadyListening"})(_a=Oe.ConnectionErrors||(Oe.ConnectionErrors={}));var xr=class extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,xr.prototype)}};Oe.ConnectionError=xr;var $m;(function(r){function e(t){let n=t;return n&&Dt.func(n.cancelUndispatched)}r.is=e})($m=Oe.ConnectionStrategy||(Oe.ConnectionStrategy={}));var wl;(function(r){r.Message=Object.freeze({createCancellationTokenSource(t){return new _l.CancellationTokenSource}});function e(t){let n=t;return n&&Dt.func(n.createCancellationTokenSource)}r.is=e})(wl=Oe.CancellationReceiverStrategy||(Oe.CancellationReceiverStrategy={}));var Rl;(function(r){r.Message=Object.freeze({sendCancellation(t,n){t.sendNotification(Hs.type,{id:n})},cleanup(t){}});function e(t){let n=t;return n&&Dt.func(n.sendCancellation)&&Dt.func(n.cleanup)}r.is=e})(Rl=Oe.CancellationSenderStrategy||(Oe.CancellationSenderStrategy={}));var Sl;(function(r){r.Message=Object.freeze({receiver:wl.Message,sender:Rl.Message});function e(t){let n=t;return n&&wl.is(n.receiver)&&Rl.is(n.sender)}r.is=e})(Sl=Oe.CancellationStrategy||(Oe.CancellationStrategy={}));var LC;(function(r){function e(t){let n=t;return n&&(Sl.is(n.cancellationStrategy)||$m.is(n.connectionStrategy))}r.is=e})(LC=Oe.ConnectionOptions||(Oe.ConnectionOptions={}));var An;(function(r){r[r.New=1]="New",r[r.Listening=2]="Listening",r[r.Closed=3]="Closed",r[r.Disposed=4]="Disposed"})(An||(An={}));function qC(r,e,t,n){let i=t!==void 0?t:Oe.NullLogger,s=0,o=0,a=0,c="2.0",u,h=Object.create(null),v,m=Object.create(null),b=new Map,k,f=new Fm.LinkedMap,_=Object.create(null),w=Object.create(null),S=Rt.Off,y=On.Text,l,x=An.New,E=new Ws.Emitter,C=new Ws.Emitter,T=new Ws.Emitter,D=new Ws.Emitter,F=new Ws.Emitter,z=n&&n.cancellationStrategy?n.cancellationStrategy:Sl.Message;function H(L){if(L===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+L.toString()}function Q(L){return L===null?"res-unknown-"+(++a).toString():"res-"+L.toString()}function J(){return"not-"+(++o).toString()}function ie(L,I){Pe.isRequestMessage(I)?L.set(H(I.id),I):Pe.isResponseMessage(I)?L.set(Q(I.id),I):L.set(J(),I)}function be(L){}function ee(){return x===An.Listening}function Ae(){return x===An.Closed}function ae(){return x===An.Disposed}function Ee(){(x===An.New||x===An.Listening)&&(x=An.Closed,C.fire(void 0))}function ge(L){E.fire([L,void 0,void 0])}function me(L){E.fire(L)}r.onClose(Ee),r.onError(ge),e.onClose(Ee),e.onError(me);function De(){k||f.size===0||(k=qm.default().timer.setImmediate(()=>{k=void 0,Je()}))}function Je(){if(f.size===0)return;let L=f.shift();try{Pe.isRequestMessage(L)?je(L):Pe.isNotificationMessage(L)?Qe(L):Pe.isResponseMessage(L)?ke(L):Et(L)}finally{De()}}let W=L=>{try{if(Pe.isNotificationMessage(L)&&L.method===Hs.type.method){let I=H(L.params.id),R=f.get(I);if(Pe.isRequestMessage(R)){let O=n?.connectionStrategy,q=O&&O.cancelUndispatched?O.cancelUndispatched(R,be):void 0;if(q&&(q.error!==void 0||q.result!==void 0)){f.delete(I),q.id=R.id,Ge(q,L.method,Date.now()),e.write(q);return}}}ie(f,L)}finally{De()}};function je(L){if(ae())return;function I($,Y,se){let Re={jsonrpc:c,id:L.id};$ instanceof Pe.ResponseError?Re.error=$.toJson():Re.result=$===void 0?null:$,Ge(Re,Y,se),e.write(Re)}function R($,Y,se){let Re={jsonrpc:c,id:L.id,error:$.toJson()};Ge(Re,Y,se),e.write(Re)}function O($,Y,se){$===void 0&&($=null);let Re={jsonrpc:c,id:L.id,result:$};Ge(Re,Y,se),e.write(Re)}Qt(L);let q=h[L.method],d,p;q&&(d=q.type,p=q.handler);let A=Date.now();if(p||u){let $=String(L.id),Y=z.receiver.createCancellationTokenSource($);w[$]=Y;try{let se;if(p)if(L.params===void 0){if(d!==void 0&&d.numberOfParams!==0){R(new Pe.ResponseError(Pe.ErrorCodes.InvalidParams,`Request ${L.method} defines ${d.numberOfParams} params but recevied none.`),L.method,A);return}se=p(Y.token)}else if(Array.isArray(L.params)){if(d!==void 0&&d.parameterStructures===Pe.ParameterStructures.byName){R(new Pe.ResponseError(Pe.ErrorCodes.InvalidParams,`Request ${L.method} defines parameters by name but received parameters by position`),L.method,A);return}se=p(...L.params,Y.token)}else{if(d!==void 0&&d.parameterStructures===Pe.ParameterStructures.byPosition){R(new Pe.ResponseError(Pe.ErrorCodes.InvalidParams,`Request ${L.method} defines parameters by position but received parameters by name`),L.method,A);return}se=p(L.params,Y.token)}else u&&(se=u(L.method,L.params,Y.token));let Re=se;se?Re.then?Re.then(Ue=>{delete w[$],I(Ue,L.method,A)},Ue=>{delete w[$],Ue instanceof Pe.ResponseError?R(Ue,L.method,A):Ue&&Dt.string(Ue.message)?R(new Pe.ResponseError(Pe.ErrorCodes.InternalError,`Request ${L.method} failed with message: ${Ue.message}`),L.method,A):R(new Pe.ResponseError(Pe.ErrorCodes.InternalError,`Request ${L.method} failed unexpectedly without providing any details.`),L.method,A)}):(delete w[$],I(se,L.method,A)):(delete w[$],O(se,L.method,A))}catch(se){delete w[$],se instanceof Pe.ResponseError?I(se,L.method,A):se&&Dt.string(se.message)?R(new Pe.ResponseError(Pe.ErrorCodes.InternalError,`Request ${L.method} failed with message: ${se.message}`),L.method,A):R(new Pe.ResponseError(Pe.ErrorCodes.InternalError,`Request ${L.method} failed unexpectedly without providing any details.`),L.method,A)}}else R(new Pe.ResponseError(Pe.ErrorCodes.MethodNotFound,`Unhandled method ${L.method}`),L.method,A)}function ke(L){if(!ae())if(L.id===null)L.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(L.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let I=String(L.id),R=_[I];if(Zt(L,R),R){delete _[I];try{if(L.error){let O=L.error;R.reject(new Pe.ResponseError(O.code,O.message,O.data))}else if(L.result!==void 0)R.resolve(L.result);else throw new Error("Should never happen.")}catch(O){O.message?i.error(`Response handler '${R.method}' failed with message: ${O.message}`):i.error(`Response handler '${R.method}' failed unexpectedly.`)}}}}function Qe(L){if(ae())return;let I,R;if(L.method===Hs.type.method)R=O=>{let q=O.id,d=w[String(q)];d&&d.cancel()};else{let O=m[L.method];O&&(R=O.handler,I=O.type)}if(R||v)try{wt(L),R?L.params===void 0?(I!==void 0&&I.numberOfParams!==0&&I.parameterStructures!==Pe.ParameterStructures.byName&&i.error(`Notification ${L.method} defines ${I.numberOfParams} params but recevied none.`),R()):Array.isArray(L.params)?(I!==void 0&&(I.parameterStructures===Pe.ParameterStructures.byName&&i.error(`Notification ${L.method} defines parameters by name but received parameters by position`),I.numberOfParams!==L.params.length&&i.error(`Notification ${L.method} defines ${I.numberOfParams} params but received ${L.params.length} argumennts`)),R(...L.params)):(I!==void 0&&I.parameterStructures===Pe.ParameterStructures.byPosition&&i.error(`Notification ${L.method} defines parameters by position but received parameters by name`),R(L.params)):v&&v(L.method,L.params)}catch(O){O.message?i.error(`Notification handler '${L.method}' failed with message: ${O.message}`):i.error(`Notification handler '${L.method}' failed unexpectedly.`)}else T.fire(L)}function Et(L){if(!L){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(L,null,4)}`);let I=L;if(Dt.string(I.id)||Dt.number(I.id)){let R=String(I.id),O=_[R];O&&O.reject(new Error("The received response has neither a result nor an error property."))}}function rt(L){if(!(S===Rt.Off||!l))if(y===On.Text){let I;S===Rt.Verbose&&L.params&&(I=`Params: ${JSON.stringify(L.params,null,4)}

`),l.log(`Sending request '${L.method} - (${L.id})'.`,I)}else He("send-request",L)}function Gt(L){if(!(S===Rt.Off||!l))if(y===On.Text){let I;S===Rt.Verbose&&(L.params?I=`Params: ${JSON.stringify(L.params,null,4)}

`:I=`No parameters provided.

`),l.log(`Sending notification '${L.method}'.`,I)}else He("send-notification",L)}function Ge(L,I,R){if(!(S===Rt.Off||!l))if(y===On.Text){let O;S===Rt.Verbose&&(L.error&&L.error.data?O=`Error data: ${JSON.stringify(L.error.data,null,4)}

`:L.result?O=`Result: ${JSON.stringify(L.result,null,4)}

`:L.error===void 0&&(O=`No result returned.

`)),l.log(`Sending response '${I} - (${L.id})'. Processing request took ${Date.now()-R}ms`,O)}else He("send-response",L)}function Qt(L){if(!(S===Rt.Off||!l))if(y===On.Text){let I;S===Rt.Verbose&&L.params&&(I=`Params: ${JSON.stringify(L.params,null,4)}

`),l.log(`Received request '${L.method} - (${L.id})'.`,I)}else He("receive-request",L)}function wt(L){if(!(S===Rt.Off||!l||L.method===yl.type.method))if(y===On.Text){let I;S===Rt.Verbose&&(L.params?I=`Params: ${JSON.stringify(L.params,null,4)}

`:I=`No parameters provided.

`),l.log(`Received notification '${L.method}'.`,I)}else He("receive-notification",L)}function Zt(L,I){if(!(S===Rt.Off||!l))if(y===On.Text){let R;if(S===Rt.Verbose&&(L.error&&L.error.data?R=`Error data: ${JSON.stringify(L.error.data,null,4)}

`:L.result?R=`Result: ${JSON.stringify(L.result,null,4)}

`:L.error===void 0&&(R=`No result returned.

`)),I){let O=L.error?` Request failed: ${L.error.message} (${L.error.code}).`:"";l.log(`Received response '${I.method} - (${L.id})' in ${Date.now()-I.timerStart}ms.${O}`,R)}else l.log(`Received response ${L.id} without active response promise.`,R)}else He("receive-response",L)}function He(L,I){if(!l||S===Rt.Off)return;let R={isLSPMessage:!0,type:L,message:I,timestamp:Date.now()};l.log(R)}function ft(){if(Ae())throw new xr(_a.Closed,"Connection is closed.");if(ae())throw new xr(_a.Disposed,"Connection is disposed.")}function mt(){if(ee())throw new xr(_a.AlreadyListening,"Connection is already listening")}function un(){if(!ee())throw new Error("Call listen() first.")}function kt(L){return L===void 0?null:L}function mn(L){if(L!==null)return L}function qt(L){return L!=null&&!Array.isArray(L)&&typeof L=="object"}function Ft(L,I){switch(L){case Pe.ParameterStructures.auto:return qt(I)?mn(I):[kt(I)];case Pe.ParameterStructures.byName:if(!qt(I))throw new Error("Recevied parameters by name but param is not an object literal.");return mn(I);case Pe.ParameterStructures.byPosition:return[kt(I)];default:throw new Error(`Unknown parameter structure ${L.toString()}`)}}function Jt(L,I){let R,O=L.numberOfParams;switch(O){case 0:R=void 0;break;case 1:R=Ft(L.parameterStructures,I[0]);break;default:R=[];for(let q=0;q<I.length&&q<O;q++)R.push(kt(I[q]));if(I.length<O)for(let q=I.length;q<O;q++)R.push(null);break}return R}let Vt={sendNotification:(L,...I)=>{ft();let R,O;if(Dt.string(L)){R=L;let d=I[0],p=0,A=Pe.ParameterStructures.auto;Pe.ParameterStructures.is(d)&&(p=1,A=d);let $=I.length,Y=$-p;switch(Y){case 0:O=void 0;break;case 1:O=Ft(A,I[p]);break;default:if(A===Pe.ParameterStructures.byName)throw new Error(`Recevied ${Y} parameters for 'by Name' notification parameter structure.`);O=I.slice(p,$).map(se=>kt(se));break}}else{let d=I;R=L.method,O=Jt(L,d)}let q={jsonrpc:c,method:R,params:O};Gt(q),e.write(q)},onNotification:(L,I)=>{ft();let R;return Dt.func(L)?v=L:I&&(Dt.string(L)?(R=L,m[L]={type:void 0,handler:I}):(R=L.method,m[L.method]={type:L,handler:I})),{dispose:()=>{R!==void 0?delete m[R]:v=void 0}}},onProgress:(L,I,R)=>{if(b.has(I))throw new Error(`Progress handler for token ${I} already registered`);return b.set(I,R),{dispose:()=>{b.delete(I)}}},sendProgress:(L,I,R)=>{Vt.sendNotification(ba.type,{token:I,value:R})},onUnhandledProgress:D.event,sendRequest:(L,...I)=>{ft(),un();let R,O,q;if(Dt.string(L)){R=L;let $=I[0],Y=I[I.length-1],se=0,Re=Pe.ParameterStructures.auto;Pe.ParameterStructures.is($)&&(se=1,Re=$);let Ue=I.length;_l.CancellationToken.is(Y)&&(Ue=Ue-1,q=Y);let M=Ue-se;switch(M){case 0:O=void 0;break;case 1:O=Ft(Re,I[se]);break;default:if(Re===Pe.ParameterStructures.byName)throw new Error(`Recevied ${M} parameters for 'by Name' request parameter structure.`);O=I.slice(se,Ue).map(j=>kt(j));break}}else{let $=I;R=L.method,O=Jt(L,$);let Y=L.numberOfParams;q=_l.CancellationToken.is($[Y])?$[Y]:void 0}let d=s++,p;return q&&(p=q.onCancellationRequested(()=>{z.sender.sendCancellation(Vt,d)})),new Promise(($,Y)=>{let se={jsonrpc:c,id:d,method:R,params:O},Re=j=>{$(j),z.sender.cleanup(d),p?.dispose()},Ue=j=>{Y(j),z.sender.cleanup(d),p?.dispose()},M={method:R,timerStart:Date.now(),resolve:Re,reject:Ue};rt(se);try{e.write(se)}catch(j){M.reject(new Pe.ResponseError(Pe.ErrorCodes.MessageWriteError,j.message?j.message:"Unknown reason")),M=null}M&&(_[String(d)]=M)})},onRequest:(L,I)=>{ft();let R=null;return vl.is(L)?(R=void 0,u=L):Dt.string(L)?(R=null,I!==void 0&&(R=L,h[L]={handler:I,type:void 0})):I!==void 0&&(R=L.method,h[L.method]={type:L,handler:I}),{dispose:()=>{R!==null&&(R!==void 0?delete h[R]:u=void 0)}}},trace:(L,I,R)=>{let O=!1,q=On.Text;R!==void 0&&(Dt.boolean(R)?O=R:(O=R.sendNotification||!1,q=R.traceFormat||On.Text)),S=L,y=q,S===Rt.Off?l=void 0:l=I,O&&!Ae()&&!ae()&&Vt.sendNotification(Mm.type,{value:Rt.toString(L)})},onError:E.event,onClose:C.event,onUnhandledNotification:T.event,onDispose:F.event,end:()=>{e.end()},dispose:()=>{if(ae())return;x=An.Disposed,F.fire(void 0);let L=new Error("Connection got disposed.");Object.keys(_).forEach(I=>{_[I].reject(L)}),_=Object.create(null),w=Object.create(null),f=new Fm.LinkedMap,Dt.func(e.dispose)&&e.dispose(),Dt.func(r.dispose)&&r.dispose()},listen:()=>{ft(),mt(),x=An.Listening,r.listen(W)},inspect:()=>{qm.default().console.log("inspect")}};return Vt.onNotification(yl.type,L=>{S===Rt.Off||!l||l.log(L.message,S===Rt.Verbose?L.verbose:void 0)}),Vt.onNotification(ba.type,L=>{let I=b.get(L.token);I?I(L.value):D.fire(L)}),Vt}Oe.createMessageConnection=qC});var El=B(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.CancellationSenderStrategy=K.CancellationReceiverStrategy=K.ConnectionError=K.ConnectionErrors=K.LogTraceNotification=K.SetTraceNotification=K.TraceFormat=K.Trace=K.ProgressType=K.createMessageConnection=K.NullLogger=K.ConnectionOptions=K.ConnectionStrategy=K.WriteableStreamMessageWriter=K.AbstractMessageWriter=K.MessageWriter=K.ReadableStreamMessageReader=K.AbstractMessageReader=K.MessageReader=K.CancellationToken=K.CancellationTokenSource=K.Emitter=K.Event=K.Disposable=K.ParameterStructures=K.NotificationType9=K.NotificationType8=K.NotificationType7=K.NotificationType6=K.NotificationType5=K.NotificationType4=K.NotificationType3=K.NotificationType2=K.NotificationType1=K.NotificationType0=K.NotificationType=K.ErrorCodes=K.ResponseError=K.RequestType9=K.RequestType8=K.RequestType7=K.RequestType6=K.RequestType5=K.RequestType4=K.RequestType3=K.RequestType2=K.RequestType1=K.RequestType0=K.RequestType=K.RAL=void 0;K.CancellationStrategy=void 0;var ut=il();Object.defineProperty(K,"RequestType",{enumerable:!0,get:function(){return ut.RequestType}});Object.defineProperty(K,"RequestType0",{enumerable:!0,get:function(){return ut.RequestType0}});Object.defineProperty(K,"RequestType1",{enumerable:!0,get:function(){return ut.RequestType1}});Object.defineProperty(K,"RequestType2",{enumerable:!0,get:function(){return ut.RequestType2}});Object.defineProperty(K,"RequestType3",{enumerable:!0,get:function(){return ut.RequestType3}});Object.defineProperty(K,"RequestType4",{enumerable:!0,get:function(){return ut.RequestType4}});Object.defineProperty(K,"RequestType5",{enumerable:!0,get:function(){return ut.RequestType5}});Object.defineProperty(K,"RequestType6",{enumerable:!0,get:function(){return ut.RequestType6}});Object.defineProperty(K,"RequestType7",{enumerable:!0,get:function(){return ut.RequestType7}});Object.defineProperty(K,"RequestType8",{enumerable:!0,get:function(){return ut.RequestType8}});Object.defineProperty(K,"RequestType9",{enumerable:!0,get:function(){return ut.RequestType9}});Object.defineProperty(K,"ResponseError",{enumerable:!0,get:function(){return ut.ResponseError}});Object.defineProperty(K,"ErrorCodes",{enumerable:!0,get:function(){return ut.ErrorCodes}});Object.defineProperty(K,"NotificationType",{enumerable:!0,get:function(){return ut.NotificationType}});Object.defineProperty(K,"NotificationType0",{enumerable:!0,get:function(){return ut.NotificationType0}});Object.defineProperty(K,"NotificationType1",{enumerable:!0,get:function(){return ut.NotificationType1}});Object.defineProperty(K,"NotificationType2",{enumerable:!0,get:function(){return ut.NotificationType2}});Object.defineProperty(K,"NotificationType3",{enumerable:!0,get:function(){return ut.NotificationType3}});Object.defineProperty(K,"NotificationType4",{enumerable:!0,get:function(){return ut.NotificationType4}});Object.defineProperty(K,"NotificationType5",{enumerable:!0,get:function(){return ut.NotificationType5}});Object.defineProperty(K,"NotificationType6",{enumerable:!0,get:function(){return ut.NotificationType6}});Object.defineProperty(K,"NotificationType7",{enumerable:!0,get:function(){return ut.NotificationType7}});Object.defineProperty(K,"NotificationType8",{enumerable:!0,get:function(){return ut.NotificationType8}});Object.defineProperty(K,"NotificationType9",{enumerable:!0,get:function(){return ut.NotificationType9}});Object.defineProperty(K,"ParameterStructures",{enumerable:!0,get:function(){return ut.ParameterStructures}});var FC=Iu();Object.defineProperty(K,"Disposable",{enumerable:!0,get:function(){return FC.Disposable}});var Bm=Mi();Object.defineProperty(K,"Event",{enumerable:!0,get:function(){return Bm.Event}});Object.defineProperty(K,"Emitter",{enumerable:!0,get:function(){return Bm.Emitter}});var Um=ul();Object.defineProperty(K,"CancellationTokenSource",{enumerable:!0,get:function(){return Um.CancellationTokenSource}});Object.defineProperty(K,"CancellationToken",{enumerable:!0,get:function(){return Um.CancellationToken}});var Cl=Pm();Object.defineProperty(K,"MessageReader",{enumerable:!0,get:function(){return Cl.MessageReader}});Object.defineProperty(K,"AbstractMessageReader",{enumerable:!0,get:function(){return Cl.AbstractMessageReader}});Object.defineProperty(K,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Cl.ReadableStreamMessageReader}});var xl=Nm();Object.defineProperty(K,"MessageWriter",{enumerable:!0,get:function(){return xl.MessageWriter}});Object.defineProperty(K,"AbstractMessageWriter",{enumerable:!0,get:function(){return xl.AbstractMessageWriter}});Object.defineProperty(K,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return xl.WriteableStreamMessageWriter}});var fn=jm();Object.defineProperty(K,"ConnectionStrategy",{enumerable:!0,get:function(){return fn.ConnectionStrategy}});Object.defineProperty(K,"ConnectionOptions",{enumerable:!0,get:function(){return fn.ConnectionOptions}});Object.defineProperty(K,"NullLogger",{enumerable:!0,get:function(){return fn.NullLogger}});Object.defineProperty(K,"createMessageConnection",{enumerable:!0,get:function(){return fn.createMessageConnection}});Object.defineProperty(K,"ProgressType",{enumerable:!0,get:function(){return fn.ProgressType}});Object.defineProperty(K,"Trace",{enumerable:!0,get:function(){return fn.Trace}});Object.defineProperty(K,"TraceFormat",{enumerable:!0,get:function(){return fn.TraceFormat}});Object.defineProperty(K,"SetTraceNotification",{enumerable:!0,get:function(){return fn.SetTraceNotification}});Object.defineProperty(K,"LogTraceNotification",{enumerable:!0,get:function(){return fn.LogTraceNotification}});Object.defineProperty(K,"ConnectionErrors",{enumerable:!0,get:function(){return fn.ConnectionErrors}});Object.defineProperty(K,"ConnectionError",{enumerable:!0,get:function(){return fn.ConnectionError}});Object.defineProperty(K,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return fn.CancellationReceiverStrategy}});Object.defineProperty(K,"CancellationSenderStrategy",{enumerable:!0,get:function(){return fn.CancellationSenderStrategy}});Object.defineProperty(K,"CancellationStrategy",{enumerable:!0,get:function(){return fn.CancellationStrategy}});var MC=ur();K.RAL=MC.default});var ri=B(We=>{"use strict";var $C=We&&We.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),jC=We&&We.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&$C(e,r,t)};Object.defineProperty(We,"__esModule",{value:!0});We.createMessageConnection=We.createServerSocketTransport=We.createClientSocketTransport=We.createServerPipeTransport=We.createClientPipeTransport=We.generateRandomPipeName=We.StreamMessageWriter=We.StreamMessageReader=We.SocketMessageWriter=We.SocketMessageReader=We.IPCMessageWriter=We.IPCMessageReader=void 0;var ji=Cm();ji.default.install();var Zn=El(),zm=require("path"),BC=require("os"),UC=require("crypto"),wa=require("net");jC(El(),We);var kl=class extends Zn.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Zn.Disposable.create(()=>this.process.off("message",e))}};We.IPCMessageReader=kl;var Tl=class extends Zn.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};We.IPCMessageWriter=Tl;var ti=class extends Zn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super(ji.default().stream.asReadableStream(e),t)}};We.SocketMessageReader=ti;var ni=class extends Zn.WriteableStreamMessageWriter{constructor(e,t){super(ji.default().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};We.SocketMessageWriter=ni;var va=class extends Zn.ReadableStreamMessageReader{constructor(e,t){super(ji.default().stream.asReadableStream(e),t)}};We.StreamMessageReader=va;var ya=class extends Zn.WriteableStreamMessageWriter{constructor(e,t){super(ji.default().stream.asWritableStream(e),t)}};We.StreamMessageWriter=ya;var Gm=process.env.XDG_RUNTIME_DIR,zC=new Map([["linux",107],["darwin",103]]);function GC(){let r=UC.randomBytes(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${r}-sock`;let e;Gm?e=zm.join(Gm,`vscode-ipc-${r}.sock`):e=zm.join(BC.tmpdir(),`vscode-${r}.sock`);let t=zC.get(process.platform);return t!==void 0&&e.length>=t&&ji.default().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}We.generateRandomPipeName=GC;function VC(r,e="utf-8"){let t,n=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=wa.createServer(a=>{o.close(),t([new ti(a,e),new ni(a,e)])});o.on("error",s),o.listen(r,()=>{o.removeListener("error",s),i({onConnected:()=>n})})})}We.createClientPipeTransport=VC;function WC(r,e="utf-8"){let t=wa.createConnection(r);return[new ti(t,e),new ni(t,e)]}We.createServerPipeTransport=WC;function HC(r,e="utf-8"){let t,n=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=wa.createServer(a=>{o.close(),t([new ti(a,e),new ni(a,e)])});o.on("error",s),o.listen(r,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>n})})})}We.createClientSocketTransport=HC;function KC(r,e="utf-8"){let t=wa.createConnection(r,"127.0.0.1");return[new ti(t,e),new ni(t,e)]}We.createServerSocketTransport=KC;function YC(r){let e=r;return e.read!==void 0&&e.addListener!==void 0}function XC(r){let e=r;return e.write!==void 0&&e.addListener!==void 0}function QC(r,e,t,n){t||(t=Zn.NullLogger);let i=YC(r)?new va(r):r,s=XC(e)?new ya(e):e;return Zn.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),Zn.createMessageConnection(i,s,t,n)}We.createMessageConnection=QC});var Pl=B((mA,Vm)=>{"use strict";Vm.exports=ri()});var Hm=B((Wm,Ra)=>{(function(r){if(typeof Ra=="object"&&typeof Ra.exports=="object"){var e=r(require,Wm);e!==void 0&&(Ra.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],r)})(function(r,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionKind=e.DocumentSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=void 0;var t;(function(R){R.MIN_VALUE=-2147483648,R.MAX_VALUE=2147483647})(t=e.integer||(e.integer={}));var n;(function(R){R.MIN_VALUE=0,R.MAX_VALUE=2147483647})(n=e.uinteger||(e.uinteger={}));var i;(function(R){function O(d,p){return d===Number.MAX_VALUE&&(d=n.MAX_VALUE),p===Number.MAX_VALUE&&(p=n.MAX_VALUE),{line:d,character:p}}R.create=O;function q(d){var p=d;return I.objectLiteral(p)&&I.uinteger(p.line)&&I.uinteger(p.character)}R.is=q})(i=e.Position||(e.Position={}));var s;(function(R){function O(d,p,A,$){if(I.uinteger(d)&&I.uinteger(p)&&I.uinteger(A)&&I.uinteger($))return{start:i.create(d,p),end:i.create(A,$)};if(i.is(d)&&i.is(p))return{start:d,end:p};throw new Error("Range#create called with invalid arguments["+d+", "+p+", "+A+", "+$+"]")}R.create=O;function q(d){var p=d;return I.objectLiteral(p)&&i.is(p.start)&&i.is(p.end)}R.is=q})(s=e.Range||(e.Range={}));var o;(function(R){function O(d,p){return{uri:d,range:p}}R.create=O;function q(d){var p=d;return I.defined(p)&&s.is(p.range)&&(I.string(p.uri)||I.undefined(p.uri))}R.is=q})(o=e.Location||(e.Location={}));var a;(function(R){function O(d,p,A,$){return{targetUri:d,targetRange:p,targetSelectionRange:A,originSelectionRange:$}}R.create=O;function q(d){var p=d;return I.defined(p)&&s.is(p.targetRange)&&I.string(p.targetUri)&&(s.is(p.targetSelectionRange)||I.undefined(p.targetSelectionRange))&&(s.is(p.originSelectionRange)||I.undefined(p.originSelectionRange))}R.is=q})(a=e.LocationLink||(e.LocationLink={}));var c;(function(R){function O(d,p,A,$){return{red:d,green:p,blue:A,alpha:$}}R.create=O;function q(d){var p=d;return I.numberRange(p.red,0,1)&&I.numberRange(p.green,0,1)&&I.numberRange(p.blue,0,1)&&I.numberRange(p.alpha,0,1)}R.is=q})(c=e.Color||(e.Color={}));var u;(function(R){function O(d,p){return{range:d,color:p}}R.create=O;function q(d){var p=d;return s.is(p.range)&&c.is(p.color)}R.is=q})(u=e.ColorInformation||(e.ColorInformation={}));var h;(function(R){function O(d,p,A){return{label:d,textEdit:p,additionalTextEdits:A}}R.create=O;function q(d){var p=d;return I.string(p.label)&&(I.undefined(p.textEdit)||y.is(p))&&(I.undefined(p.additionalTextEdits)||I.typedArray(p.additionalTextEdits,y.is))}R.is=q})(h=e.ColorPresentation||(e.ColorPresentation={}));var v;(function(R){R.Comment="comment",R.Imports="imports",R.Region="region"})(v=e.FoldingRangeKind||(e.FoldingRangeKind={}));var m;(function(R){function O(d,p,A,$,Y){var se={startLine:d,endLine:p};return I.defined(A)&&(se.startCharacter=A),I.defined($)&&(se.endCharacter=$),I.defined(Y)&&(se.kind=Y),se}R.create=O;function q(d){var p=d;return I.uinteger(p.startLine)&&I.uinteger(p.startLine)&&(I.undefined(p.startCharacter)||I.uinteger(p.startCharacter))&&(I.undefined(p.endCharacter)||I.uinteger(p.endCharacter))&&(I.undefined(p.kind)||I.string(p.kind))}R.is=q})(m=e.FoldingRange||(e.FoldingRange={}));var b;(function(R){function O(d,p){return{location:d,message:p}}R.create=O;function q(d){var p=d;return I.defined(p)&&o.is(p.location)&&I.string(p.message)}R.is=q})(b=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var k;(function(R){R.Error=1,R.Warning=2,R.Information=3,R.Hint=4})(k=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var f;(function(R){R.Unnecessary=1,R.Deprecated=2})(f=e.DiagnosticTag||(e.DiagnosticTag={}));var _;(function(R){function O(q){var d=q;return d!=null&&I.string(d.href)}R.is=O})(_=e.CodeDescription||(e.CodeDescription={}));var w;(function(R){function O(d,p,A,$,Y,se){var Re={range:d,message:p};return I.defined(A)&&(Re.severity=A),I.defined($)&&(Re.code=$),I.defined(Y)&&(Re.source=Y),I.defined(se)&&(Re.relatedInformation=se),Re}R.create=O;function q(d){var p,A=d;return I.defined(A)&&s.is(A.range)&&I.string(A.message)&&(I.number(A.severity)||I.undefined(A.severity))&&(I.integer(A.code)||I.string(A.code)||I.undefined(A.code))&&(I.undefined(A.codeDescription)||I.string((p=A.codeDescription)===null||p===void 0?void 0:p.href))&&(I.string(A.source)||I.undefined(A.source))&&(I.undefined(A.relatedInformation)||I.typedArray(A.relatedInformation,b.is))}R.is=q})(w=e.Diagnostic||(e.Diagnostic={}));var S;(function(R){function O(d,p){for(var A=[],$=2;$<arguments.length;$++)A[$-2]=arguments[$];var Y={title:d,command:p};return I.defined(A)&&A.length>0&&(Y.arguments=A),Y}R.create=O;function q(d){var p=d;return I.defined(p)&&I.string(p.title)&&I.string(p.command)}R.is=q})(S=e.Command||(e.Command={}));var y;(function(R){function O(A,$){return{range:A,newText:$}}R.replace=O;function q(A,$){return{range:{start:A,end:A},newText:$}}R.insert=q;function d(A){return{range:A,newText:""}}R.del=d;function p(A){var $=A;return I.objectLiteral($)&&I.string($.newText)&&s.is($.range)}R.is=p})(y=e.TextEdit||(e.TextEdit={}));var l;(function(R){function O(d,p,A){var $={label:d};return p!==void 0&&($.needsConfirmation=p),A!==void 0&&($.description=A),$}R.create=O;function q(d){var p=d;return p!==void 0&&I.objectLiteral(p)&&I.string(p.label)&&(I.boolean(p.needsConfirmation)||p.needsConfirmation===void 0)&&(I.string(p.description)||p.description===void 0)}R.is=q})(l=e.ChangeAnnotation||(e.ChangeAnnotation={}));var x;(function(R){function O(q){var d=q;return typeof d=="string"}R.is=O})(x=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var E;(function(R){function O(A,$,Y){return{range:A,newText:$,annotationId:Y}}R.replace=O;function q(A,$,Y){return{range:{start:A,end:A},newText:$,annotationId:Y}}R.insert=q;function d(A,$){return{range:A,newText:"",annotationId:$}}R.del=d;function p(A){var $=A;return y.is($)&&(l.is($.annotationId)||x.is($.annotationId))}R.is=p})(E=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var C;(function(R){function O(d,p){return{textDocument:d,edits:p}}R.create=O;function q(d){var p=d;return I.defined(p)&&ee.is(p.textDocument)&&Array.isArray(p.edits)}R.is=q})(C=e.TextDocumentEdit||(e.TextDocumentEdit={}));var T;(function(R){function O(d,p,A){var $={kind:"create",uri:d};return p!==void 0&&(p.overwrite!==void 0||p.ignoreIfExists!==void 0)&&($.options=p),A!==void 0&&($.annotationId=A),$}R.create=O;function q(d){var p=d;return p&&p.kind==="create"&&I.string(p.uri)&&(p.options===void 0||(p.options.overwrite===void 0||I.boolean(p.options.overwrite))&&(p.options.ignoreIfExists===void 0||I.boolean(p.options.ignoreIfExists)))&&(p.annotationId===void 0||x.is(p.annotationId))}R.is=q})(T=e.CreateFile||(e.CreateFile={}));var D;(function(R){function O(d,p,A,$){var Y={kind:"rename",oldUri:d,newUri:p};return A!==void 0&&(A.overwrite!==void 0||A.ignoreIfExists!==void 0)&&(Y.options=A),$!==void 0&&(Y.annotationId=$),Y}R.create=O;function q(d){var p=d;return p&&p.kind==="rename"&&I.string(p.oldUri)&&I.string(p.newUri)&&(p.options===void 0||(p.options.overwrite===void 0||I.boolean(p.options.overwrite))&&(p.options.ignoreIfExists===void 0||I.boolean(p.options.ignoreIfExists)))&&(p.annotationId===void 0||x.is(p.annotationId))}R.is=q})(D=e.RenameFile||(e.RenameFile={}));var F;(function(R){function O(d,p,A){var $={kind:"delete",uri:d};return p!==void 0&&(p.recursive!==void 0||p.ignoreIfNotExists!==void 0)&&($.options=p),A!==void 0&&($.annotationId=A),$}R.create=O;function q(d){var p=d;return p&&p.kind==="delete"&&I.string(p.uri)&&(p.options===void 0||(p.options.recursive===void 0||I.boolean(p.options.recursive))&&(p.options.ignoreIfNotExists===void 0||I.boolean(p.options.ignoreIfNotExists)))&&(p.annotationId===void 0||x.is(p.annotationId))}R.is=q})(F=e.DeleteFile||(e.DeleteFile={}));var z;(function(R){function O(q){var d=q;return d&&(d.changes!==void 0||d.documentChanges!==void 0)&&(d.documentChanges===void 0||d.documentChanges.every(function(p){return I.string(p.kind)?T.is(p)||D.is(p)||F.is(p):C.is(p)}))}R.is=O})(z=e.WorkspaceEdit||(e.WorkspaceEdit={}));var H=function(){function R(O,q){this.edits=O,this.changeAnnotations=q}return R.prototype.insert=function(O,q,d){var p,A;if(d===void 0?p=y.insert(O,q):x.is(d)?(A=d,p=E.insert(O,q,d)):(this.assertChangeAnnotations(this.changeAnnotations),A=this.changeAnnotations.manage(d),p=E.insert(O,q,A)),this.edits.push(p),A!==void 0)return A},R.prototype.replace=function(O,q,d){var p,A;if(d===void 0?p=y.replace(O,q):x.is(d)?(A=d,p=E.replace(O,q,d)):(this.assertChangeAnnotations(this.changeAnnotations),A=this.changeAnnotations.manage(d),p=E.replace(O,q,A)),this.edits.push(p),A!==void 0)return A},R.prototype.delete=function(O,q){var d,p;if(q===void 0?d=y.del(O):x.is(q)?(p=q,d=E.del(O,q)):(this.assertChangeAnnotations(this.changeAnnotations),p=this.changeAnnotations.manage(q),d=E.del(O,p)),this.edits.push(d),p!==void 0)return p},R.prototype.add=function(O){this.edits.push(O)},R.prototype.all=function(){return this.edits},R.prototype.clear=function(){this.edits.splice(0,this.edits.length)},R.prototype.assertChangeAnnotations=function(O){if(O===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},R}(),Q=function(){function R(O){this._annotations=O===void 0?Object.create(null):O,this._counter=0,this._size=0}return R.prototype.all=function(){return this._annotations},Object.defineProperty(R.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),R.prototype.manage=function(O,q){var d;if(x.is(O)?d=O:(d=this.nextId(),q=O),this._annotations[d]!==void 0)throw new Error("Id "+d+" is already in use.");if(q===void 0)throw new Error("No annotation provided for id "+d);return this._annotations[d]=q,this._size++,d},R.prototype.nextId=function(){return this._counter++,this._counter.toString()},R}(),J=function(){function R(O){var q=this;this._textEditChanges=Object.create(null),O!==void 0?(this._workspaceEdit=O,O.documentChanges?(this._changeAnnotations=new Q(O.changeAnnotations),O.changeAnnotations=this._changeAnnotations.all(),O.documentChanges.forEach(function(d){if(C.is(d)){var p=new H(d.edits,q._changeAnnotations);q._textEditChanges[d.textDocument.uri]=p}})):O.changes&&Object.keys(O.changes).forEach(function(d){var p=new H(O.changes[d]);q._textEditChanges[d]=p})):this._workspaceEdit={}}return Object.defineProperty(R.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),R.prototype.getTextEditChange=function(O){if(ee.is(O)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var q={uri:O.uri,version:O.version},d=this._textEditChanges[q.uri];if(!d){var p=[],A={textDocument:q,edits:p};this._workspaceEdit.documentChanges.push(A),d=new H(p,this._changeAnnotations),this._textEditChanges[q.uri]=d}return d}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var d=this._textEditChanges[O];if(!d){var p=[];this._workspaceEdit.changes[O]=p,d=new H(p),this._textEditChanges[O]=d}return d}},R.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Q,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},R.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},R.prototype.createFile=function(O,q,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p;l.is(q)||x.is(q)?p=q:d=q;var A,$;if(p===void 0?A=T.create(O,d):($=x.is(p)?p:this._changeAnnotations.manage(p),A=T.create(O,d,$)),this._workspaceEdit.documentChanges.push(A),$!==void 0)return $},R.prototype.renameFile=function(O,q,d,p){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var A;l.is(d)||x.is(d)?A=d:p=d;var $,Y;if(A===void 0?$=D.create(O,q,p):(Y=x.is(A)?A:this._changeAnnotations.manage(A),$=D.create(O,q,p,Y)),this._workspaceEdit.documentChanges.push($),Y!==void 0)return Y},R.prototype.deleteFile=function(O,q,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p;l.is(q)||x.is(q)?p=q:d=q;var A,$;if(p===void 0?A=F.create(O,d):($=x.is(p)?p:this._changeAnnotations.manage(p),A=F.create(O,d,$)),this._workspaceEdit.documentChanges.push(A),$!==void 0)return $},R}();e.WorkspaceChange=J;var ie;(function(R){function O(d){return{uri:d}}R.create=O;function q(d){var p=d;return I.defined(p)&&I.string(p.uri)}R.is=q})(ie=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var be;(function(R){function O(d,p){return{uri:d,version:p}}R.create=O;function q(d){var p=d;return I.defined(p)&&I.string(p.uri)&&I.integer(p.version)}R.is=q})(be=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var ee;(function(R){function O(d,p){return{uri:d,version:p}}R.create=O;function q(d){var p=d;return I.defined(p)&&I.string(p.uri)&&(p.version===null||I.integer(p.version))}R.is=q})(ee=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var Ae;(function(R){function O(d,p,A,$){return{uri:d,languageId:p,version:A,text:$}}R.create=O;function q(d){var p=d;return I.defined(p)&&I.string(p.uri)&&I.string(p.languageId)&&I.integer(p.version)&&I.string(p.text)}R.is=q})(Ae=e.TextDocumentItem||(e.TextDocumentItem={}));var ae;(function(R){R.PlainText="plaintext",R.Markdown="markdown"})(ae=e.MarkupKind||(e.MarkupKind={})),function(R){function O(q){var d=q;return d===R.PlainText||d===R.Markdown}R.is=O}(ae=e.MarkupKind||(e.MarkupKind={}));var Ee;(function(R){function O(q){var d=q;return I.objectLiteral(q)&&ae.is(d.kind)&&I.string(d.value)}R.is=O})(Ee=e.MarkupContent||(e.MarkupContent={}));var ge;(function(R){R.Text=1,R.Method=2,R.Function=3,R.Constructor=4,R.Field=5,R.Variable=6,R.Class=7,R.Interface=8,R.Module=9,R.Property=10,R.Unit=11,R.Value=12,R.Enum=13,R.Keyword=14,R.Snippet=15,R.Color=16,R.File=17,R.Reference=18,R.Folder=19,R.EnumMember=20,R.Constant=21,R.Struct=22,R.Event=23,R.Operator=24,R.TypeParameter=25})(ge=e.CompletionItemKind||(e.CompletionItemKind={}));var me;(function(R){R.PlainText=1,R.Snippet=2})(me=e.InsertTextFormat||(e.InsertTextFormat={}));var De;(function(R){R.Deprecated=1})(De=e.CompletionItemTag||(e.CompletionItemTag={}));var Je;(function(R){function O(d,p,A){return{newText:d,insert:p,replace:A}}R.create=O;function q(d){var p=d;return p&&I.string(p.newText)&&s.is(p.insert)&&s.is(p.replace)}R.is=q})(Je=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var W;(function(R){R.asIs=1,R.adjustIndentation=2})(W=e.InsertTextMode||(e.InsertTextMode={}));var je;(function(R){function O(q){return{label:q}}R.create=O})(je=e.CompletionItem||(e.CompletionItem={}));var ke;(function(R){function O(q,d){return{items:q||[],isIncomplete:!!d}}R.create=O})(ke=e.CompletionList||(e.CompletionList={}));var Qe;(function(R){function O(d){return d.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}R.fromPlainText=O;function q(d){var p=d;return I.string(p)||I.objectLiteral(p)&&I.string(p.language)&&I.string(p.value)}R.is=q})(Qe=e.MarkedString||(e.MarkedString={}));var Et;(function(R){function O(q){var d=q;return!!d&&I.objectLiteral(d)&&(Ee.is(d.contents)||Qe.is(d.contents)||I.typedArray(d.contents,Qe.is))&&(q.range===void 0||s.is(q.range))}R.is=O})(Et=e.Hover||(e.Hover={}));var rt;(function(R){function O(q,d){return d?{label:q,documentation:d}:{label:q}}R.create=O})(rt=e.ParameterInformation||(e.ParameterInformation={}));var Gt;(function(R){function O(q,d){for(var p=[],A=2;A<arguments.length;A++)p[A-2]=arguments[A];var $={label:q};return I.defined(d)&&($.documentation=d),I.defined(p)?$.parameters=p:$.parameters=[],$}R.create=O})(Gt=e.SignatureInformation||(e.SignatureInformation={}));var Ge;(function(R){R.Text=1,R.Read=2,R.Write=3})(Ge=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var Qt;(function(R){function O(q,d){var p={range:q};return I.number(d)&&(p.kind=d),p}R.create=O})(Qt=e.DocumentHighlight||(e.DocumentHighlight={}));var wt;(function(R){R.File=1,R.Module=2,R.Namespace=3,R.Package=4,R.Class=5,R.Method=6,R.Property=7,R.Field=8,R.Constructor=9,R.Enum=10,R.Interface=11,R.Function=12,R.Variable=13,R.Constant=14,R.String=15,R.Number=16,R.Boolean=17,R.Array=18,R.Object=19,R.Key=20,R.Null=21,R.EnumMember=22,R.Struct=23,R.Event=24,R.Operator=25,R.TypeParameter=26})(wt=e.SymbolKind||(e.SymbolKind={}));var Zt;(function(R){R.Deprecated=1})(Zt=e.SymbolTag||(e.SymbolTag={}));var He;(function(R){function O(q,d,p,A,$){var Y={name:q,kind:d,location:{uri:A,range:p}};return $&&(Y.containerName=$),Y}R.create=O})(He=e.SymbolInformation||(e.SymbolInformation={}));var ft;(function(R){function O(d,p,A,$,Y,se){var Re={name:d,detail:p,kind:A,range:$,selectionRange:Y};return se!==void 0&&(Re.children=se),Re}R.create=O;function q(d){var p=d;return p&&I.string(p.name)&&I.number(p.kind)&&s.is(p.range)&&s.is(p.selectionRange)&&(p.detail===void 0||I.string(p.detail))&&(p.deprecated===void 0||I.boolean(p.deprecated))&&(p.children===void 0||Array.isArray(p.children))&&(p.tags===void 0||Array.isArray(p.tags))}R.is=q})(ft=e.DocumentSymbol||(e.DocumentSymbol={}));var mt;(function(R){R.Empty="",R.QuickFix="quickfix",R.Refactor="refactor",R.RefactorExtract="refactor.extract",R.RefactorInline="refactor.inline",R.RefactorRewrite="refactor.rewrite",R.Source="source",R.SourceOrganizeImports="source.organizeImports",R.SourceFixAll="source.fixAll"})(mt=e.CodeActionKind||(e.CodeActionKind={}));var un;(function(R){function O(d,p){var A={diagnostics:d};return p!=null&&(A.only=p),A}R.create=O;function q(d){var p=d;return I.defined(p)&&I.typedArray(p.diagnostics,w.is)&&(p.only===void 0||I.typedArray(p.only,I.string))}R.is=q})(un=e.CodeActionContext||(e.CodeActionContext={}));var kt;(function(R){function O(d,p,A){var $={title:d},Y=!0;return typeof p=="string"?(Y=!1,$.kind=p):S.is(p)?$.command=p:$.edit=p,Y&&A!==void 0&&($.kind=A),$}R.create=O;function q(d){var p=d;return p&&I.string(p.title)&&(p.diagnostics===void 0||I.typedArray(p.diagnostics,w.is))&&(p.kind===void 0||I.string(p.kind))&&(p.edit!==void 0||p.command!==void 0)&&(p.command===void 0||S.is(p.command))&&(p.isPreferred===void 0||I.boolean(p.isPreferred))&&(p.edit===void 0||z.is(p.edit))}R.is=q})(kt=e.CodeAction||(e.CodeAction={}));var mn;(function(R){function O(d,p){var A={range:d};return I.defined(p)&&(A.data=p),A}R.create=O;function q(d){var p=d;return I.defined(p)&&s.is(p.range)&&(I.undefined(p.command)||S.is(p.command))}R.is=q})(mn=e.CodeLens||(e.CodeLens={}));var qt;(function(R){function O(d,p){return{tabSize:d,insertSpaces:p}}R.create=O;function q(d){var p=d;return I.defined(p)&&I.uinteger(p.tabSize)&&I.boolean(p.insertSpaces)}R.is=q})(qt=e.FormattingOptions||(e.FormattingOptions={}));var Ft;(function(R){function O(d,p,A){return{range:d,target:p,data:A}}R.create=O;function q(d){var p=d;return I.defined(p)&&s.is(p.range)&&(I.undefined(p.target)||I.string(p.target))}R.is=q})(Ft=e.DocumentLink||(e.DocumentLink={}));var Jt;(function(R){function O(d,p){return{range:d,parent:p}}R.create=O;function q(d){var p=d;return p!==void 0&&s.is(p.range)&&(p.parent===void 0||R.is(p.parent))}R.is=q})(Jt=e.SelectionRange||(e.SelectionRange={})),e.EOL=[`
`,`\r
`,"\r"];var Vt;(function(R){function O(A,$,Y,se){return new L(A,$,Y,se)}R.create=O;function q(A){var $=A;return!!(I.defined($)&&I.string($.uri)&&(I.undefined($.languageId)||I.string($.languageId))&&I.uinteger($.lineCount)&&I.func($.getText)&&I.func($.positionAt)&&I.func($.offsetAt))}R.is=q;function d(A,$){for(var Y=A.getText(),se=p($,function(V,X){var te=V.range.start.line-X.range.start.line;return te===0?V.range.start.character-X.range.start.character:te}),Re=Y.length,Ue=se.length-1;Ue>=0;Ue--){var M=se[Ue],j=A.offsetAt(M.range.start),G=A.offsetAt(M.range.end);if(G<=Re)Y=Y.substring(0,j)+M.newText+Y.substring(G,Y.length);else throw new Error("Overlapping edit");Re=j}return Y}R.applyEdits=d;function p(A,$){if(A.length<=1)return A;var Y=A.length/2|0,se=A.slice(0,Y),Re=A.slice(Y);p(se,$),p(Re,$);for(var Ue=0,M=0,j=0;Ue<se.length&&M<Re.length;){var G=$(se[Ue],Re[M]);G<=0?A[j++]=se[Ue++]:A[j++]=Re[M++]}for(;Ue<se.length;)A[j++]=se[Ue++];for(;M<Re.length;)A[j++]=Re[M++];return A}})(Vt=e.TextDocument||(e.TextDocument={}));var L=function(){function R(O,q,d,p){this._uri=O,this._languageId=q,this._version=d,this._content=p,this._lineOffsets=void 0}return Object.defineProperty(R.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),R.prototype.getText=function(O){if(O){var q=this.offsetAt(O.start),d=this.offsetAt(O.end);return this._content.substring(q,d)}return this._content},R.prototype.update=function(O,q){this._content=O.text,this._version=q,this._lineOffsets=void 0},R.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var O=[],q=this._content,d=!0,p=0;p<q.length;p++){d&&(O.push(p),d=!1);var A=q.charAt(p);d=A==="\r"||A===`
`,A==="\r"&&p+1<q.length&&q.charAt(p+1)===`
`&&p++}d&&q.length>0&&O.push(q.length),this._lineOffsets=O}return this._lineOffsets},R.prototype.positionAt=function(O){O=Math.max(Math.min(O,this._content.length),0);var q=this.getLineOffsets(),d=0,p=q.length;if(p===0)return i.create(0,O);for(;d<p;){var A=Math.floor((d+p)/2);q[A]>O?p=A:d=A+1}var $=d-1;return i.create($,O-q[$])},R.prototype.offsetAt=function(O){var q=this.getLineOffsets();if(O.line>=q.length)return this._content.length;if(O.line<0)return 0;var d=q[O.line],p=O.line+1<q.length?q[O.line+1]:this._content.length;return Math.max(Math.min(d+O.character,p),d)},Object.defineProperty(R.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),R}(),I;(function(R){var O=Object.prototype.toString;function q(G){return typeof G<"u"}R.defined=q;function d(G){return typeof G>"u"}R.undefined=d;function p(G){return G===!0||G===!1}R.boolean=p;function A(G){return O.call(G)==="[object String]"}R.string=A;function $(G){return O.call(G)==="[object Number]"}R.number=$;function Y(G,V,X){return O.call(G)==="[object Number]"&&V<=G&&G<=X}R.numberRange=Y;function se(G){return O.call(G)==="[object Number]"&&-2147483648<=G&&G<=2147483647}R.integer=se;function Re(G){return O.call(G)==="[object Number]"&&0<=G&&G<=2147483647}R.uinteger=Re;function Ue(G){return O.call(G)==="[object Function]"}R.func=Ue;function M(G){return G!==null&&typeof G=="object"}R.objectLiteral=M;function j(G,V){return Array.isArray(G)&&G.every(V)}R.typedArray=j})(I||(I={}))})});var Ot=B(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.ProtocolNotificationType=kn.ProtocolNotificationType0=kn.ProtocolRequestType=kn.ProtocolRequestType0=kn.RegistrationType=void 0;var Bi=ri(),Il=class{constructor(e){this.method=e}};kn.RegistrationType=Il;var Dl=class extends Bi.RequestType0{constructor(e){super(e)}};kn.ProtocolRequestType0=Dl;var Ol=class extends Bi.RequestType{constructor(e){super(e,Bi.ParameterStructures.byName)}};kn.ProtocolRequestType=Ol;var Al=class extends Bi.NotificationType0{constructor(e){super(e)}};kn.ProtocolNotificationType0=Al;var Nl=class extends Bi.NotificationType{constructor(e){super(e,Bi.ParameterStructures.byName)}};kn.ProtocolNotificationType=Nl});var Xm=B(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.objectLiteral=St.typedArray=St.stringArray=St.array=St.func=St.error=St.number=St.string=St.boolean=void 0;function ZC(r){return r===!0||r===!1}St.boolean=ZC;function Km(r){return typeof r=="string"||r instanceof String}St.string=Km;function JC(r){return typeof r=="number"||r instanceof Number}St.number=JC;function e0(r){return r instanceof Error}St.error=e0;function t0(r){return typeof r=="function"}St.func=t0;function Ym(r){return Array.isArray(r)}St.array=Ym;function n0(r){return Ym(r)&&r.every(e=>Km(e))}St.stringArray=n0;function r0(r,e){return Array.isArray(r)&&r.every(e)}St.typedArray=r0;function i0(r){return r!==null&&typeof r=="object"}St.objectLiteral=i0});var Qm=B(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.ImplementationRequest=void 0;var s0=Ot(),o0;(function(r){r.method="textDocument/implementation",r.type=new s0.ProtocolRequestType(r.method)})(o0=Ks.ImplementationRequest||(Ks.ImplementationRequest={}))});var Zm=B(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.TypeDefinitionRequest=void 0;var a0=Ot(),c0;(function(r){r.method="textDocument/typeDefinition",r.type=new a0.ProtocolRequestType(r.method)})(c0=Ys.TypeDefinitionRequest||(Ys.TypeDefinitionRequest={}))});var e_=B(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.DidChangeWorkspaceFoldersNotification=Er.WorkspaceFoldersRequest=void 0;var Jm=Ot(),u0;(function(r){r.type=new Jm.ProtocolRequestType0("workspace/workspaceFolders")})(u0=Er.WorkspaceFoldersRequest||(Er.WorkspaceFoldersRequest={}));var l0;(function(r){r.type=new Jm.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")})(l0=Er.DidChangeWorkspaceFoldersNotification||(Er.DidChangeWorkspaceFoldersNotification={}))});var t_=B(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.ConfigurationRequest=void 0;var d0=Ot(),f0;(function(r){r.type=new d0.ProtocolRequestType("workspace/configuration")})(f0=Xs.ConfigurationRequest||(Xs.ConfigurationRequest={}))});var r_=B(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.ColorPresentationRequest=kr.DocumentColorRequest=void 0;var n_=Ot(),h0;(function(r){r.method="textDocument/documentColor",r.type=new n_.ProtocolRequestType(r.method)})(h0=kr.DocumentColorRequest||(kr.DocumentColorRequest={}));var p0;(function(r){r.type=new n_.ProtocolRequestType("textDocument/colorPresentation")})(p0=kr.ColorPresentationRequest||(kr.ColorPresentationRequest={}))});var i_=B(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.FoldingRangeRequest=Tr.FoldingRangeKind=void 0;var g0=Ot(),m0;(function(r){r.Comment="comment",r.Imports="imports",r.Region="region"})(m0=Tr.FoldingRangeKind||(Tr.FoldingRangeKind={}));var _0;(function(r){r.method="textDocument/foldingRange",r.type=new g0.ProtocolRequestType(r.method)})(_0=Tr.FoldingRangeRequest||(Tr.FoldingRangeRequest={}))});var s_=B(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.DeclarationRequest=void 0;var b0=Ot(),v0;(function(r){r.method="textDocument/declaration",r.type=new b0.ProtocolRequestType(r.method)})(v0=Qs.DeclarationRequest||(Qs.DeclarationRequest={}))});var o_=B(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.SelectionRangeRequest=void 0;var y0=Ot(),w0;(function(r){r.method="textDocument/selectionRange",r.type=new y0.ProtocolRequestType(r.method)})(w0=Zs.SelectionRangeRequest||(Zs.SelectionRangeRequest={}))});var c_=B(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.WorkDoneProgressCancelNotification=Nn.WorkDoneProgressCreateRequest=Nn.WorkDoneProgress=void 0;var R0=ri(),a_=Ot(),S0;(function(r){r.type=new R0.ProgressType;function e(t){return t===r.type}r.is=e})(S0=Nn.WorkDoneProgress||(Nn.WorkDoneProgress={}));var C0;(function(r){r.type=new a_.ProtocolRequestType("window/workDoneProgress/create")})(C0=Nn.WorkDoneProgressCreateRequest||(Nn.WorkDoneProgressCreateRequest={}));var x0;(function(r){r.type=new a_.ProtocolNotificationType("window/workDoneProgress/cancel")})(x0=Nn.WorkDoneProgressCancelNotification||(Nn.WorkDoneProgressCancelNotification={}))});var u_=B(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.CallHierarchyOutgoingCallsRequest=Ln.CallHierarchyIncomingCallsRequest=Ln.CallHierarchyPrepareRequest=void 0;var Ll=Ot(),E0;(function(r){r.method="textDocument/prepareCallHierarchy",r.type=new Ll.ProtocolRequestType(r.method)})(E0=Ln.CallHierarchyPrepareRequest||(Ln.CallHierarchyPrepareRequest={}));var k0;(function(r){r.method="callHierarchy/incomingCalls",r.type=new Ll.ProtocolRequestType(r.method)})(k0=Ln.CallHierarchyIncomingCallsRequest||(Ln.CallHierarchyIncomingCallsRequest={}));var T0;(function(r){r.method="callHierarchy/outgoingCalls",r.type=new Ll.ProtocolRequestType(r.method)})(T0=Ln.CallHierarchyOutgoingCallsRequest||(Ln.CallHierarchyOutgoingCallsRequest={}))});var l_=B(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.SemanticTokensRefreshRequest=Xe.SemanticTokensRangeRequest=Xe.SemanticTokensDeltaRequest=Xe.SemanticTokensRequest=Xe.SemanticTokensRegistrationType=Xe.TokenFormat=Xe.SemanticTokens=Xe.SemanticTokenModifiers=Xe.SemanticTokenTypes=void 0;var Js=Ot(),P0;(function(r){r.namespace="namespace",r.type="type",r.class="class",r.enum="enum",r.interface="interface",r.struct="struct",r.typeParameter="typeParameter",r.parameter="parameter",r.variable="variable",r.property="property",r.enumMember="enumMember",r.event="event",r.function="function",r.method="method",r.macro="macro",r.keyword="keyword",r.modifier="modifier",r.comment="comment",r.string="string",r.number="number",r.regexp="regexp",r.operator="operator"})(P0=Xe.SemanticTokenTypes||(Xe.SemanticTokenTypes={}));var I0;(function(r){r.declaration="declaration",r.definition="definition",r.readonly="readonly",r.static="static",r.deprecated="deprecated",r.abstract="abstract",r.async="async",r.modification="modification",r.documentation="documentation",r.defaultLibrary="defaultLibrary"})(I0=Xe.SemanticTokenModifiers||(Xe.SemanticTokenModifiers={}));var D0;(function(r){function e(t){let n=t;return n!==void 0&&(n.resultId===void 0||typeof n.resultId=="string")&&Array.isArray(n.data)&&(n.data.length===0||typeof n.data[0]=="number")}r.is=e})(D0=Xe.SemanticTokens||(Xe.SemanticTokens={}));var O0;(function(r){r.Relative="relative"})(O0=Xe.TokenFormat||(Xe.TokenFormat={}));var A0;(function(r){r.method="textDocument/semanticTokens",r.type=new Js.RegistrationType(r.method)})(A0=Xe.SemanticTokensRegistrationType||(Xe.SemanticTokensRegistrationType={}));var N0;(function(r){r.method="textDocument/semanticTokens/full",r.type=new Js.ProtocolRequestType(r.method)})(N0=Xe.SemanticTokensRequest||(Xe.SemanticTokensRequest={}));var L0;(function(r){r.method="textDocument/semanticTokens/full/delta",r.type=new Js.ProtocolRequestType(r.method)})(L0=Xe.SemanticTokensDeltaRequest||(Xe.SemanticTokensDeltaRequest={}));var q0;(function(r){r.method="textDocument/semanticTokens/range",r.type=new Js.ProtocolRequestType(r.method)})(q0=Xe.SemanticTokensRangeRequest||(Xe.SemanticTokensRangeRequest={}));var F0;(function(r){r.method="workspace/semanticTokens/refresh",r.type=new Js.ProtocolRequestType0(r.method)})(F0=Xe.SemanticTokensRefreshRequest||(Xe.SemanticTokensRefreshRequest={}))});var d_=B(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.ShowDocumentRequest=void 0;var M0=Ot(),$0;(function(r){r.method="window/showDocument",r.type=new M0.ProtocolRequestType(r.method)})($0=eo.ShowDocumentRequest||(eo.ShowDocumentRequest={}))});var f_=B(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.LinkedEditingRangeRequest=void 0;var j0=Ot(),B0;(function(r){r.method="textDocument/linkedEditingRange",r.type=new j0.ProtocolRequestType(r.method)})(B0=to.LinkedEditingRangeRequest||(to.LinkedEditingRangeRequest={}))});var h_=B(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.WillDeleteFilesRequest=ht.DidDeleteFilesNotification=ht.DidRenameFilesNotification=ht.WillRenameFilesRequest=ht.DidCreateFilesNotification=ht.WillCreateFilesRequest=ht.FileOperationPatternKind=void 0;var Ui=Ot(),U0;(function(r){r.file="file",r.folder="folder"})(U0=ht.FileOperationPatternKind||(ht.FileOperationPatternKind={}));var z0;(function(r){r.method="workspace/willCreateFiles",r.type=new Ui.ProtocolRequestType(r.method)})(z0=ht.WillCreateFilesRequest||(ht.WillCreateFilesRequest={}));var G0;(function(r){r.method="workspace/didCreateFiles",r.type=new Ui.ProtocolNotificationType(r.method)})(G0=ht.DidCreateFilesNotification||(ht.DidCreateFilesNotification={}));var V0;(function(r){r.method="workspace/willRenameFiles",r.type=new Ui.ProtocolRequestType(r.method)})(V0=ht.WillRenameFilesRequest||(ht.WillRenameFilesRequest={}));var W0;(function(r){r.method="workspace/didRenameFiles",r.type=new Ui.ProtocolNotificationType(r.method)})(W0=ht.DidRenameFilesNotification||(ht.DidRenameFilesNotification={}));var H0;(function(r){r.method="workspace/didDeleteFiles",r.type=new Ui.ProtocolNotificationType(r.method)})(H0=ht.DidDeleteFilesNotification||(ht.DidDeleteFilesNotification={}));var K0;(function(r){r.method="workspace/willDeleteFiles",r.type=new Ui.ProtocolRequestType(r.method)})(K0=ht.WillDeleteFilesRequest||(ht.WillDeleteFilesRequest={}))});var p_=B(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.MonikerRequest=qn.MonikerKind=qn.UniquenessLevel=void 0;var Y0=Ot(),X0;(function(r){r.document="document",r.project="project",r.group="group",r.scheme="scheme",r.global="global"})(X0=qn.UniquenessLevel||(qn.UniquenessLevel={}));var Q0;(function(r){r.import="import",r.export="export",r.local="local"})(Q0=qn.MonikerKind||(qn.MonikerKind={}));var Z0;(function(r){r.method="textDocument/moniker",r.type=new Y0.ProtocolRequestType(r.method)})(Z0=qn.MonikerRequest||(qn.MonikerRequest={}))});var v_=B(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.DocumentLinkRequest=P.CodeLensRefreshRequest=P.CodeLensResolveRequest=P.CodeLensRequest=P.WorkspaceSymbolRequest=P.CodeActionResolveRequest=P.CodeActionRequest=P.DocumentSymbolRequest=P.DocumentHighlightRequest=P.ReferencesRequest=P.DefinitionRequest=P.SignatureHelpRequest=P.SignatureHelpTriggerKind=P.HoverRequest=P.CompletionResolveRequest=P.CompletionRequest=P.CompletionTriggerKind=P.PublishDiagnosticsNotification=P.WatchKind=P.FileChangeType=P.DidChangeWatchedFilesNotification=P.WillSaveTextDocumentWaitUntilRequest=P.WillSaveTextDocumentNotification=P.TextDocumentSaveReason=P.DidSaveTextDocumentNotification=P.DidCloseTextDocumentNotification=P.DidChangeTextDocumentNotification=P.TextDocumentContentChangeEvent=P.DidOpenTextDocumentNotification=P.TextDocumentSyncKind=P.TelemetryEventNotification=P.LogMessageNotification=P.ShowMessageRequest=P.ShowMessageNotification=P.MessageType=P.DidChangeConfigurationNotification=P.ExitNotification=P.ShutdownRequest=P.InitializedNotification=P.InitializeError=P.InitializeRequest=P.WorkDoneProgressOptions=P.TextDocumentRegistrationOptions=P.StaticRegistrationOptions=P.FailureHandlingKind=P.ResourceOperationKind=P.UnregistrationRequest=P.RegistrationRequest=P.DocumentSelector=P.DocumentFilter=void 0;P.MonikerRequest=P.MonikerKind=P.UniquenessLevel=P.WillDeleteFilesRequest=P.DidDeleteFilesNotification=P.WillRenameFilesRequest=P.DidRenameFilesNotification=P.WillCreateFilesRequest=P.DidCreateFilesNotification=P.FileOperationPatternKind=P.LinkedEditingRangeRequest=P.ShowDocumentRequest=P.SemanticTokensRegistrationType=P.SemanticTokensRefreshRequest=P.SemanticTokensRangeRequest=P.SemanticTokensDeltaRequest=P.SemanticTokensRequest=P.TokenFormat=P.SemanticTokens=P.SemanticTokenModifiers=P.SemanticTokenTypes=P.CallHierarchyPrepareRequest=P.CallHierarchyOutgoingCallsRequest=P.CallHierarchyIncomingCallsRequest=P.WorkDoneProgressCancelNotification=P.WorkDoneProgressCreateRequest=P.WorkDoneProgress=P.SelectionRangeRequest=P.DeclarationRequest=P.FoldingRangeRequest=P.ColorPresentationRequest=P.DocumentColorRequest=P.ConfigurationRequest=P.DidChangeWorkspaceFoldersNotification=P.WorkspaceFoldersRequest=P.TypeDefinitionRequest=P.ImplementationRequest=P.ApplyWorkspaceEditRequest=P.ExecuteCommandRequest=P.PrepareRenameRequest=P.RenameRequest=P.PrepareSupportDefaultBehavior=P.DocumentOnTypeFormattingRequest=P.DocumentRangeFormattingRequest=P.DocumentFormattingRequest=P.DocumentLinkResolveRequest=void 0;var Pr=Xm(),Le=Ot(),J0=Qm();Object.defineProperty(P,"ImplementationRequest",{enumerable:!0,get:function(){return J0.ImplementationRequest}});var ex=Zm();Object.defineProperty(P,"TypeDefinitionRequest",{enumerable:!0,get:function(){return ex.TypeDefinitionRequest}});var g_=e_();Object.defineProperty(P,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return g_.WorkspaceFoldersRequest}});Object.defineProperty(P,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return g_.DidChangeWorkspaceFoldersNotification}});var tx=t_();Object.defineProperty(P,"ConfigurationRequest",{enumerable:!0,get:function(){return tx.ConfigurationRequest}});var m_=r_();Object.defineProperty(P,"DocumentColorRequest",{enumerable:!0,get:function(){return m_.DocumentColorRequest}});Object.defineProperty(P,"ColorPresentationRequest",{enumerable:!0,get:function(){return m_.ColorPresentationRequest}});var nx=i_();Object.defineProperty(P,"FoldingRangeRequest",{enumerable:!0,get:function(){return nx.FoldingRangeRequest}});var rx=s_();Object.defineProperty(P,"DeclarationRequest",{enumerable:!0,get:function(){return rx.DeclarationRequest}});var ix=o_();Object.defineProperty(P,"SelectionRangeRequest",{enumerable:!0,get:function(){return ix.SelectionRangeRequest}});var ql=c_();Object.defineProperty(P,"WorkDoneProgress",{enumerable:!0,get:function(){return ql.WorkDoneProgress}});Object.defineProperty(P,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return ql.WorkDoneProgressCreateRequest}});Object.defineProperty(P,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return ql.WorkDoneProgressCancelNotification}});var Fl=u_();Object.defineProperty(P,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Fl.CallHierarchyIncomingCallsRequest}});Object.defineProperty(P,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Fl.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(P,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Fl.CallHierarchyPrepareRequest}});var hr=l_();Object.defineProperty(P,"SemanticTokenTypes",{enumerable:!0,get:function(){return hr.SemanticTokenTypes}});Object.defineProperty(P,"SemanticTokenModifiers",{enumerable:!0,get:function(){return hr.SemanticTokenModifiers}});Object.defineProperty(P,"SemanticTokens",{enumerable:!0,get:function(){return hr.SemanticTokens}});Object.defineProperty(P,"TokenFormat",{enumerable:!0,get:function(){return hr.TokenFormat}});Object.defineProperty(P,"SemanticTokensRequest",{enumerable:!0,get:function(){return hr.SemanticTokensRequest}});Object.defineProperty(P,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return hr.SemanticTokensDeltaRequest}});Object.defineProperty(P,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return hr.SemanticTokensRangeRequest}});Object.defineProperty(P,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return hr.SemanticTokensRefreshRequest}});Object.defineProperty(P,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return hr.SemanticTokensRegistrationType}});var sx=d_();Object.defineProperty(P,"ShowDocumentRequest",{enumerable:!0,get:function(){return sx.ShowDocumentRequest}});var ox=f_();Object.defineProperty(P,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return ox.LinkedEditingRangeRequest}});var ii=h_();Object.defineProperty(P,"FileOperationPatternKind",{enumerable:!0,get:function(){return ii.FileOperationPatternKind}});Object.defineProperty(P,"DidCreateFilesNotification",{enumerable:!0,get:function(){return ii.DidCreateFilesNotification}});Object.defineProperty(P,"WillCreateFilesRequest",{enumerable:!0,get:function(){return ii.WillCreateFilesRequest}});Object.defineProperty(P,"DidRenameFilesNotification",{enumerable:!0,get:function(){return ii.DidRenameFilesNotification}});Object.defineProperty(P,"WillRenameFilesRequest",{enumerable:!0,get:function(){return ii.WillRenameFilesRequest}});Object.defineProperty(P,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return ii.DidDeleteFilesNotification}});Object.defineProperty(P,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return ii.WillDeleteFilesRequest}});var Ml=p_();Object.defineProperty(P,"UniquenessLevel",{enumerable:!0,get:function(){return Ml.UniquenessLevel}});Object.defineProperty(P,"MonikerKind",{enumerable:!0,get:function(){return Ml.MonikerKind}});Object.defineProperty(P,"MonikerRequest",{enumerable:!0,get:function(){return Ml.MonikerRequest}});var __;(function(r){function e(t){let n=t;return Pr.string(n.language)||Pr.string(n.scheme)||Pr.string(n.pattern)}r.is=e})(__=P.DocumentFilter||(P.DocumentFilter={}));var b_;(function(r){function e(t){if(!Array.isArray(t))return!1;for(let n of t)if(!Pr.string(n)&&!__.is(n))return!1;return!0}r.is=e})(b_=P.DocumentSelector||(P.DocumentSelector={}));var ax;(function(r){r.type=new Le.ProtocolRequestType("client/registerCapability")})(ax=P.RegistrationRequest||(P.RegistrationRequest={}));var cx;(function(r){r.type=new Le.ProtocolRequestType("client/unregisterCapability")})(cx=P.UnregistrationRequest||(P.UnregistrationRequest={}));var ux;(function(r){r.Create="create",r.Rename="rename",r.Delete="delete"})(ux=P.ResourceOperationKind||(P.ResourceOperationKind={}));var lx;(function(r){r.Abort="abort",r.Transactional="transactional",r.TextOnlyTransactional="textOnlyTransactional",r.Undo="undo"})(lx=P.FailureHandlingKind||(P.FailureHandlingKind={}));var dx;(function(r){function e(t){let n=t;return n&&Pr.string(n.id)&&n.id.length>0}r.hasId=e})(dx=P.StaticRegistrationOptions||(P.StaticRegistrationOptions={}));var fx;(function(r){function e(t){let n=t;return n&&(n.documentSelector===null||b_.is(n.documentSelector))}r.is=e})(fx=P.TextDocumentRegistrationOptions||(P.TextDocumentRegistrationOptions={}));var hx;(function(r){function e(n){let i=n;return Pr.objectLiteral(i)&&(i.workDoneProgress===void 0||Pr.boolean(i.workDoneProgress))}r.is=e;function t(n){let i=n;return i&&Pr.boolean(i.workDoneProgress)}r.hasWorkDoneProgress=t})(hx=P.WorkDoneProgressOptions||(P.WorkDoneProgressOptions={}));var px;(function(r){r.type=new Le.ProtocolRequestType("initialize")})(px=P.InitializeRequest||(P.InitializeRequest={}));var gx;(function(r){r.unknownProtocolVersion=1})(gx=P.InitializeError||(P.InitializeError={}));var mx;(function(r){r.type=new Le.ProtocolNotificationType("initialized")})(mx=P.InitializedNotification||(P.InitializedNotification={}));var _x;(function(r){r.type=new Le.ProtocolRequestType0("shutdown")})(_x=P.ShutdownRequest||(P.ShutdownRequest={}));var bx;(function(r){r.type=new Le.ProtocolNotificationType0("exit")})(bx=P.ExitNotification||(P.ExitNotification={}));var vx;(function(r){r.type=new Le.ProtocolNotificationType("workspace/didChangeConfiguration")})(vx=P.DidChangeConfigurationNotification||(P.DidChangeConfigurationNotification={}));var yx;(function(r){r.Error=1,r.Warning=2,r.Info=3,r.Log=4})(yx=P.MessageType||(P.MessageType={}));var wx;(function(r){r.type=new Le.ProtocolNotificationType("window/showMessage")})(wx=P.ShowMessageNotification||(P.ShowMessageNotification={}));var Rx;(function(r){r.type=new Le.ProtocolRequestType("window/showMessageRequest")})(Rx=P.ShowMessageRequest||(P.ShowMessageRequest={}));var Sx;(function(r){r.type=new Le.ProtocolNotificationType("window/logMessage")})(Sx=P.LogMessageNotification||(P.LogMessageNotification={}));var Cx;(function(r){r.type=new Le.ProtocolNotificationType("telemetry/event")})(Cx=P.TelemetryEventNotification||(P.TelemetryEventNotification={}));var xx;(function(r){r.None=0,r.Full=1,r.Incremental=2})(xx=P.TextDocumentSyncKind||(P.TextDocumentSyncKind={}));var Ex;(function(r){r.method="textDocument/didOpen",r.type=new Le.ProtocolNotificationType(r.method)})(Ex=P.DidOpenTextDocumentNotification||(P.DidOpenTextDocumentNotification={}));var kx;(function(r){function e(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}r.isIncremental=e;function t(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}r.isFull=t})(kx=P.TextDocumentContentChangeEvent||(P.TextDocumentContentChangeEvent={}));var Tx;(function(r){r.method="textDocument/didChange",r.type=new Le.ProtocolNotificationType(r.method)})(Tx=P.DidChangeTextDocumentNotification||(P.DidChangeTextDocumentNotification={}));var Px;(function(r){r.method="textDocument/didClose",r.type=new Le.ProtocolNotificationType(r.method)})(Px=P.DidCloseTextDocumentNotification||(P.DidCloseTextDocumentNotification={}));var Ix;(function(r){r.method="textDocument/didSave",r.type=new Le.ProtocolNotificationType(r.method)})(Ix=P.DidSaveTextDocumentNotification||(P.DidSaveTextDocumentNotification={}));var Dx;(function(r){r.Manual=1,r.AfterDelay=2,r.FocusOut=3})(Dx=P.TextDocumentSaveReason||(P.TextDocumentSaveReason={}));var Ox;(function(r){r.method="textDocument/willSave",r.type=new Le.ProtocolNotificationType(r.method)})(Ox=P.WillSaveTextDocumentNotification||(P.WillSaveTextDocumentNotification={}));var Ax;(function(r){r.method="textDocument/willSaveWaitUntil",r.type=new Le.ProtocolRequestType(r.method)})(Ax=P.WillSaveTextDocumentWaitUntilRequest||(P.WillSaveTextDocumentWaitUntilRequest={}));var Nx;(function(r){r.type=new Le.ProtocolNotificationType("workspace/didChangeWatchedFiles")})(Nx=P.DidChangeWatchedFilesNotification||(P.DidChangeWatchedFilesNotification={}));var Lx;(function(r){r.Created=1,r.Changed=2,r.Deleted=3})(Lx=P.FileChangeType||(P.FileChangeType={}));var qx;(function(r){r.Create=1,r.Change=2,r.Delete=4})(qx=P.WatchKind||(P.WatchKind={}));var Fx;(function(r){r.type=new Le.ProtocolNotificationType("textDocument/publishDiagnostics")})(Fx=P.PublishDiagnosticsNotification||(P.PublishDiagnosticsNotification={}));var Mx;(function(r){r.Invoked=1,r.TriggerCharacter=2,r.TriggerForIncompleteCompletions=3})(Mx=P.CompletionTriggerKind||(P.CompletionTriggerKind={}));var $x;(function(r){r.method="textDocument/completion",r.type=new Le.ProtocolRequestType(r.method)})($x=P.CompletionRequest||(P.CompletionRequest={}));var jx;(function(r){r.method="completionItem/resolve",r.type=new Le.ProtocolRequestType(r.method)})(jx=P.CompletionResolveRequest||(P.CompletionResolveRequest={}));var Bx;(function(r){r.method="textDocument/hover",r.type=new Le.ProtocolRequestType(r.method)})(Bx=P.HoverRequest||(P.HoverRequest={}));var Ux;(function(r){r.Invoked=1,r.TriggerCharacter=2,r.ContentChange=3})(Ux=P.SignatureHelpTriggerKind||(P.SignatureHelpTriggerKind={}));var zx;(function(r){r.method="textDocument/signatureHelp",r.type=new Le.ProtocolRequestType(r.method)})(zx=P.SignatureHelpRequest||(P.SignatureHelpRequest={}));var Gx;(function(r){r.method="textDocument/definition",r.type=new Le.ProtocolRequestType(r.method)})(Gx=P.DefinitionRequest||(P.DefinitionRequest={}));var Vx;(function(r){r.method="textDocument/references",r.type=new Le.ProtocolRequestType(r.method)})(Vx=P.ReferencesRequest||(P.ReferencesRequest={}));var Wx;(function(r){r.method="textDocument/documentHighlight",r.type=new Le.ProtocolRequestType(r.method)})(Wx=P.DocumentHighlightRequest||(P.DocumentHighlightRequest={}));var Hx;(function(r){r.method="textDocument/documentSymbol",r.type=new Le.ProtocolRequestType(r.method)})(Hx=P.DocumentSymbolRequest||(P.DocumentSymbolRequest={}));var Kx;(function(r){r.method="textDocument/codeAction",r.type=new Le.ProtocolRequestType(r.method)})(Kx=P.CodeActionRequest||(P.CodeActionRequest={}));var Yx;(function(r){r.method="codeAction/resolve",r.type=new Le.ProtocolRequestType(r.method)})(Yx=P.CodeActionResolveRequest||(P.CodeActionResolveRequest={}));var Xx;(function(r){r.method="workspace/symbol",r.type=new Le.ProtocolRequestType(r.method)})(Xx=P.WorkspaceSymbolRequest||(P.WorkspaceSymbolRequest={}));var Qx;(function(r){r.method="textDocument/codeLens",r.type=new Le.ProtocolRequestType(r.method)})(Qx=P.CodeLensRequest||(P.CodeLensRequest={}));var Zx;(function(r){r.method="codeLens/resolve",r.type=new Le.ProtocolRequestType(r.method)})(Zx=P.CodeLensResolveRequest||(P.CodeLensResolveRequest={}));var Jx;(function(r){r.method="workspace/codeLens/refresh",r.type=new Le.ProtocolRequestType0(r.method)})(Jx=P.CodeLensRefreshRequest||(P.CodeLensRefreshRequest={}));var eE;(function(r){r.method="textDocument/documentLink",r.type=new Le.ProtocolRequestType(r.method)})(eE=P.DocumentLinkRequest||(P.DocumentLinkRequest={}));var tE;(function(r){r.method="documentLink/resolve",r.type=new Le.ProtocolRequestType(r.method)})(tE=P.DocumentLinkResolveRequest||(P.DocumentLinkResolveRequest={}));var nE;(function(r){r.method="textDocument/formatting",r.type=new Le.ProtocolRequestType(r.method)})(nE=P.DocumentFormattingRequest||(P.DocumentFormattingRequest={}));var rE;(function(r){r.method="textDocument/rangeFormatting",r.type=new Le.ProtocolRequestType(r.method)})(rE=P.DocumentRangeFormattingRequest||(P.DocumentRangeFormattingRequest={}));var iE;(function(r){r.method="textDocument/onTypeFormatting",r.type=new Le.ProtocolRequestType(r.method)})(iE=P.DocumentOnTypeFormattingRequest||(P.DocumentOnTypeFormattingRequest={}));var sE;(function(r){r.Identifier=1})(sE=P.PrepareSupportDefaultBehavior||(P.PrepareSupportDefaultBehavior={}));var oE;(function(r){r.method="textDocument/rename",r.type=new Le.ProtocolRequestType(r.method)})(oE=P.RenameRequest||(P.RenameRequest={}));var aE;(function(r){r.method="textDocument/prepareRename",r.type=new Le.ProtocolRequestType(r.method)})(aE=P.PrepareRenameRequest||(P.PrepareRenameRequest={}));var cE;(function(r){r.type=new Le.ProtocolRequestType("workspace/executeCommand")})(cE=P.ExecuteCommandRequest||(P.ExecuteCommandRequest={}));var uE;(function(r){r.type=new Le.ProtocolRequestType("workspace/applyEdit")})(uE=P.ApplyWorkspaceEditRequest||(P.ApplyWorkspaceEditRequest={}))});var w_=B(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.createProtocolConnection=void 0;var y_=ri();function lE(r,e,t,n){return y_.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),y_.createMessageConnection(r,e,t,n)}Sa.createProtocolConnection=lE});var R_=B(an=>{"use strict";var dE=an&&an.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ca=an&&an.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&dE(e,r,t)};Object.defineProperty(an,"__esModule",{value:!0});an.LSPErrorCodes=an.createProtocolConnection=void 0;Ca(ri(),an);Ca(Hm(),an);Ca(Ot(),an);Ca(v_(),an);var fE=w_();Object.defineProperty(an,"createProtocolConnection",{enumerable:!0,get:function(){return fE.createProtocolConnection}});var hE;(function(r){r.lspReservedErrorRangeStart=-32899,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800})(hE=an.LSPErrorCodes||(an.LSPErrorCodes={}))});var pt=B(Jn=>{"use strict";var pE=Jn&&Jn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),S_=Jn&&Jn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pE(e,r,t)};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.createProtocolConnection=void 0;var gE=Pl();S_(Pl(),Jn);S_(R_(),Jn);function mE(r,e,t,n){return gE.createMessageConnection(r,e,t,n)}Jn.createProtocolConnection=mE});var Bl=B(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.toJSONObject=Gi.ConfigurationFeature=void 0;var $l=require("vscode"),_E=pt(),jl=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(_E.ConfigurationRequest.type,(t,n)=>{let i=o=>{let a=[];for(let c of o.items){let u=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(u,c.section!==null?c.section:void 0))}return a},s=e.clientOptions.middleware.workspace;return s&&s.configuration?s.configuration(t,n,i):i(t,n)})}getConfiguration(e,t){let n=null;if(t){let i=t.lastIndexOf(".");if(i===-1)n=zi($l.workspace.getConfiguration(void 0,e).get(t));else{let s=$l.workspace.getConfiguration(t.substr(0,i),e);s&&(n=zi(s.get(t.substr(i+1))))}}else{let i=$l.workspace.getConfiguration(void 0,e);n={};for(let s of Object.keys(i))i.has(s)&&(n[s]=zi(i.get(s)))}return n===void 0&&(n=null),n}dispose(){}};Gi.ConfigurationFeature=jl;function zi(r){if(r){if(Array.isArray(r))return r.map(zi);if(typeof r=="object"){let e=Object.create(null);for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=zi(r[t]));return e}}return r}Gi.toJSONObject=zi});var Gl=B(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var bE=require("vscode"),Ul=class extends bE.CompletionItem{constructor(e){super(e)}};zl.default=Ul});var Hl=B(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});var vE=require("vscode"),Vl=class extends vE.CodeLens{constructor(e){super(e)}};Wl.default=Vl});var Xl=B(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});var yE=require("vscode"),Kl=class extends yE.DocumentLink{constructor(e,t){super(e,t)}};Yl.default=Kl});var Jl=B(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var wE=require("vscode"),Ql=class extends wE.CodeAction{constructor(e,t){super(e),this.data=t}};Zl.default=Ql});var nd=B(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.ProtocolDiagnostic=si.DiagnosticCode=void 0;var RE=require("vscode"),ed=Cr(),SE;(function(r){function e(t){let n=t;return n!=null&&(ed.number(n.value)||ed.string(n.value))&&ed.string(n.target)}r.is=e})(SE=si.DiagnosticCode||(si.DiagnosticCode={}));var td=class extends RE.Diagnostic{constructor(e,t,n,i){super(e,t,n),this.data=i,this.hasDiagnosticCode=!1}};si.ProtocolDiagnostic=td});var sd=B(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});var CE=require("vscode"),rd=class extends CE.CallHierarchyItem{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s,o),a!==void 0&&(this.data=a)}};id.default=rd});var x_=B(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.createConverter=void 0;var At=require("vscode"),Ye=pt(),no=Cr(),xE=Gl(),EE=Hl(),kE=Xl(),TE=Jl(),C_=nd(),PE=sd(),IE=pt(),od;(function(r){function e(t){let n=t;return n&&!!n.inserting&&!!n.replacing}r.is=e})(od||(od={}));function DE(r){let t=r||(d=>d.toString());function n(d){return t(d)}function i(d){return{uri:t(d.uri)}}function s(d){return{uri:t(d.uri),version:d.version}}function o(d){return{textDocument:{uri:t(d.uri),languageId:d.languageId,version:d.version,text:d.getText()}}}function a(d){let p=d;return!!p.document&&!!p.contentChanges}function c(d){let p=d;return!!p.uri&&!!p.version}function u(d){if(c(d))return{textDocument:{uri:t(d.uri),version:d.version},contentChanges:[{text:d.getText()}]};if(a(d)){let p=d.document;return{textDocument:{uri:t(p.uri),version:p.version},contentChanges:d.contentChanges.map($=>{let Y=$.range;return{range:{start:{line:Y.start.line,character:Y.start.character},end:{line:Y.end.line,character:Y.end.character}},rangeLength:$.rangeLength,text:$.text}})}}else throw Error("Unsupported text document change parameter")}function h(d){return{textDocument:i(d)}}function v(d,p=!1){let A={textDocument:i(d)};return p&&(A.text=d.getText()),A}function m(d){switch(d){case At.TextDocumentSaveReason.Manual:return Ye.TextDocumentSaveReason.Manual;case At.TextDocumentSaveReason.AfterDelay:return Ye.TextDocumentSaveReason.AfterDelay;case At.TextDocumentSaveReason.FocusOut:return Ye.TextDocumentSaveReason.FocusOut}return Ye.TextDocumentSaveReason.Manual}function b(d){return{textDocument:i(d.document),reason:m(d.reason)}}function k(d){return{files:d.files.map(p=>({uri:t(p)}))}}function f(d){return{files:d.files.map(p=>({oldUri:t(p.oldUri),newUri:t(p.newUri)}))}}function _(d){return{files:d.files.map(p=>({uri:t(p)}))}}function w(d){return{files:d.files.map(p=>({uri:t(p)}))}}function S(d){return{files:d.files.map(p=>({oldUri:t(p.oldUri),newUri:t(p.newUri)}))}}function y(d){return{files:d.files.map(p=>({uri:t(p)}))}}function l(d,p){return{textDocument:i(d),position:J(p)}}function x(d){switch(d){case At.CompletionTriggerKind.TriggerCharacter:return Ye.CompletionTriggerKind.TriggerCharacter;case At.CompletionTriggerKind.TriggerForIncompleteCompletions:return Ye.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return Ye.CompletionTriggerKind.Invoked}}function E(d,p,A){return{textDocument:i(d),position:J(p),context:{triggerKind:x(A.triggerKind),triggerCharacter:A.triggerCharacter}}}function C(d){switch(d){case At.SignatureHelpTriggerKind.Invoke:return Ye.SignatureHelpTriggerKind.Invoked;case At.SignatureHelpTriggerKind.TriggerCharacter:return Ye.SignatureHelpTriggerKind.TriggerCharacter;case At.SignatureHelpTriggerKind.ContentChange:return Ye.SignatureHelpTriggerKind.ContentChange}}function T(d){return{label:d.label}}function D(d){return d.map(T)}function F(d){return{label:d.label,parameters:D(d.parameters)}}function z(d){return d.map(F)}function H(d){return d===void 0?d:{signatures:z(d.signatures),activeSignature:d.activeSignature,activeParameter:d.activeParameter}}function Q(d,p,A){return{textDocument:i(d),position:J(p),context:{isRetrigger:A.isRetrigger,triggerCharacter:A.triggerCharacter,triggerKind:C(A.triggerKind),activeSignatureHelp:H(A.activeSignatureHelp)}}}function J(d){return{line:d.line,character:d.character}}function ie(d){return d==null?d:{line:d.line,character:d.character}}function be(d){let p=[];for(let A of d)p.push(ie(A));return p}function ee(d){return d==null?d:{start:ie(d.start),end:ie(d.end)}}function Ae(d){return d==null?d:Ye.Location.create(n(d.uri),ee(d.range))}function ae(d){switch(d){case At.DiagnosticSeverity.Error:return Ye.DiagnosticSeverity.Error;case At.DiagnosticSeverity.Warning:return Ye.DiagnosticSeverity.Warning;case At.DiagnosticSeverity.Information:return Ye.DiagnosticSeverity.Information;case At.DiagnosticSeverity.Hint:return Ye.DiagnosticSeverity.Hint}}function Ee(d){if(!d)return;let p=[];for(let A of d){let $=ge(A);$!==void 0&&p.push($)}return p.length>0?p:void 0}function ge(d){switch(d){case At.DiagnosticTag.Unnecessary:return Ye.DiagnosticTag.Unnecessary;case At.DiagnosticTag.Deprecated:return Ye.DiagnosticTag.Deprecated;default:return}}function me(d){return{message:d.message,location:Ae(d.location)}}function De(d){return d.map(me)}function Je(d){if(d!=null)return no.number(d)||no.string(d)?d:{value:d.value,target:n(d.target)}}function W(d){let p=Ye.Diagnostic.create(ee(d.range),d.message),A=d instanceof C_.ProtocolDiagnostic?d:void 0;A!==void 0&&A.data!==void 0&&(p.data=A.data);let $=Je(d.code);return C_.DiagnosticCode.is($)?A!==void 0&&A.hasDiagnosticCode?p.code=$:(p.code=$.value,p.codeDescription={href:$.target}):p.code=$,no.number(d.severity)&&(p.severity=ae(d.severity)),Array.isArray(d.tags)&&(p.tags=Ee(d.tags)),d.relatedInformation&&(p.relatedInformation=De(d.relatedInformation)),d.source&&(p.source=d.source),p}function je(d){return d==null?d:d.map(W)}function ke(d,p){switch(d){case"$string":return p;case Ye.MarkupKind.PlainText:return{kind:d,value:p};case Ye.MarkupKind.Markdown:return{kind:d,value:p.value};default:return`Unsupported Markup content received. Kind is: ${d}`}}function Qe(d){switch(d){case At.CompletionItemTag.Deprecated:return Ye.CompletionItemTag.Deprecated}}function Et(d){if(d===void 0)return d;let p=[];for(let A of d){let $=Qe(A);$!==void 0&&p.push($)}return p}function rt(d,p){return p!==void 0?p:d+1}function Gt(d){let p={label:d.label},A=d instanceof xE.default?d:void 0;d.detail&&(p.detail=d.detail),d.documentation&&(!A||A.documentationFormat==="$string"?p.documentation=d.documentation:p.documentation=ke(A.documentationFormat,d.documentation)),d.filterText&&(p.filterText=d.filterText),Ge(p,d),no.number(d.kind)&&(p.kind=rt(d.kind,A&&A.originalItemKind)),d.sortText&&(p.sortText=d.sortText),d.additionalTextEdits&&(p.additionalTextEdits=Zt(d.additionalTextEdits)),d.commitCharacters&&(p.commitCharacters=d.commitCharacters.slice()),d.command&&(p.command=Ft(d.command)),(d.preselect===!0||d.preselect===!1)&&(p.preselect=d.preselect);let $=Et(d.tags);if(A){if(A.data!==void 0&&(p.data=A.data),A.deprecated===!0||A.deprecated===!1){if(A.deprecated===!0&&$!==void 0&&$.length>0){let Y=$.indexOf(At.CompletionItemTag.Deprecated);Y!==-1&&$.splice(Y,1)}p.deprecated=A.deprecated}A.insertTextMode!==void 0&&(p.insertTextMode=A.insertTextMode)}return $!==void 0&&$.length>0&&(p.tags=$),p.insertTextMode===void 0&&d.keepWhitespace===!0&&(p.insertTextMode=IE.InsertTextMode.adjustIndentation),p}function Ge(d,p){let A=Ye.InsertTextFormat.PlainText,$,Y;p.textEdit?($=p.textEdit.newText,Y=p.textEdit.range):p.insertText instanceof At.SnippetString?(A=Ye.InsertTextFormat.Snippet,$=p.insertText.value):$=p.insertText,p.range&&(Y=p.range),d.insertTextFormat=A,p.fromEdit&&$!==void 0&&Y!==void 0?d.textEdit=Qt($,Y):d.insertText=$}function Qt(d,p){return od.is(p)?Ye.InsertReplaceEdit.create(d,ee(p.inserting),ee(p.replacing)):{newText:d,range:ee(p)}}function wt(d){return{range:ee(d.range),newText:d.newText}}function Zt(d){return d==null?d:d.map(wt)}function He(d){return d<=At.SymbolKind.TypeParameter?d+1:Ye.SymbolKind.Property}function ft(d){return d}function mt(d){return d.map(ft)}function un(d,p,A){return{textDocument:i(d),position:J(p),context:{includeDeclaration:A.includeDeclaration}}}function kt(d){let p=Ye.CodeAction.create(d.title);if(d instanceof TE.default&&d.data!==void 0&&(p.data=d.data),d.kind!==void 0&&(p.kind=qt(d.kind)),d.diagnostics!==void 0&&(p.diagnostics=je(d.diagnostics)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(p.command=Ft(d.command)),d.isPreferred!==void 0&&(p.isPreferred=d.isPreferred),d.disabled!==void 0&&(p.disabled={reason:d.disabled.reason}),p}function mn(d){if(d==null)return d;let p;return d.only&&no.string(d.only.value)&&(p=[d.only.value]),Ye.CodeActionContext.create(je(d.diagnostics),p)}function qt(d){if(d!=null)return d.value}function Ft(d){let p=Ye.Command.create(d.title,d.command);return d.arguments&&(p.arguments=d.arguments),p}function Jt(d){let p=Ye.CodeLens.create(ee(d.range));return d.command&&(p.command=Ft(d.command)),d instanceof EE.default&&d.data&&(p.data=d.data),p}function Vt(d,p){let A={tabSize:d.tabSize,insertSpaces:d.insertSpaces};return p.trimTrailingWhitespace&&(A.trimTrailingWhitespace=!0),p.trimFinalNewlines&&(A.trimFinalNewlines=!0),p.insertFinalNewline&&(A.insertFinalNewline=!0),A}function L(d){return{textDocument:i(d)}}function I(d){return{textDocument:i(d)}}function R(d){let p=Ye.DocumentLink.create(ee(d.range));d.target&&(p.target=n(d.target)),d.tooltip!==void 0&&(p.tooltip=d.tooltip);let A=d instanceof kE.default?d:void 0;return A&&A.data&&(p.data=A.data),p}function O(d){return{textDocument:i(d)}}function q(d){let p={name:d.name,kind:He(d.kind),uri:n(d.uri),range:ee(d.range),selectionRange:ee(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(p.detail=d.detail),d.tags!==void 0&&(p.tags=mt(d.tags)),d instanceof PE.default&&d.data!==void 0&&(p.data=d.data),p}return{asUri:n,asTextDocumentIdentifier:i,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:o,asChangeTextDocumentParams:u,asCloseTextDocumentParams:h,asSaveTextDocumentParams:v,asWillSaveTextDocumentParams:b,asDidCreateFilesParams:k,asDidRenameFilesParams:f,asDidDeleteFilesParams:_,asWillCreateFilesParams:w,asWillRenameFilesParams:S,asWillDeleteFilesParams:y,asTextDocumentPositionParams:l,asCompletionParams:E,asSignatureHelpParams:Q,asWorkerPosition:J,asRange:ee,asPosition:ie,asPositions:be,asLocation:Ae,asDiagnosticSeverity:ae,asDiagnosticTag:ge,asDiagnostic:W,asDiagnostics:je,asCompletionItem:Gt,asTextEdit:wt,asSymbolKind:He,asSymbolTag:ft,asSymbolTags:mt,asReferenceParams:un,asCodeAction:kt,asCodeActionContext:mn,asCommand:Ft,asCodeLens:Jt,asFormattingOptions:Vt,asDocumentSymbolParams:L,asCodeLensParams:I,asDocumentLink:R,asDocumentLinkParams:O,asCallHierarchyItem:q}}xa.createConverter=DE});var T_=B(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.createConverter=void 0;var de=require("vscode"),$e=pt(),Fn=Cr(),OE=Gl(),AE=Hl(),NE=Xl(),LE=Jl(),E_=nd(),qE=sd(),k_=pt(),Ea;(function(r){function e(t){let n=t;return n&&Fn.string(n.language)&&Fn.string(n.value)}r.is=e})(Ea||(Ea={}));function FE(r,e){let n=r||(g=>de.Uri.parse(g));function i(g){return n(g)}function s(g){return g.map(o)}function o(g){let U=new E_.ProtocolDiagnostic(m(g.range),g.message,k(g.severity),g.data);return g.code!==void 0&&($e.CodeDescription.is(g.codeDescription)?U.code={value:g.code,target:i(g.codeDescription.href)}:E_.DiagnosticCode.is(g.code)?(U.hasDiagnosticCode=!0,U.code={value:g.code.value,target:i(g.code.target)}):U.code=g.code),g.source&&(U.source=g.source),g.relatedInformation&&(U.relatedInformation=a(g.relatedInformation)),Array.isArray(g.tags)&&(U.tags=u(g.tags)),U}function a(g){return g.map(c)}function c(g){return new de.DiagnosticRelatedInformation(ee(g.location),g.message)}function u(g){if(!g)return;let U=[];for(let Z of g){let ve=h(Z);ve!==void 0&&U.push(ve)}return U.length>0?U:void 0}function h(g){switch(g){case $e.DiagnosticTag.Unnecessary:return de.DiagnosticTag.Unnecessary;case $e.DiagnosticTag.Deprecated:return de.DiagnosticTag.Deprecated;default:return}}function v(g){if(g)return new de.Position(g.line,g.character)}function m(g){if(g)return new de.Range(v(g.start),v(g.end))}function b(g){return g.map(U=>m(U))}function k(g){if(g==null)return de.DiagnosticSeverity.Error;switch(g){case $e.DiagnosticSeverity.Error:return de.DiagnosticSeverity.Error;case $e.DiagnosticSeverity.Warning:return de.DiagnosticSeverity.Warning;case $e.DiagnosticSeverity.Information:return de.DiagnosticSeverity.Information;case $e.DiagnosticSeverity.Hint:return de.DiagnosticSeverity.Hint}return de.DiagnosticSeverity.Error}function f(g){if(Fn.string(g))return w(g);if(Ea.is(g))return w().appendCodeblock(g.value,g.language);if(Array.isArray(g)){let U=[];for(let Z of g){let ve=w();Ea.is(Z)?ve.appendCodeblock(Z.value,Z.language):ve.appendMarkdown(Z),U.push(ve)}return U}else{let U;switch(g.kind){case $e.MarkupKind.Markdown:return w(g.value);case $e.MarkupKind.PlainText:return U=w(),U.appendText(g.value),U;default:return U=w(),U.appendText(`Unsupported Markup content received. Kind is: ${g.kind}`),U}}}function _(g){if(Fn.string(g))return g;switch(g.kind){case $e.MarkupKind.Markdown:return w(g.value);case $e.MarkupKind.PlainText:return g.value;default:return`Unsupported Markup content received. Kind is: ${g.kind}`}}function w(g){let U=new de.MarkdownString(g);return e===!0&&(U.isTrusted=e),U}function S(g){if(g)return new de.Hover(f(g.contents),m(g.range))}function y(g){if(!g)return;if(Array.isArray(g))return g.map(C);let U=g;return new de.CompletionList(U.items.map(C),U.isIncomplete)}function l(g){return $e.CompletionItemKind.Text<=g&&g<=$e.CompletionItemKind.TypeParameter?[g-1,void 0]:[de.CompletionItemKind.Text,g]}function x(g){switch(g){case $e.CompletionItemTag.Deprecated:return de.CompletionItemTag.Deprecated}}function E(g){if(g==null)return[];let U=[];for(let Z of g){let ve=x(Z);ve!==void 0&&U.push(ve)}return U}function C(g){let U=E(g.tags),Z=new OE.default(g.label);g.detail&&(Z.detail=g.detail),g.documentation&&(Z.documentation=_(g.documentation),Z.documentationFormat=Fn.string(g.documentation)?"$string":g.documentation.kind),g.filterText&&(Z.filterText=g.filterText);let ve=T(g);if(ve&&(Z.insertText=ve.text,Z.range=ve.range,Z.fromEdit=ve.fromEdit),Fn.number(g.kind)){let[_e,Tt]=l(g.kind);Z.kind=_e,Tt&&(Z.originalItemKind=Tt)}return g.sortText&&(Z.sortText=g.sortText),g.additionalTextEdits&&(Z.additionalTextEdits=z(g.additionalTextEdits)),Fn.stringArray(g.commitCharacters)&&(Z.commitCharacters=g.commitCharacters.slice()),g.command&&(Z.command=wt(g.command)),(g.deprecated===!0||g.deprecated===!1)&&(Z.deprecated=g.deprecated,g.deprecated===!0&&U.push(de.CompletionItemTag.Deprecated)),(g.preselect===!0||g.preselect===!1)&&(Z.preselect=g.preselect),g.data!==void 0&&(Z.data=g.data),U.length>0&&(Z.tags=U),g.insertTextMode!==void 0&&(Z.insertTextMode=g.insertTextMode,g.insertTextMode===k_.InsertTextMode.asIs&&(Z.keepWhitespace=!0)),Z}function T(g){return g.textEdit?g.insertTextFormat===$e.InsertTextFormat.Snippet?{text:new de.SnippetString(g.textEdit.newText),range:D(g.textEdit),fromEdit:!0}:{text:g.textEdit.newText,range:D(g.textEdit),fromEdit:!0}:g.insertText?g.insertTextFormat===$e.InsertTextFormat.Snippet?{text:new de.SnippetString(g.insertText),fromEdit:!1}:{text:g.insertText,fromEdit:!1}:void 0}function D(g){return $e.InsertReplaceEdit.is(g)?{inserting:m(g.insert),replacing:m(g.replace)}:m(g.range)}function F(g){if(g)return new de.TextEdit(m(g.range),g.newText)}function z(g){if(g)return g.map(F)}function H(g){if(!g)return;let U=new de.SignatureHelp;return Fn.number(g.activeSignature)?U.activeSignature=g.activeSignature:U.activeSignature=0,Fn.number(g.activeParameter)?U.activeParameter=g.activeParameter:U.activeParameter=0,g.signatures&&(U.signatures=Q(g.signatures)),U}function Q(g){return g.map(J)}function J(g){let U=new de.SignatureInformation(g.label);return g.documentation!==void 0&&(U.documentation=_(g.documentation)),g.parameters!==void 0&&(U.parameters=ie(g.parameters)),g.activeParameter!==void 0&&(U.activeParameter=g.activeParameter),U}function ie(g){return g.map(be)}function be(g){let U=new de.ParameterInformation(g.label);return g.documentation&&(U.documentation=_(g.documentation)),U}function ee(g){if(g)return new de.Location(n(g.uri),m(g.range))}function Ae(g){if(g)return ge(g)}function ae(g){if(g)return ge(g)}function Ee(g){if(!g)return;let U={targetUri:n(g.targetUri),targetRange:m(g.targetRange),originSelectionRange:m(g.originSelectionRange),targetSelectionRange:m(g.targetSelectionRange)};if(!U.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return U}function ge(g){if(g)return Fn.array(g)?g.length===0?[]:$e.LocationLink.is(g[0])?g.map(Z=>Ee(Z)):g.map(Z=>ee(Z)):$e.LocationLink.is(g)?[Ee(g)]:ee(g)}function me(g){if(g)return g.map(U=>ee(U))}function De(g){if(g)return g.map(Je)}function Je(g){let U=new de.DocumentHighlight(m(g.range));return Fn.number(g.kind)&&(U.kind=W(g.kind)),U}function W(g){switch(g){case $e.DocumentHighlightKind.Text:return de.DocumentHighlightKind.Text;case $e.DocumentHighlightKind.Read:return de.DocumentHighlightKind.Read;case $e.DocumentHighlightKind.Write:return de.DocumentHighlightKind.Write}return de.DocumentHighlightKind.Text}function je(g,U){if(g)return g.map(Z=>rt(Z,U))}function ke(g){return g<=$e.SymbolKind.TypeParameter?g-1:de.SymbolKind.Property}function Qe(g){switch(g){case $e.SymbolTag.Deprecated:return de.SymbolTag.Deprecated;default:return}}function Et(g){if(g==null)return;let U=[];for(let Z of g){let ve=Qe(Z);ve!==void 0&&U.push(ve)}return U.length===0?void 0:U}function rt(g,U){let Z=new de.SymbolInformation(g.name,ke(g.kind),m(g.location.range),g.location.uri?n(g.location.uri):U);return Qt(Z,g),g.containerName&&(Z.containerName=g.containerName),Z}function Gt(g){if(g!=null)return g.map(Ge)}function Ge(g){let U=new de.DocumentSymbol(g.name,g.detail||"",ke(g.kind),m(g.range),m(g.selectionRange));if(Qt(U,g),g.children!==void 0&&g.children.length>0){let Z=[];for(let ve of g.children)Z.push(Ge(ve));U.children=Z}return U}function Qt(g,U){g.tags=Et(U.tags),U.deprecated&&(g.tags?g.tags.includes(de.SymbolTag.Deprecated)||(g.tags=g.tags.concat(de.SymbolTag.Deprecated)):g.tags=[de.SymbolTag.Deprecated])}function wt(g){let U={title:g.title,command:g.command};return g.arguments&&(U.arguments=g.arguments),U}function Zt(g){if(g)return g.map(wt)}let He=new Map;He.set($e.CodeActionKind.Empty,de.CodeActionKind.Empty),He.set($e.CodeActionKind.QuickFix,de.CodeActionKind.QuickFix),He.set($e.CodeActionKind.Refactor,de.CodeActionKind.Refactor),He.set($e.CodeActionKind.RefactorExtract,de.CodeActionKind.RefactorExtract),He.set($e.CodeActionKind.RefactorInline,de.CodeActionKind.RefactorInline),He.set($e.CodeActionKind.RefactorRewrite,de.CodeActionKind.RefactorRewrite),He.set($e.CodeActionKind.Source,de.CodeActionKind.Source),He.set($e.CodeActionKind.SourceOrganizeImports,de.CodeActionKind.SourceOrganizeImports);function ft(g){if(g==null)return;let U=He.get(g);if(U)return U;let Z=g.split(".");U=de.CodeActionKind.Empty;for(let ve of Z)U=U.append(ve);return U}function mt(g){if(g!=null)return g.map(U=>ft(U))}function un(g){if(g==null)return;let U=new LE.default(g.title,g.data);return g.kind!==void 0&&(U.kind=ft(g.kind)),g.diagnostics!==void 0&&(U.diagnostics=s(g.diagnostics)),g.edit!==void 0&&(U.edit=qt(g.edit)),g.command!==void 0&&(U.command=wt(g.command)),g.isPreferred!==void 0&&(U.isPreferred=g.isPreferred),g.disabled!==void 0&&(U.disabled={reason:g.disabled.reason}),U}function kt(g){if(!g)return;let U=new AE.default(m(g.range));return g.command&&(U.command=wt(g.command)),g.data!==void 0&&g.data!==null&&(U.data=g.data),U}function mn(g){if(g)return g.map(U=>kt(U))}function qt(g){if(!g)return;let U=new Map;if(g.changeAnnotations!==void 0)for(let _e of Object.keys(g.changeAnnotations)){let Tt=Ft(g.changeAnnotations[_e]);U.set(_e,Tt)}let Z=_e=>{if(_e!==void 0)return U.get(_e)},ve=new de.WorkspaceEdit;if(g.documentChanges)for(let _e of g.documentChanges)if($e.CreateFile.is(_e))ve.createFile(n(_e.uri),_e.options,Z(_e.annotationId));else if($e.RenameFile.is(_e))ve.renameFile(n(_e.oldUri),n(_e.newUri),_e.options,Z(_e.annotationId));else if($e.DeleteFile.is(_e))ve.deleteFile(n(_e.uri),_e.options,Z(_e.annotationId));else if($e.TextDocumentEdit.is(_e)){let Tt=n(_e.textDocument.uri);for(let Wn of _e.edits)k_.AnnotatedTextEdit.is(Wn)?ve.replace(Tt,m(Wn.range),Wn.newText,Z(Wn.annotationId)):ve.replace(Tt,m(Wn.range),Wn.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(_e,void 0,4)}`);else g.changes&&Object.keys(g.changes).forEach(_e=>{ve.set(n(_e),z(g.changes[_e]))});return ve}function Ft(g){if(g!==void 0)return{label:g.label,needsConfirmation:!!g.needsConfirmation,description:g.description}}function Jt(g){let U=m(g.range),Z=g.target?i(g.target):void 0,ve=new NE.default(U,Z);return g.tooltip!==void 0&&(ve.tooltip=g.tooltip),g.data!==void 0&&g.data!==null&&(ve.data=g.data),ve}function Vt(g){if(g)return g.map(Jt)}function L(g){return new de.Color(g.red,g.green,g.blue,g.alpha)}function I(g){return new de.ColorInformation(m(g.range),L(g.color))}function R(g){if(Array.isArray(g))return g.map(I)}function O(g){let U=new de.ColorPresentation(g.label);return U.additionalTextEdits=z(g.additionalTextEdits),g.textEdit&&(U.textEdit=F(g.textEdit)),U}function q(g){if(Array.isArray(g))return g.map(O)}function d(g){if(g)switch(g){case $e.FoldingRangeKind.Comment:return de.FoldingRangeKind.Comment;case $e.FoldingRangeKind.Imports:return de.FoldingRangeKind.Imports;case $e.FoldingRangeKind.Region:return de.FoldingRangeKind.Region}}function p(g){return new de.FoldingRange(g.startLine,g.endLine,d(g.kind))}function A(g){if(Array.isArray(g))return g.map(p)}function $(g){return new de.SelectionRange(m(g.range),g.parent?$(g.parent):void 0)}function Y(g){if(!Array.isArray(g))return[];let U=[];for(let Z of g)U.push($(Z));return U}function se(g){if(g===null)return;let U=new qE.default(ke(g.kind),g.name,g.detail||"",i(g.uri),m(g.range),m(g.selectionRange),g.data);return g.tags!==void 0&&(U.tags=Et(g.tags)),U}function Re(g){if(g!==null)return g.map(U=>se(U))}function Ue(g){return new de.CallHierarchyIncomingCall(se(g.from),b(g.fromRanges))}function M(g){if(g!==null)return g.map(U=>Ue(U))}function j(g){return new de.CallHierarchyOutgoingCall(se(g.to),b(g.fromRanges))}function G(g){if(g!==null)return g.map(U=>j(U))}function V(g){if(g!=null)return new de.SemanticTokens(new Uint32Array(g.data),g.resultId)}function X(g){return new de.SemanticTokensEdit(g.start,g.deleteCount,g.data!==void 0?new Uint32Array(g.data):void 0)}function te(g){if(g!=null)return new de.SemanticTokensEdits(g.edits.map(X),g.resultId)}function fe(g){return g}function Ie(g){if(g!=null)return new de.LinkedEditingRanges(b(g.ranges),Ce(g.wordPattern))}function Ce(g){if(g!=null)return new RegExp(g)}return{asUri:i,asDiagnostics:s,asDiagnostic:o,asRange:m,asRanges:b,asPosition:v,asDiagnosticSeverity:k,asDiagnosticTag:h,asHover:S,asCompletionResult:y,asCompletionItem:C,asTextEdit:F,asTextEdits:z,asSignatureHelp:H,asSignatureInformations:Q,asSignatureInformation:J,asParameterInformations:ie,asParameterInformation:be,asDeclarationResult:Ae,asDefinitionResult:ae,asLocation:ee,asReferences:me,asDocumentHighlights:De,asDocumentHighlight:Je,asDocumentHighlightKind:W,asSymbolKind:ke,asSymbolTag:Qe,asSymbolTags:Et,asSymbolInformations:je,asSymbolInformation:rt,asDocumentSymbols:Gt,asDocumentSymbol:Ge,asCommand:wt,asCommands:Zt,asCodeAction:un,asCodeActionKind:ft,asCodeActionKinds:mt,asCodeLens:kt,asCodeLenses:mn,asWorkspaceEdit:qt,asDocumentLink:Jt,asDocumentLinks:Vt,asFoldingRangeKind:d,asFoldingRange:p,asFoldingRanges:A,asColor:L,asColorInformation:I,asColorInformations:R,asColorPresentation:O,asColorPresentations:q,asSelectionRange:$,asSelectionRanges:Y,asSemanticTokensLegend:fe,asSemanticTokens:V,asSemanticTokensEdit:X,asSemanticTokensEdits:te,asCallHierarchyItem:se,asCallHierarchyItems:Re,asCallHierarchyIncomingCall:Ue,asCallHierarchyIncomingCalls:M,asCallHierarchyOutgoingCall:j,asCallHierarchyOutgoingCalls:G,asLinkedEditingRanges:Ie}}ka.createConverter=FE});var I_=B(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.Delayer=void 0;var P_=pt(),ad=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(n=>{this.onSuccess=n}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var n=this.task();return this.task=void 0,n})),(t>=0||this.timeout===void 0)&&(this.timeout=P_.RAL().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(P_.RAL().timer.clearTimeout(this.timeout),this.timeout=void 0)}};Ta.Delayer=ad});var Pa=B(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.generateUuid=Tn.parse=Tn.isUUID=Tn.v4=Tn.empty=void 0;var ro=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},Me=class extends ro{constructor(){super([Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),"-",Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),"-","4",Me._randomHex(),Me._randomHex(),Me._randomHex(),"-",Me._oneOf(Me._timeHighBits),Me._randomHex(),Me._randomHex(),Me._randomHex(),"-",Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex(),Me._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return Me._oneOf(Me._chars)}};Me._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Me._timeHighBits=["8","9","a","b"];Tn.empty=new ro("00000000-0000-0000-0000-000000000000");function D_(){return new Me}Tn.v4=D_;var ME=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function O_(r){return ME.test(r)}Tn.isUUID=O_;function $E(r){if(!O_(r))throw new Error("invalid uuid");return new ro(r)}Tn.parse=$E;function jE(){return D_().asHex()}Tn.generateUuid=jE});var ud=B(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.ProgressPart=void 0;var A_=require("vscode"),N_=pt(),L_=Cr(),cd=class{constructor(e,t,n){this._client=e,this._token=t,this._reported=0,this._disposable=this._client.onProgress(N_.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),n&&n(this);break}})}begin(e){A_.window.withProgress({location:A_.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,n)=>(this._progress=t,this._infinite=e.percentage===void 0,this._cancellationToken=n,this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(N_.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})))}report(e){if(this._infinite&&L_.string(e.message))this._progress.report({message:e.message});else if(L_.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),n=Math.max(0,t-this._reported);this._progress.report({message:e.message,increment:n}),this._reported+=n}}cancel(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._reject&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._resolve&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}};Ia.ProgressPart=cd});var bn=B(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.BaseLanguageClient=_t.MessageTransports=_t.TextDocumentFeature=_t.State=_t.RevealOutputChannelOn=_t.CloseAction=_t.ErrorAction=void 0;var oe=require("vscode"),N=pt(),BE=Bl(),UE=x_(),zE=T_(),et=Cr(),q_=I_(),tt=Pa(),GE=ud(),ld=class{error(e){N.RAL().console.error(e)}warn(e){N.RAL().console.warn(e)}info(e){N.RAL().console.info(e)}log(e){N.RAL().console.log(e)}};function VE(r,e,t,n,i){let s=new ld,o=N.createProtocolConnection(r,e,s,i);return o.onError(c=>{t(c[0],c[1],c[2])}),o.onClose(n),{listen:()=>o.listen(),sendRequest:(c,...u)=>o.sendRequest(et.string(c)?c:c.method,...u),onRequest:(c,u)=>o.onRequest(et.string(c)?c:c.method,u),sendNotification:(c,u)=>o.sendNotification(et.string(c)?c:c.method,u),onNotification:(c,u)=>o.onNotification(et.string(c)?c:c.method,u),onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(c,u,h)=>{let v={sendNotification:!1,traceFormat:N.TraceFormat.Text};h===void 0?o.trace(c,u,v):(et.boolean(h),o.trace(c,u,h))},initialize:c=>o.sendRequest(N.InitializeRequest.type,c),shutdown:()=>o.sendRequest(N.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(N.ExitNotification.type),onLogMessage:c=>o.onNotification(N.LogMessageNotification.type,c),onShowMessage:c=>o.onNotification(N.ShowMessageNotification.type,c),onTelemetry:c=>o.onNotification(N.TelemetryEventNotification.type,c),didChangeConfiguration:c=>o.sendNotification(N.DidChangeConfigurationNotification.type,c),didChangeWatchedFiles:c=>o.sendNotification(N.DidChangeWatchedFilesNotification.type,c),didOpenTextDocument:c=>o.sendNotification(N.DidOpenTextDocumentNotification.type,c),didChangeTextDocument:c=>o.sendNotification(N.DidChangeTextDocumentNotification.type,c),didCloseTextDocument:c=>o.sendNotification(N.DidCloseTextDocumentNotification.type,c),didSaveTextDocument:c=>o.sendNotification(N.DidSaveTextDocumentNotification.type,c),onDiagnostics:c=>o.onNotification(N.PublishDiagnosticsNotification.type,c),end:()=>o.end(),dispose:()=>o.dispose()}}var Oa;(function(r){r[r.Continue=1]="Continue",r[r.Shutdown=2]="Shutdown"})(Oa=_t.ErrorAction||(_t.ErrorAction={}));var oi;(function(r){r[r.DoNotRestart=1]="DoNotRestart",r[r.Restart=2]="Restart"})(oi=_t.CloseAction||(_t.CloseAction={}));var dd=class{constructor(e,t){this.name=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,n){return n&&n<=3?Oa.Continue:Oa.Shutdown}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?oi.Restart:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?(oe.window.showErrorMessage(`The ${this.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted.`),oi.DoNotRestart):(this.restarts.shift(),oi.Restart)}},io;(function(r){r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error",r[r.Never=4]="Never"})(io=_t.RevealOutputChannelOn||(_t.RevealOutputChannelOn={}));var Da;(function(r){r[r.Stopped=1]="Stopped",r[r.Starting=3]="Starting",r[r.Running=2]="Running"})(Da=_t.State||(_t.State={}));var dt;(function(r){r[r.Initial=0]="Initial",r[r.Starting=1]="Starting",r[r.StartFailed=2]="StartFailed",r[r.Running=3]="Running",r[r.Stopping=4]="Stopping",r[r.Stopped=5]="Stopped"})(dt||(dt={}));var F_=[N.SymbolKind.File,N.SymbolKind.Module,N.SymbolKind.Namespace,N.SymbolKind.Package,N.SymbolKind.Class,N.SymbolKind.Method,N.SymbolKind.Property,N.SymbolKind.Field,N.SymbolKind.Constructor,N.SymbolKind.Enum,N.SymbolKind.Interface,N.SymbolKind.Function,N.SymbolKind.Variable,N.SymbolKind.Constant,N.SymbolKind.String,N.SymbolKind.Number,N.SymbolKind.Boolean,N.SymbolKind.Array,N.SymbolKind.Object,N.SymbolKind.Key,N.SymbolKind.Null,N.SymbolKind.EnumMember,N.SymbolKind.Struct,N.SymbolKind.Event,N.SymbolKind.Operator,N.SymbolKind.TypeParameter],WE=[N.CompletionItemKind.Text,N.CompletionItemKind.Method,N.CompletionItemKind.Function,N.CompletionItemKind.Constructor,N.CompletionItemKind.Field,N.CompletionItemKind.Variable,N.CompletionItemKind.Class,N.CompletionItemKind.Interface,N.CompletionItemKind.Module,N.CompletionItemKind.Property,N.CompletionItemKind.Unit,N.CompletionItemKind.Value,N.CompletionItemKind.Enum,N.CompletionItemKind.Keyword,N.CompletionItemKind.Snippet,N.CompletionItemKind.Color,N.CompletionItemKind.File,N.CompletionItemKind.Reference,N.CompletionItemKind.Folder,N.CompletionItemKind.EnumMember,N.CompletionItemKind.Constant,N.CompletionItemKind.Struct,N.CompletionItemKind.Event,N.CompletionItemKind.Operator,N.CompletionItemKind.TypeParameter],M_=[N.SymbolTag.Deprecated];function pe(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var so;(function(r){function e(t){let n=oe.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:n.get("trimTrailingWhitespace"),trimFinalNewlines:n.get("trimFinalNewlines"),insertFinalNewline:n.get("insertFinalNewline")}}r.fromConfiguration=e})(so||(so={}));var fd;(function(r){function e(t){let n=t;return n&&et.func(n.register)&&et.func(n.unregister)&&et.func(n.dispose)&&n.registrationType!==void 0}r.is=e})(fd||(fd={}));var Mn=class{constructor(e,t,n,i,s,o){this._client=e,this._event=t,this._type=n,this._middleware=i,this._createParams=s,this._selectorFilter=o,this._selectors=new Map}static textDocumentFilter(e,t){for(let n of e)if(oe.languages.match(n,t))return!0;return!1}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(this.callback,this)),this._selectors.set(e.id,e.registerOptions.documentSelector))}callback(e){(!this._selectorFilter||this._selectorFilter(this._selectors.values(),e))&&(this._middleware?this._middleware(e,t=>this._client.sendNotification(this._type,this._createParams(t))):this._client.sendNotification(this._type,this._createParams(e)),this.notificationSent(e))}notificationSent(e){}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(oe.languages.match(t,e))return{send:n=>{this.callback(n)}}}},hd=class extends Mn{constructor(e,t){super(e,oe.workspace.onDidOpenTextDocument,N.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,n=>e.code2ProtocolConverter.asOpenTextDocumentParams(n),Mn.textDocumentFilter),this._syncedDocuments=t}fillClientCapabilities(e){pe(pe(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:tt.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return N.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=e.registerOptions.documentSelector;oe.workspace.textDocuments.forEach(n=>{let i=n.uri.toString();if(!this._syncedDocuments.has(i)&&oe.languages.match(t,n)){let s=this._client.clientOptions.middleware,o=a=>{this._client.sendNotification(this._type,this._createParams(a))};s.didOpen?s.didOpen(n,o):o(n),this._syncedDocuments.set(i,n)}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.set(e.uri.toString(),e)}},pd=class extends Mn{constructor(e,t){super(e,oe.workspace.onDidCloseTextDocument,N.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,n=>e.code2ProtocolConverter.asCloseTextDocumentParams(n),Mn.textDocumentFilter),this._syncedDocuments=t}get registrationType(){return N.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){pe(pe(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:tt.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let n=this._selectors.values();this._syncedDocuments.forEach(i=>{if(oe.languages.match(t,i)&&!this._selectorFilter(n,i)){let s=this._client.clientOptions.middleware,o=a=>{this._client.sendNotification(this._type,this._createParams(a))};this._syncedDocuments.delete(i.uri.toString()),s.didClose?s.didClose(i,o):o(i)}})}},gd=class{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1}get registrationType(){return N.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){pe(pe(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.change!==void 0&&n.change!==N.TextDocumentSyncKind.None&&this.register({id:tt.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=oe.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{documentSelector:e.registerOptions.documentSelector,syncKind:e.registerOptions.syncKind}))}callback(e){if(e.contentChanges.length!==0){for(let t of this._changeData.values())if(oe.languages.match(t.documentSelector,e.document)){let n=this._client.clientOptions.middleware;if(t.syncKind===N.TextDocumentSyncKind.Incremental){let i=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e);n.didChange?n.didChange(e,()=>this._client.sendNotification(N.DidChangeTextDocumentNotification.type,i)):this._client.sendNotification(N.DidChangeTextDocumentNotification.type,i)}else if(t.syncKind===N.TextDocumentSyncKind.Full){let i=s=>{this._changeDelayer?(this._changeDelayer.uri!==s.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=s.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(N.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(s.document))})):(this._changeDelayer={uri:s.document.uri.toString(),delayer:new q_.Delayer(200)},this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(N.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(s.document))},-1))};n.didChange?n.didChange(e,i):i(e)}}}}unregister(e){this._changeData.delete(e),this._changeData.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!(this._forcingDelivery||!this._changeDelayer))try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(let t of this._changeData.values())if(oe.languages.match(t.documentSelector,e))return{send:n=>{this.callback(n)}}}},md=class extends Mn{constructor(e){super(e,oe.workspace.onWillSaveTextDocument,N.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(t,n)=>Mn.textDocumentFilter(t,n.document))}get registrationType(){return N.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSave&&this.register({id:tt.generateUuid(),registerOptions:{documentSelector:t}})}},_d=class{constructor(e){this._client=e,this._selectors=new Map}get registrationType(){return N.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSaveWaitUntil&&this.register({id:tt.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=oe.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,e.registerOptions.documentSelector))}callback(e){if(Mn.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,n=i=>this._client.sendRequest(N.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(s=>{let o=this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}},bd=class extends Mn{constructor(e){super(e,oe.workspace.onDidSaveTextDocument,N.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),Mn.textDocumentFilter),this._includeText=!1}get registrationType(){return N.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){pe(pe(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;if(t&&n&&n.save){let i=typeof n.save=="boolean"?{includeText:!1}:{includeText:!!n.save.includeText};this.register({id:tt.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}},vd=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get registrationType(){return N.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){pe(pe(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let n of e.registerOptions.watchers){if(!et.string(n.globPattern))continue;let i=!0,s=!0,o=!0;n.kind!==void 0&&n.kind!==null&&(i=(n.kind&N.WatchKind.Create)!==0,s=(n.kind&N.WatchKind.Change)!==0,o=(n.kind&N.WatchKind.Delete)!==0);let a=oe.workspace.createFileSystemWatcher(n.globPattern,!i,!s,!o);this.hookListeners(a,i,s,o),t.push(a)}this._watchers.set(e.id,t)}registerRaw(e,t){let n=[];for(let i of t)this.hookListeners(i,!0,!0,!0,n);this._watchers.set(e,n)}hookListeners(e,t,n,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:N.FileChangeType.Created}),null,s),n&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:N.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:N.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let n of t)n.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}},$t=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(N.TextDocumentRegistrationOptions.is(t)){let n=N.StaticRegistrationOptions.hasId(t)?t.id:tt.generateUuid(),i=t.documentSelector||e;if(i)return[n,Object.assign({},t,{documentSelector:i})]}else if(et.boolean(t)&&t===!0||N.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let n=et.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[tt.generateUuid(),n]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return et.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let n=t.data.registerOptions.documentSelector;if(n!==null&&oe.languages.match(n,e))return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};_t.TextDocumentFeature=$t;var yd=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}},wd=class extends $t{constructor(e){super(e,N.CompletionRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[N.MarkupKind.Markdown,N.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[N.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[N.InsertTextMode.asIs,N.InsertTextMode.adjustIndentation]}},t.completionItemKind={valueSet:WE}}initialize(e,t){let n=this.getRegistrationOptions(t,e.completionProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.triggerCharacters||[],n={provideCompletionItems:(i,s,o,a)=>{let c=this._client,u=this._client.clientOptions.middleware,h=(v,m,b,k)=>c.sendRequest(N.CompletionRequest.type,c.code2ProtocolConverter.asCompletionParams(v,m,b),k).then(c.protocol2CodeConverter.asCompletionResult,f=>c.handleFailedRequest(N.CompletionRequest.type,f,null));return u.provideCompletionItem?u.provideCompletionItem(i,s,a,o,h):h(i,s,a,o)},resolveCompletionItem:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.clientOptions.middleware,c=(u,h)=>o.sendRequest(N.CompletionResolveRequest.type,o.code2ProtocolConverter.asCompletionItem(u),h).then(o.protocol2CodeConverter.asCompletionItem,v=>o.handleFailedRequest(N.CompletionResolveRequest.type,v,u));return a.resolveCompletionItem?a.resolveCompletionItem(i,s,c):c(i,s)}:void 0};return[oe.languages.registerCompletionItemProvider(e.documentSelector,n,...t),n]}},Rd=class extends $t{constructor(e){super(e,N.HoverRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[N.MarkupKind.Markdown,N.MarkupKind.PlainText]}initialize(e,t){let n=this.getRegistrationOptions(t,e.hoverProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideHover:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest(N.HoverRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asHover,m=>o.handleFailedRequest(N.HoverRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideHover?c.provideHover(n,i,s,a):a(n,i,s)}};return[oe.languages.registerHoverProvider(e.documentSelector,t),t]}},Sd=class extends $t{constructor(e){super(e,N.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[N.MarkupKind.Markdown,N.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.signatureHelpProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideSignatureHelp:(i,s,o,a)=>{let c=this._client,u=(v,m,b,k)=>c.sendRequest(N.SignatureHelpRequest.type,c.code2ProtocolConverter.asSignatureHelpParams(v,m,b),k).then(c.protocol2CodeConverter.asSignatureHelp,f=>c.handleFailedRequest(N.SignatureHelpRequest.type,f,null)),h=c.clientOptions.middleware;return h.provideSignatureHelp?h.provideSignatureHelp(i,s,a,o,u):u(i,s,a,o)}},n;if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];n=oe.languages.registerSignatureHelpProvider(e.documentSelector,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};n=oe.languages.registerSignatureHelpProvider(e.documentSelector,t,i)}return[n,t]}},Cd=class extends $t{constructor(e){super(e,N.DefinitionRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.definitionProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideDefinition:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest(N.DefinitionRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asDefinitionResult,m=>o.handleFailedRequest(N.DefinitionRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideDefinition?c.provideDefinition(n,i,s,a):a(n,i,s)}};return[oe.languages.registerDefinitionProvider(e.documentSelector,t),t]}},xd=class extends $t{constructor(e){super(e,N.ReferencesRequest.type)}fillClientCapabilities(e){pe(pe(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.referencesProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideReferences:(n,i,s,o)=>{let a=this._client,c=(h,v,m,b)=>a.sendRequest(N.ReferencesRequest.type,a.code2ProtocolConverter.asReferenceParams(h,v,m),b).then(a.protocol2CodeConverter.asReferences,k=>a.handleFailedRequest(N.ReferencesRequest.type,k,null)),u=a.clientOptions.middleware;return u.provideReferences?u.provideReferences(n,i,s,o,c):c(n,i,s,o)}};return[oe.languages.registerReferenceProvider(e.documentSelector,t),t]}},Ed=class extends $t{constructor(e){super(e,N.DocumentHighlightRequest.type)}fillClientCapabilities(e){pe(pe(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentHighlightProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideDocumentHighlights:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest(N.DocumentHighlightRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asDocumentHighlights,m=>o.handleFailedRequest(N.DocumentHighlightRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideDocumentHighlights?c.provideDocumentHighlights(n,i,s,a):a(n,i,s)}};return[oe.languages.registerDocumentHighlightProvider(e.documentSelector,t),t]}},kd=class extends $t{constructor(e){super(e,N.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:F_},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:M_},t.labelSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentSymbolProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideDocumentSymbols:(i,s)=>{let o=this._client,a=(u,h)=>o.sendRequest(N.DocumentSymbolRequest.type,o.code2ProtocolConverter.asDocumentSymbolParams(u),h).then(v=>{if(v!==null){if(v.length===0)return[];{let m=v[0];return N.DocumentSymbol.is(m)?o.protocol2CodeConverter.asDocumentSymbols(v):o.protocol2CodeConverter.asSymbolInformations(v)}}},v=>o.handleFailedRequest(N.DocumentSymbolRequest.type,v,null)),c=o.clientOptions.middleware;return c.provideDocumentSymbols?c.provideDocumentSymbols(i,s,a):a(i,s)}},n=e.label!==void 0?{label:e.label}:void 0;return[oe.languages.registerDocumentSymbolProvider(e.documentSelector,t,n),t]}},Td=class extends yd{constructor(e){super(e,N.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:F_},t.tagSupport={valueSet:M_}}initialize(e){e.workspaceSymbolProvider&&this.register({id:tt.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(n,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(N.WorkspaceSymbolRequest.type,{query:c},u).then(s.protocol2CodeConverter.asSymbolInformations,h=>s.handleFailedRequest(N.WorkspaceSymbolRequest.type,h,null)),a=s.clientOptions.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(n,i,o):o(n,i)}};return[oe.languages.registerWorkspaceSymbolProvider(t),t]}},Pd=class extends $t{constructor(e){super(e,N.CodeActionRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[N.CodeActionKind.Empty,N.CodeActionKind.QuickFix,N.CodeActionKind.Refactor,N.CodeActionKind.RefactorExtract,N.CodeActionKind.RefactorInline,N.CodeActionKind.RefactorRewrite,N.CodeActionKind.Source,N.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let n=this.getRegistrationOptions(t,e.codeActionProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideCodeActions:(n,i,s,o)=>{let a=this._client,c=(h,v,m,b)=>{let k={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h),range:a.code2ProtocolConverter.asRange(v),context:a.code2ProtocolConverter.asCodeActionContext(m)};return a.sendRequest(N.CodeActionRequest.type,k,b).then(f=>{if(f===null)return;let _=[];for(let w of f)N.Command.is(w)?_.push(a.protocol2CodeConverter.asCommand(w)):_.push(a.protocol2CodeConverter.asCodeAction(w));return _},f=>a.handleFailedRequest(N.CodeActionRequest.type,f,null))},u=a.clientOptions.middleware;return u.provideCodeActions?u.provideCodeActions(n,i,s,o,c):c(n,i,s,o)},resolveCodeAction:e.resolveProvider?(n,i)=>{let s=this._client,o=this._client.clientOptions.middleware,a=(c,u)=>s.sendRequest(N.CodeActionResolveRequest.type,s.code2ProtocolConverter.asCodeAction(c),u).then(s.protocol2CodeConverter.asCodeAction,h=>s.handleFailedRequest(N.CodeActionResolveRequest.type,h,c));return o.resolveCodeAction?o.resolveCodeAction(n,i,a):a(n,i)}:void 0};return[oe.languages.registerCodeActionsProvider(e.documentSelector,t,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),t]}},Id=class extends $t{constructor(e){super(e,N.CodeLensRequest.type)}fillClientCapabilities(e){pe(pe(e,"textDocument"),"codeLens").dynamicRegistration=!0,pe(pe(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(N.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:tt.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=new oe.EventEmitter,n={onDidChangeCodeLenses:t.event,provideCodeLenses:(i,s)=>{let o=this._client,a=(u,h)=>o.sendRequest(N.CodeLensRequest.type,o.code2ProtocolConverter.asCodeLensParams(u),h).then(o.protocol2CodeConverter.asCodeLenses,v=>o.handleFailedRequest(N.CodeLensRequest.type,v,null)),c=o.clientOptions.middleware;return c.provideCodeLenses?c.provideCodeLenses(i,s,a):a(i,s)},resolveCodeLens:e.resolveProvider?(i,s)=>{let o=this._client,a=(u,h)=>o.sendRequest(N.CodeLensResolveRequest.type,o.code2ProtocolConverter.asCodeLens(u),h).then(o.protocol2CodeConverter.asCodeLens,v=>o.handleFailedRequest(N.CodeLensResolveRequest.type,v,u)),c=o.clientOptions.middleware;return c.resolveCodeLens?c.resolveCodeLens(i,s,a):a(i,s)}:void 0};return[oe.languages.registerCodeLensProvider(e.documentSelector,n),{provider:n,onDidChangeCodeLensEmitter:t}]}},Dd=class extends $t{constructor(e){super(e,N.DocumentFormattingRequest.type)}fillClientCapabilities(e){pe(pe(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentFormattingProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideDocumentFormattingEdits:(n,i,s)=>{let o=this._client,a=(u,h,v)=>{let m={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u),options:o.code2ProtocolConverter.asFormattingOptions(h,so.fromConfiguration(u))};return o.sendRequest(N.DocumentFormattingRequest.type,m,v).then(o.protocol2CodeConverter.asTextEdits,b=>o.handleFailedRequest(N.DocumentFormattingRequest.type,b,null))},c=o.clientOptions.middleware;return c.provideDocumentFormattingEdits?c.provideDocumentFormattingEdits(n,i,s,a):a(n,i,s)}};return[oe.languages.registerDocumentFormattingEditProvider(e.documentSelector,t),t]}},Od=class extends $t{constructor(e){super(e,N.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){pe(pe(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideDocumentRangeFormattingEdits:(n,i,s,o)=>{let a=this._client,c=(h,v,m,b)=>{let k={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h),range:a.code2ProtocolConverter.asRange(v),options:a.code2ProtocolConverter.asFormattingOptions(m,so.fromConfiguration(h))};return a.sendRequest(N.DocumentRangeFormattingRequest.type,k,b).then(a.protocol2CodeConverter.asTextEdits,f=>a.handleFailedRequest(N.DocumentRangeFormattingRequest.type,f,null))},u=a.clientOptions.middleware;return u.provideDocumentRangeFormattingEdits?u.provideDocumentRangeFormattingEdits(n,i,s,o,c):c(n,i,s,o)}};return[oe.languages.registerDocumentRangeFormattingEditProvider(e.documentSelector,t),t]}},Ad=class extends $t{constructor(e){super(e,N.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){pe(pe(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideOnTypeFormattingEdits:(i,s,o,a,c)=>{let u=this._client,h=(m,b,k,f,_)=>{let w={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),position:u.code2ProtocolConverter.asPosition(b),ch:k,options:u.code2ProtocolConverter.asFormattingOptions(f,so.fromConfiguration(m))};return u.sendRequest(N.DocumentOnTypeFormattingRequest.type,w,_).then(u.protocol2CodeConverter.asTextEdits,S=>u.handleFailedRequest(N.DocumentOnTypeFormattingRequest.type,S,null))},v=u.clientOptions.middleware;return v.provideOnTypeFormattingEdits?v.provideOnTypeFormattingEdits(i,s,o,a,c,h):h(i,s,o,a,c)}},n=e.moreTriggerCharacter||[];return[oe.languages.registerOnTypeFormattingEditProvider(e.documentSelector,t,e.firstTriggerCharacter,...n),t]}},Nd=class extends $t{constructor(e){super(e,N.RenameRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=N.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.renameProvider);n&&(et.boolean(e.renameProvider)&&(n.prepareProvider=!1),this.register({id:tt.generateUuid(),registerOptions:n}))}registerLanguageProvider(e){let t={provideRenameEdits:(n,i,s,o)=>{let a=this._client,c=(h,v,m,b)=>{let k={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h),position:a.code2ProtocolConverter.asPosition(v),newName:m};return a.sendRequest(N.RenameRequest.type,k,b).then(a.protocol2CodeConverter.asWorkspaceEdit,f=>a.handleFailedRequest(N.RenameRequest.type,f,null))},u=a.clientOptions.middleware;return u.provideRenameEdits?u.provideRenameEdits(n,i,s,o,c):c(n,i,s,o)},prepareRename:e.prepareProvider?(n,i,s)=>{let o=this._client,a=(u,h,v)=>{let m={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u),position:o.code2ProtocolConverter.asPosition(h)};return o.sendRequest(N.PrepareRenameRequest.type,m,v).then(b=>N.Range.is(b)?o.protocol2CodeConverter.asRange(b):this.isDefaultBehavior(b)?b.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):b&&N.Range.is(b.range)?{range:o.protocol2CodeConverter.asRange(b.range),placeholder:b.placeholder}:Promise.reject(new Error("The element can't be renamed.")),b=>o.handleFailedRequest(N.PrepareRenameRequest.type,b,void 0))},c=o.clientOptions.middleware;return c.prepareRename?c.prepareRename(n,i,s,a):a(n,i,s)}:void 0};return[oe.languages.registerRenameProvider(e.documentSelector,t),t]}isDefaultBehavior(e){let t=e;return t&&et.boolean(t.defaultBehavior)}},Ld=class extends $t{constructor(e){super(e,N.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=pe(pe(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentLinkProvider);n&&this.register({id:tt.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideDocumentLinks:(n,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(N.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(c),u).then(s.protocol2CodeConverter.asDocumentLinks,h=>s.handleFailedRequest(N.DocumentLinkRequest.type,h,null)),a=s.clientOptions.middleware;return a.provideDocumentLinks?a.provideDocumentLinks(n,i,o):o(n,i)},resolveDocumentLink:e.resolveProvider?(n,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(N.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(c),u).then(s.protocol2CodeConverter.asDocumentLink,h=>s.handleFailedRequest(N.DocumentLinkResolveRequest.type,h,c)),a=s.clientOptions.middleware;return a.resolveDocumentLink?a.resolveDocumentLink(n,i,o):o(n,i)}:void 0};return[oe.languages.registerDocumentLinkProvider(e.documentSelector,t),t]}},qd=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return N.DidChangeConfigurationNotification.type}fillClientCapabilities(e){pe(pe(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;e!==void 0&&this.register({id:tt.generateUuid(),registerOptions:{section:e}})}register(e){let t=oe.workspace.onDidChangeConfiguration(n=>{this.onDidChangeConfiguration(e.registerOptions.section,n)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let n;if(et.string(e)?n=[e]:n=e,n!==void 0&&t!==void 0&&!n.some(a=>t.affectsConfiguration(a)))return;let i=o=>{if(o===void 0){this._client.sendNotification(N.DidChangeConfigurationNotification.type,{settings:null});return}this._client.sendNotification(N.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(o)})},s=this.getMiddleware();s?s(n,i):i(n)}extractSettingsInformation(e){function t(s,o){let a=s;for(let c=0;c<o.length-1;c++){let u=a[o[c]];u||(u=Object.create(null),a[o[c]]=u),a=u}return a}let n=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(a>=0?c=oe.workspace.getConfiguration(o.substr(0,a),n).get(o.substr(a+1)):c=oe.workspace.getConfiguration(void 0,n).get(o),c){let u=e[s].split(".");t(i,u)[u[u.length-1]]=BE.toJSONObject(c)}}return i}getMiddleware(){let e=this._client.clientOptions.middleware;if(e.workspace&&e.workspace.didChangeConfiguration)return e.workspace.didChangeConfiguration}},Fd=class{constructor(e){this._client=e,this._commands=new Map}get registrationType(){return N.ExecuteCommandRequest.type}fillClientCapabilities(e){pe(pe(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:tt.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,n=t.clientOptions.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(N.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(N.ExecuteCommandRequest.type,c,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(oe.commands.registerCommand(o,(...a)=>n.executeCommand?n.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(n=>n.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}},HE;(function(r){function e(t){return t&&N.MessageReader.is(t.reader)&&N.MessageWriter.is(t.writer)}r.is=e})(HE=_t.MessageTransports||(_t.MessageTransports={}));var Aa=class{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}},ai=class{constructor(e,t,n){var i;this._traceFormat=N.TraceFormat.Text,this._features=[],this._dynamicFeatures=new Map,this._id=e,this._name=t,n=n||{};let s={isTrusted:!1};n.markdown!==void 0&&n.markdown.isTrusted===!0&&(s.isTrusted=!0),this._clientOptions={documentSelector:n.documentSelector||[],synchronize:n.synchronize||{},diagnosticCollectionName:n.diagnosticCollectionName,outputChannelName:n.outputChannelName||this._name,revealOutputChannelOn:n.revealOutputChannelOn||io.Error,stdioEncoding:n.stdioEncoding||"utf8",initializationOptions:n.initializationOptions,initializationFailedHandler:n.initializationFailedHandler,progressOnInitialization:!!n.progressOnInitialization,errorHandler:n.errorHandler||this.createDefaultErrorHandler((i=n.connectionOptions)===null||i===void 0?void 0:i.maxRestartCount),middleware:n.middleware||{},uriConverters:n.uriConverters,workspaceFolder:n.workspaceFolder,connectionOptions:n.connectionOptions,markdown:s},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=dt.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,n.outputChannel?(this._outputChannel=n.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=n.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new q_.Delayer(250),this._onReady=new Promise((o,a)=>{this._onReadyCallbacks=new Aa(o,a)}),this._onStop=void 0,this._telemetryEmitter=new N.Emitter,this._stateChangeEmitter=new N.Emitter,this._trace=N.Trace.Off,this._tracer={log:(o,a)=>{et.string(o)?this.logTrace(o,a):this.logObjectTrace(o)}},this._c2p=UE.createConverter(n.uriConverters?n.uriConverters.code2Protocol:void 0),this._p2c=zE.createConverter(n.uriConverters?n.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let n=this.getPublicState();n!==t&&this._stateChangeEmitter.fire({oldState:t,newState:n})}getPublicState(){return this.state===dt.Running?Da.Running:this.state===dt.Starting?Da.Starting:Da.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(n){throw this.error(`Sending request ${et.string(e)?e:e.method} failed.`,n),n}}onRequest(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{return this._resolvedConnection.onRequest(e,t)}catch(n){throw this.error(`Registering request handler ${et.string(e)?e:e.method} failed.`,n),n}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendNotification(e,t)}catch(n){throw this.error(`Sending notification ${et.string(e)?e:e.method} failed.`,n),n}}onNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{return this._resolvedConnection.onNotification(e,t)}catch(n){throw this.error(`Registering notification handler ${et.string(e)?e:e.method} failed.`,n),n}}onProgress(e,t,n){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{if(N.WorkDoneProgress.is(e)){let i=this._clientOptions.middleware.handleWorkDoneProgress;if(i!==void 0)return this._resolvedConnection.onProgress(e,t,s=>{i(t,s,()=>n(s))})}return this._resolvedConnection.onProgress(e,t,n)}catch(i){throw this.error(`Registering progress handler for token ${t} failed.`,i),i}}sendProgress(e,t,n){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendProgress(e,t,n)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=oe.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new dd(this._name,e??4)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(t=>{t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})})},()=>{})}data2String(e){if(e instanceof N.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?et.string(e.stack)?e.stack:e.message:et.string(e)?e:e.toString()}info(e,t,n=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),n&&this._clientOptions.revealOutputChannelOn<=io.Info&&this.showNotificationMessage()}warn(e,t,n=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),n&&this._clientOptions.revealOutputChannelOn<=io.Warn&&this.showNotificationMessage()}error(e,t,n=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),n&&this._clientOptions.revealOutputChannelOn<=io.Error&&this.showNotificationMessage()}showNotificationMessage(){oe.window.showInformationMessage("A request has failed. See the output for more information.","Go to output").then(()=>{this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.state===dt.Initial||this.state===dt.Stopping||this.state===dt.Stopped}needsStop(){return this.state===dt.Starting||this.state===dt.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===dt.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new Aa(e,t)})),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?oe.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):oe.languages.createDiagnosticCollection()),this.state=dt.Starting,this.resolveConnection().then(e=>(e.onLogMessage(t=>{switch(t.type){case N.MessageType.Error:this.error(t.message,void 0,!1);break;case N.MessageType.Warning:this.warn(t.message,void 0,!1);break;case N.MessageType.Info:this.info(t.message,void 0,!1);break;default:this.outputChannel.appendLine(t.message)}}),e.onShowMessage(t=>{switch(t.type){case N.MessageType.Error:oe.window.showErrorMessage(t.message);break;case N.MessageType.Warning:oe.window.showWarningMessage(t.message);break;case N.MessageType.Info:oe.window.showInformationMessage(t.message);break;default:oe.window.showInformationMessage(t.message)}}),e.onRequest(N.ShowMessageRequest.type,t=>{let n;switch(t.type){case N.MessageType.Error:n=oe.window.showErrorMessage;break;case N.MessageType.Warning:n=oe.window.showWarningMessage;break;case N.MessageType.Info:n=oe.window.showInformationMessage;break;default:n=oe.window.showInformationMessage}let i=t.actions||[];return n(t.message,...i)}),e.onTelemetry(t=>{this._telemetryEmitter.fire(t)}),e.onRequest(N.ShowDocumentRequest.type,async t=>{var n;let i=async o=>{let a=this.protocol2CodeConverter.asUri(o.uri);try{if(o.external===!0)return{success:await oe.env.openExternal(a)};{let c={};return o.selection!==void 0&&(c.selection=this.protocol2CodeConverter.asRange(o.selection)),o.takeFocus===void 0||o.takeFocus===!1?c.preserveFocus=!0:o.takeFocus===!0&&(c.preserveFocus=!1),await oe.window.showTextDocument(a,c),{success:!0}}}catch{return{success:!0}}},s=(n=this._clientOptions.middleware.window)===null||n===void 0?void 0:n.showDocument;return s!==void 0?s(t,i):i(t)}),e.listen(),this.initialize(e))).then(void 0,e=>{this.state=dt.StartFailed,this._onReadyCallbacks.reject(e),this.error("Starting client failed",e),oe.window.showErrorMessage(`Couldn't start client ${this._name}`)}),new oe.Disposable(()=>{this.needsStop()&&this.stop()})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,n=this._clientOptions.workspaceFolder?this._clientOptions.workspaceFolder.uri.fsPath:this._clientGetRootPath(),i={processId:null,clientInfo:{name:oe.env.appName,version:oe.version},locale:this.getLocale(),rootPath:n||null,rootUri:n?this._c2p.asUri(oe.Uri.file(n)):null,capabilities:this.computeClientCapabilities(),initializationOptions:et.func(t)?t():t,trace:N.Trace.toString(this._trace),workspaceFolders:null};if(this.fillInitializeParams(i),this._clientOptions.progressOnInitialization){let s=tt.generateUuid(),o=new GE.ProgressPart(e,s);return i.workDoneToken=s,this.doInitialize(e,i).then(a=>(o.done(),a),a=>{throw o.cancel(),a})}else return this.doInitialize(e,i)}doInitialize(e,t){return e.initialize(t).then(n=>{this._resolvedConnection=e,this._initializeResult=n,this.state=dt.Running;let i;return et.number(n.capabilities.textDocumentSync)?n.capabilities.textDocumentSync===N.TextDocumentSyncKind.None?i={openClose:!1,change:N.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:n.capabilities.textDocumentSync,save:{includeText:!1}}:n.capabilities.textDocumentSync!==void 0&&n.capabilities.textDocumentSync!==null&&(i=n.capabilities.textDocumentSync),this._capabilities=Object.assign({},n.capabilities,{resolvedTextDocumentSync:i}),e.onDiagnostics(s=>this.handleDiagnostics(s)),e.onRequest(N.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(N.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(N.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s)),e.sendNotification(N.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),n}).then(void 0,n=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(n)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(n)):n instanceof N.ResponseError&&n.data&&n.data.retry?oe.window.showErrorMessage(n.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(n))}):(n&&n.message&&oe.window.showErrorMessage(n.message),this.error("Server initialization failed.",n),this.stop(),this._onReadyCallbacks.reject(n)),n})}_clientGetRootPath(){let e=oe.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(){return this._initializeResult=void 0,this._connectionPromise?this.state===dt.Stopping&&this._onStop?this._onStop:(this.state=dt.Stopping,this.cleanUp(!1),this._onStop=this.resolveConnection().then(e=>e.shutdown().then(()=>{e.exit(),e.end(),e.dispose(),this.state=dt.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0}))):(this.state=dt.Stopped,Promise.resolve())}cleanUp(e=!0,t=!0){this._listeners&&(this._listeners.forEach(n=>n.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(n=>n.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let n of this._features.values())n.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var t;let n=this;function i(o){n._fileEvents.push(o),n._fileEventDelayer.trigger(()=>{n.onReady().then(()=>{n.resolveConnection().then(a=>{n.isConnectionActive()&&(n.forceDocumentSync(),a.didChangeWatchedFiles({changes:n._fileEvents})),n._fileEvents=[]})},a=>{n.error("Notify file events failed.",a)})})}let s=(t=this.clientOptions.middleware)===null||t===void 0?void 0:t.workspace;s?.didChangeWatchedFile?s.didChangeWatchedFile(e,i):i(e)}forceDocumentSync(){this._didChangeTextDocumentFeature===void 0&&(this._didChangeTextDocumentFeature=this._dynamicFeatures.get(N.DidChangeTextDocumentNotification.type.method)),this._didChangeTextDocumentFeature.forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=this._p2c.asUri(e.uri),n=this._p2c.asDiagnostics(e.diagnostics),i=this.clientOptions.middleware;i.handleDiagnostics?i.handleDiagnostics(t,n,(s,o)=>this.setDiagnostics(s,o)):this.setDiagnostics(t,n)}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}createConnection(){let e=(n,i,s)=>{this.handleConnectionError(n,i,s)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(n=>VE(n.reader,n.writer,e,t,this._clientOptions.connectionOptions))}handleConnectionClosed(){if(this.state===dt.Stopping||this.state===dt.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch{}let e=oi.DoNotRestart;try{e=this._clientOptions.errorHandler.closed()}catch{}this._connectionPromise=void 0,this._resolvedConnection=void 0,e===oi.DoNotRestart?(this.error("Connection to server got closed. Server will not be restarted."),this.state===dt.Starting?(this._onReadyCallbacks.reject(new Error("Connection to server got closed. Server will not be restarted.")),this.state=dt.StartFailed):this.state=dt.Stopped,this.cleanUp(!1,!0)):e===oi.Restart&&(this.info("Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=dt.Initial,this.start())}handleConnectionError(e,t,n){this._clientOptions.errorHandler.error(e,t,n)===Oa.Shutdown&&(this.error("Connection to server is erroring. Shutting down server."),this.stop())}hookConfigurationChanged(e){oe.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let n=oe.workspace.getConfiguration(this._id),i=N.Trace.Off,s=N.TraceFormat.Text;if(n){let o=n.get("trace.server","off");typeof o=="string"?i=N.Trace.fromString(o):(i=N.Trace.fromString(n.get("trace.server.verbosity","off")),s=N.TraceFormat.fromString(n.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let n;et.array(t)?n=t:n=[t],n&&this._dynamicFeatures.get(N.DidChangeWatchedFilesNotification.type.method).registerRaw(tt.generateUuid(),n)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),fd.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new qd(this)),this.registerFeature(new hd(this,this._syncedDocuments)),this.registerFeature(new gd(this)),this.registerFeature(new md(this)),this.registerFeature(new _d(this)),this.registerFeature(new bd(this)),this.registerFeature(new pd(this,this._syncedDocuments)),this.registerFeature(new vd(this,e=>this.notifyFileEvent(e))),this.registerFeature(new wd(this)),this.registerFeature(new Rd(this)),this.registerFeature(new Sd(this)),this.registerFeature(new Cd(this)),this.registerFeature(new xd(this)),this.registerFeature(new Ed(this)),this.registerFeature(new kd(this)),this.registerFeature(new Td(this)),this.registerFeature(new Pd(this)),this.registerFeature(new Id(this)),this.registerFeature(new Dd(this)),this.registerFeature(new Od(this)),this.registerFeature(new Ad(this)),this.registerFeature(new Nd(this)),this.registerFeature(new Ld(this)),this.registerFeature(new Fd(this))}fillInitializeParams(e){for(let t of this._features)et.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};pe(e,"workspace").applyEdit=!0;let t=pe(pe(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[N.ResourceOperationKind.Create,N.ResourceOperationKind.Rename,N.ResourceOperationKind.Delete],t.failureHandling=N.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let n=pe(pe(e,"textDocument"),"publishDiagnostics");n.relatedInformation=!0,n.versionSupport=!1,n.tagSupport={valueSet:[N.DiagnosticTag.Unnecessary,N.DiagnosticTag.Deprecated]},n.codeDescriptionSupport=!0,n.dataSupport=!0;let i=pe(e,"window"),s=pe(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=pe(i,"showDocument");o.support=!0;let a=pe(e,"general");a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"};for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let n of this._features)n.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,n)=>{for(let i of e.registrations){let s=this._dynamicFeatures.get(i.method);if(s===void 0){n(new Error(`No feature implementation for ${i.method} found. Registration failed.`));return}let o=i.registerOptions||{};o.documentSelector=o.documentSelector||this._clientOptions.documentSelector;let a={id:i.id,registerOptions:o};try{s.register(a)}catch(c){n(c);return}}t()})}handleUnregistrationRequest(e){return new Promise((t,n)=>{for(let i of e.unregisterations){let s=this._dynamicFeatures.get(i.method);if(!s){n(new Error(`No feature implementation for ${i.method} found. Unregistration failed.`));return}s.unregister(i.id)}t()})}handleApplyWorkspaceEdit(e){let t=e.edit,n=new Map;oe.workspace.textDocuments.forEach(s=>n.set(s.uri.toString(),s));let i=!1;if(t.documentChanges){for(let s of t.documentChanges)if(N.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){let o=n.get(s.textDocument.uri);if(o&&o.version!==s.textDocument.version){i=!0;break}}}return i?Promise.resolve({applied:!1}):et.asPromise(oe.workspace.applyEdit(this._p2c.asWorkspaceEdit(e.edit)).then(s=>({applied:s})))}handleFailedRequest(e,t,n){if(t instanceof N.ResponseError){if(t.code===N.LSPErrorCodes.RequestCancelled)throw this.makeCancelError();if(t.code===N.LSPErrorCodes.ContentModified)return n}throw this.error(`Request ${e.method} failed.`,t),t}makeCancelError(){let e=new Error(ai.Canceled);return e.name=ai.Canceled,e}};_t.BaseLanguageClient=ai;ai.Canceled="Canceled"});var j_=B(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.ColorProviderFeature=void 0;var Na=require("vscode"),oo=pt(),KE=bn();function $_(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var Md=class extends KE.TextDocumentFeature{constructor(e){super(e,oo.DocumentColorRequest.type)}fillClientCapabilities(e){$_($_(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.colorProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideColorPresentations:(n,i,s)=>{let o=this._client,a=(u,h,v)=>{let m={color:u,textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(h.document),range:o.code2ProtocolConverter.asRange(h.range)};return o.sendRequest(oo.ColorPresentationRequest.type,m,v).then(this.asColorPresentations.bind(this),b=>o.handleFailedRequest(oo.ColorPresentationRequest.type,b,null))},c=o.clientOptions.middleware;return c.provideColorPresentations?c.provideColorPresentations(n,i,s,a):a(n,i,s)},provideDocumentColors:(n,i)=>{let s=this._client,o=(c,u)=>{let h={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(c)};return s.sendRequest(oo.DocumentColorRequest.type,h,u).then(this.asColorInformations.bind(this),v=>s.handleFailedRequest(oo.ColorPresentationRequest.type,v,null))},a=s.clientOptions.middleware;return a.provideDocumentColors?a.provideDocumentColors(n,i,o):o(n,i)}};return[Na.languages.registerColorProvider(e.documentSelector,t),t]}asColor(e){return new Na.Color(e.red,e.green,e.blue,e.alpha)}asColorInformations(e){return Array.isArray(e)?e.map(t=>new Na.ColorInformation(this._client.protocol2CodeConverter.asRange(t.range),this.asColor(t.color))):[]}asColorPresentations(e){return Array.isArray(e)?e.map(t=>{let n=new Na.ColorPresentation(t.label);return n.additionalTextEdits=this._client.protocol2CodeConverter.asTextEdits(t.additionalTextEdits),n.textEdit=this._client.protocol2CodeConverter.asTextEdit(t.textEdit),n}):[]}};La.ColorProviderFeature=Md});var U_=B(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.ImplementationFeature=void 0;var YE=require("vscode"),$d=pt(),XE=bn();function B_(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var jd=class extends XE.TextDocumentFeature{constructor(e){super(e,$d.ImplementationRequest.type)}fillClientCapabilities(e){let t=B_(B_(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.implementationProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideImplementation:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest($d.ImplementationRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asDefinitionResult,m=>o.handleFailedRequest($d.ImplementationRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideImplementation?c.provideImplementation(n,i,s,a):a(n,i,s)}};return[YE.languages.registerImplementationProvider(e.documentSelector,t),t]}};qa.ImplementationFeature=jd});var z_=B(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.TypeDefinitionFeature=void 0;var QE=require("vscode"),Bd=pt(),ZE=bn();function Fa(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var Ud=class extends ZE.TextDocumentFeature{constructor(e){super(e,Bd.TypeDefinitionRequest.type)}fillClientCapabilities(e){Fa(Fa(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=Fa(Fa(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.typeDefinitionProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideTypeDefinition:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest(Bd.TypeDefinitionRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asDefinitionResult,m=>o.handleFailedRequest(Bd.TypeDefinitionRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideTypeDefinition?c.provideTypeDefinition(n,i,s,a):a(n,i,s)}};return[QE.languages.registerTypeDefinitionProvider(e.documentSelector,t),t]}};Ma.TypeDefinitionFeature=Ud});var G_=B(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.WorkspaceFoldersFeature=Vi.arrayDiff=void 0;var JE=Pa(),$a=require("vscode"),zd=pt();function Gd(r,e){if(r!==void 0)return r[e]}function Vd(r,e){return r.filter(t=>e.indexOf(t)<0)}Vi.arrayDiff=Vd;var Wd=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return zd.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=$a.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(n=>this.asProtocol(n))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(zd.WorkspaceFoldersRequest.type,s=>{let o=()=>{let c=$a.workspace.workspaceFolders;return c===void 0?null:c.map(h=>this.asProtocol(h))},a=t.clientOptions.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let n=Gd(Gd(Gd(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof n=="string"?i=n:n===!0&&(i=JE.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){if(this._initialFolders&&e){let t=Vd(this._initialFolders,e),n=Vd(e,this._initialFolders);(n.length>0||t.length>0)&&this.doSendEvent(n,t)}else this._initialFolders?this.doSendEvent([],this._initialFolders):e&&this.doSendEvent(e,[])}doSendEvent(e,t){let n={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};this._client.sendNotification(zd.DidChangeWorkspaceFoldersNotification.type,n)}register(e){let t=e.id,n=this._client,i=$a.workspace.onDidChangeWorkspaceFolders(s=>{let o=c=>{this.doSendEvent(c.added,c.removed)},a=n.clientOptions.middleware.workspace;a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)});this._listeners.set(t,i),this.sendInitialEvent($a.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};Vi.WorkspaceFoldersFeature=Wd});var W_=B(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.FoldingRangeFeature=void 0;var ao=require("vscode"),Wi=pt(),ek=bn();function V_(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var Hi=class extends ek.TextDocumentFeature{constructor(e){super(e,Wi.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=V_(V_(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.foldingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideFoldingRanges:(n,i,s)=>{let o=this._client,a=(u,h,v)=>{let m={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u)};return o.sendRequest(Wi.FoldingRangeRequest.type,m,v).then(Hi.asFoldingRanges,b=>o.handleFailedRequest(Wi.FoldingRangeRequest.type,b,null))},c=o.clientOptions.middleware;return c.provideFoldingRanges?c.provideFoldingRanges(n,i,s,a):a(n,i,s)}};return[ao.languages.registerFoldingRangeProvider(e.documentSelector,t),t]}static asFoldingRangeKind(e){if(e)switch(e){case Wi.FoldingRangeKind.Comment:return ao.FoldingRangeKind.Comment;case Wi.FoldingRangeKind.Imports:return ao.FoldingRangeKind.Imports;case Wi.FoldingRangeKind.Region:return ao.FoldingRangeKind.Region}}static asFoldingRanges(e){return Array.isArray(e)?e.map(t=>new ao.FoldingRange(t.startLine,t.endLine,Hi.asFoldingRangeKind(t.kind))):[]}};ja.FoldingRangeFeature=Hi});var K_=B(Ba=>{"use strict";Object.defineProperty(Ba,"__esModule",{value:!0});Ba.DeclarationFeature=void 0;var tk=require("vscode"),Hd=pt(),nk=bn();function H_(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var Kd=class extends nk.TextDocumentFeature{constructor(e){super(e,Hd.DeclarationRequest.type)}fillClientCapabilities(e){let t=H_(H_(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.declarationProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideDeclaration:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest(Hd.DeclarationRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asDeclarationResult,m=>o.handleFailedRequest(Hd.DeclarationRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideDeclaration?c.provideDeclaration(n,i,s,a):a(n,i,s)}};return[tk.languages.registerDeclarationProvider(e.documentSelector,t),t]}};Ba.DeclarationFeature=Kd});var X_=B(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.SelectionRangeFeature=void 0;var rk=require("vscode"),Yd=pt(),ik=bn();function Y_(r,e){return r[e]===void 0&&(r[e]=Object.create(null)),r[e]}var Xd=class extends ik.TextDocumentFeature{constructor(e){super(e,Yd.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=Y_(Y_(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.selectionRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideSelectionRanges:(n,i,s)=>{let o=this._client,a=(u,h,v)=>{let m={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u),positions:o.code2ProtocolConverter.asPositions(h)};return o.sendRequest(Yd.SelectionRangeRequest.type,m,v).then(b=>o.protocol2CodeConverter.asSelectionRanges(b),b=>o.handleFailedRequest(Yd.SelectionRangeRequest.type,b,null))},c=o.clientOptions.middleware;return c.provideSelectionRanges?c.provideSelectionRanges(n,i,s,a):a(n,i,s)}};return[rk.languages.registerSelectionRangeProvider(e.documentSelector,t),t]}};Ua.SelectionRangeFeature=Xd});var Q_=B(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.ProgressFeature=void 0;var sk=pt(),ok=ud();function ak(r,e){return r[e]===void 0&&(r[e]=Object.create(null)),r[e]}var Qd=class{constructor(e){this._client=e,this.activeParts=new Set}fillClientCapabilities(e){ak(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},n=i=>{this.activeParts.add(new ok.ProgressPart(this._client,i.token,t))};e.onRequest(sk.WorkDoneProgressCreateRequest.type,n)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};za.ProgressFeature=Qd});var J_=B(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.CallHierarchyFeature=void 0;var ck=require("vscode"),ci=pt(),uk=bn();function Z_(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var Zd=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,n){let i=this.client,s=this.middleware,o=(a,c,u)=>{let h=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(ci.CallHierarchyPrepareRequest.type,h,u).then(v=>i.protocol2CodeConverter.asCallHierarchyItems(v),v=>i.handleFailedRequest(ci.CallHierarchyPrepareRequest.type,v,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,n,o):o(e,t,n)}provideCallHierarchyIncomingCalls(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let c={item:n.code2ProtocolConverter.asCallHierarchyItem(o)};return n.sendRequest(ci.CallHierarchyIncomingCallsRequest.type,c,a).then(u=>n.protocol2CodeConverter.asCallHierarchyIncomingCalls(u),u=>n.handleFailedRequest(ci.CallHierarchyIncomingCallsRequest.type,u,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let c={item:n.code2ProtocolConverter.asCallHierarchyItem(o)};return n.sendRequest(ci.CallHierarchyOutgoingCallsRequest.type,c,a).then(u=>n.protocol2CodeConverter.asCallHierarchyOutgoingCalls(u),u=>n.handleFailedRequest(ci.CallHierarchyOutgoingCallsRequest.type,u,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},Jd=class extends uk.TextDocumentFeature{constructor(e){super(e,ci.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let n=Z_(Z_(e,"textDocument"),"callHierarchy");n.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.callHierarchyProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=this._client,n=new Zd(t);return[ck.languages.registerCallHierarchyProvider(e.documentSelector,n),n]}};Ga.CallHierarchyFeature=Jd});var eb=B(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.SemanticTokensFeature=void 0;var Va=require("vscode"),lk=bn(),qe=pt(),dk=Cr();function Wa(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var ef=class extends lk.TextDocumentFeature{constructor(e){super(e,qe.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=Wa(Wa(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[qe.SemanticTokenTypes.namespace,qe.SemanticTokenTypes.type,qe.SemanticTokenTypes.class,qe.SemanticTokenTypes.enum,qe.SemanticTokenTypes.interface,qe.SemanticTokenTypes.struct,qe.SemanticTokenTypes.typeParameter,qe.SemanticTokenTypes.parameter,qe.SemanticTokenTypes.variable,qe.SemanticTokenTypes.property,qe.SemanticTokenTypes.enumMember,qe.SemanticTokenTypes.event,qe.SemanticTokenTypes.function,qe.SemanticTokenTypes.method,qe.SemanticTokenTypes.macro,qe.SemanticTokenTypes.keyword,qe.SemanticTokenTypes.modifier,qe.SemanticTokenTypes.comment,qe.SemanticTokenTypes.string,qe.SemanticTokenTypes.number,qe.SemanticTokenTypes.regexp,qe.SemanticTokenTypes.operator],t.tokenModifiers=[qe.SemanticTokenModifiers.declaration,qe.SemanticTokenModifiers.definition,qe.SemanticTokenModifiers.readonly,qe.SemanticTokenModifiers.static,qe.SemanticTokenModifiers.deprecated,qe.SemanticTokenModifiers.abstract,qe.SemanticTokenModifiers.async,qe.SemanticTokenModifiers.modification,qe.SemanticTokenModifiers.documentation,qe.SemanticTokenModifiers.defaultLibrary],t.formats=[qe.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,Wa(Wa(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(qe.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=dk.boolean(e.full)?e.full:e.full!==void 0,n=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,i=new Va.EventEmitter,s=t?{onDidChangeSemanticTokens:i.event,provideDocumentSemanticTokens:(v,m)=>{let b=this._client,k=b.clientOptions.middleware,f=(_,w)=>{let S={textDocument:b.code2ProtocolConverter.asTextDocumentIdentifier(_)};return b.sendRequest(qe.SemanticTokensRequest.type,S,w).then(y=>b.protocol2CodeConverter.asSemanticTokens(y),y=>b.handleFailedRequest(qe.SemanticTokensRequest.type,y,null))};return k.provideDocumentSemanticTokens?k.provideDocumentSemanticTokens(v,m,f):f(v,m)},provideDocumentSemanticTokensEdits:n?(v,m,b)=>{let k=this._client,f=k.clientOptions.middleware,_=(w,S,y)=>{let l={textDocument:k.code2ProtocolConverter.asTextDocumentIdentifier(w),previousResultId:S};return k.sendRequest(qe.SemanticTokensDeltaRequest.type,l,y).then(x=>qe.SemanticTokens.is(x)?k.protocol2CodeConverter.asSemanticTokens(x):k.protocol2CodeConverter.asSemanticTokensEdits(x),x=>k.handleFailedRequest(qe.SemanticTokensDeltaRequest.type,x,null))};return f.provideDocumentSemanticTokensEdits?f.provideDocumentSemanticTokensEdits(v,m,b,_):_(v,m,b)}:void 0}:void 0,a=e.range===!0?{provideDocumentRangeSemanticTokens:(v,m,b)=>{let k=this._client,f=k.clientOptions.middleware,_=(w,S,y)=>{let l={textDocument:k.code2ProtocolConverter.asTextDocumentIdentifier(w),range:k.code2ProtocolConverter.asRange(S)};return k.sendRequest(qe.SemanticTokensRangeRequest.type,l,y).then(x=>k.protocol2CodeConverter.asSemanticTokens(x),x=>k.handleFailedRequest(qe.SemanticTokensRangeRequest.type,x,null))};return f.provideDocumentRangeSemanticTokens?f.provideDocumentRangeSemanticTokens(v,m,b,_):_(v,m,b)}}:void 0,c=[],h=this._client.protocol2CodeConverter.asSemanticTokensLegend(e.legend);return s!==void 0&&c.push(Va.languages.registerDocumentSemanticTokensProvider(e.documentSelector,s,h)),a!==void 0&&c.push(Va.languages.registerDocumentRangeSemanticTokensProvider(e.documentSelector,a,h)),[new Va.Disposable(()=>c.forEach(v=>v.dispose())),{range:a,full:s,onDidChangeSemanticTokensEmitter:i}]}};Ha.SemanticTokensFeature=ef});var nb=B((a1,tb)=>{tb.exports=function(r,e){for(var t=[],n=0;n<r.length;n++){var i=e(r[n],n);fk(i)?t.push.apply(t,i):t.push(i)}return t};var fk=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"}});var ab=B((c1,ob)=>{"use strict";ob.exports=ib;function ib(r,e,t){r instanceof RegExp&&(r=rb(r,t)),e instanceof RegExp&&(e=rb(e,t));var n=sb(r,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+r.length,n[1]),post:t.slice(n[1]+e.length)}}function rb(r,e){var t=e.match(r);return t?t[0]:null}ib.range=sb;function sb(r,e,t){var n,i,s,o,a,c=t.indexOf(r),u=t.indexOf(e,c+1),h=c;if(c>=0&&u>0){for(n=[],s=t.length;h>=0&&!a;)h==c?(n.push(h),c=t.indexOf(r,h+1)):n.length==1?a=[n.pop(),u]:(i=n.pop(),i<s&&(s=i,o=u),u=t.indexOf(e,h+1)),h=c<u&&c>=0?c:u;n.length&&(a=[s,o])}return a}});var gb=B((u1,pb)=>{var hk=nb(),cb=ab();pb.exports=mk;var ub="\0SLASH"+Math.random()+"\0",lb="\0OPEN"+Math.random()+"\0",nf="\0CLOSE"+Math.random()+"\0",db="\0COMMA"+Math.random()+"\0",fb="\0PERIOD"+Math.random()+"\0";function tf(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}function pk(r){return r.split("\\\\").join(ub).split("\\{").join(lb).split("\\}").join(nf).split("\\,").join(db).split("\\.").join(fb)}function gk(r){return r.split(ub).join("\\").split(lb).join("{").split(nf).join("}").split(db).join(",").split(fb).join(".")}function hb(r){if(!r)return[""];var e=[],t=cb("{","}",r);if(!t)return r.split(",");var n=t.pre,i=t.body,s=t.post,o=n.split(",");o[o.length-1]+="{"+i+"}";var a=hb(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function mk(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),Ki(pk(r),!0).map(gk)):[]}function _k(r){return"{"+r+"}"}function bk(r){return/^-?0\d/.test(r)}function vk(r,e){return r<=e}function yk(r,e){return r>=e}function Ki(r,e){var t=[],n=cb("{","}",r);if(!n||/\$$/.test(n.pre))return[r];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),o=i||s,a=n.body.indexOf(",")>=0;if(!o&&!a)return n.post.match(/,.*\}/)?(r=n.pre+"{"+n.body+nf+n.post,Ki(r)):[r];var c;if(o)c=n.body.split(/\.\./);else if(c=hb(n.body),c.length===1&&(c=Ki(c[0],!1).map(_k),c.length===1)){var h=n.post.length?Ki(n.post,!1):[""];return h.map(function(z){return n.pre+c[0]+z})}var u=n.pre,h=n.post.length?Ki(n.post,!1):[""],v;if(o){var m=tf(c[0]),b=tf(c[1]),k=Math.max(c[0].length,c[1].length),f=c.length==3?Math.abs(tf(c[2])):1,_=vk,w=b<m;w&&(f*=-1,_=yk);var S=c.some(bk);v=[];for(var y=m;_(y,b);y+=f){var l;if(s)l=String.fromCharCode(y),l==="\\"&&(l="");else if(l=String(y),S){var x=k-l.length;if(x>0){var E=new Array(x+1).join("0");y<0?l="-"+E+l.slice(1):l=E+l}}v.push(l)}}else v=hk(c,function(F){return Ki(F,!1)});for(var C=0;C<v.length;C++)for(var T=0;T<h.length;T++){var D=u+v[C]+h[T];(!e||o||D)&&t.push(D)}return t}});var wb=B((l1,yb)=>{yb.exports=vn;vn.Minimatch=jt;var co=function(){try{return require("path")}catch{}}()||{sep:"/"};vn.sep=co.sep;var of=vn.GLOBSTAR=jt.GLOBSTAR={},wk=gb(),mb={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},rf="[^/]",sf=rf+"*?",Rk="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Sk="(?:(?!(?:\\/|^)\\.).)*?",_b=Ck("().*{}+?[]^$\\!");function Ck(r){return r.split("").reduce(function(e,t){return e[t]=!0,e},{})}var bb=/\/+/;vn.filter=xk;function xk(r,e){return e=e||{},function(t,n,i){return vn(t,r,e)}}function Ir(r,e){e=e||{};var t={};return Object.keys(r).forEach(function(n){t[n]=r[n]}),Object.keys(e).forEach(function(n){t[n]=e[n]}),t}vn.defaults=function(r){if(!r||typeof r!="object"||!Object.keys(r).length)return vn;var e=vn,t=function(i,s,o){return e(i,s,Ir(r,o))};return t.Minimatch=function(i,s){return new e.Minimatch(i,Ir(r,s))},t.Minimatch.defaults=function(i){return e.defaults(Ir(r,i)).Minimatch},t.filter=function(i,s){return e.filter(i,Ir(r,s))},t.defaults=function(i){return e.defaults(Ir(r,i))},t.makeRe=function(i,s){return e.makeRe(i,Ir(r,s))},t.braceExpand=function(i,s){return e.braceExpand(i,Ir(r,s))},t.match=function(n,i,s){return e.match(n,i,Ir(r,s))},t};jt.defaults=function(r){return vn.defaults(r).Minimatch};function vn(r,e,t){return Ya(e),t||(t={}),!t.nocomment&&e.charAt(0)==="#"?!1:new jt(e,t).match(r)}function jt(r,e){if(!(this instanceof jt))return new jt(r,e);Ya(r),e||(e={}),r=r.trim(),!e.allowWindowsEscape&&co.sep!=="/"&&(r=r.split(co.sep).join("/")),this.options=e,this.set=[],this.pattern=r,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}jt.prototype.debug=function(){};jt.prototype.make=Ek;function Ek(){var r=this.pattern,e=this.options;if(!e.nocomment&&r.charAt(0)==="#"){this.comment=!0;return}if(!r){this.empty=!0;return}this.parseNegate();var t=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,t),t=this.globParts=t.map(function(n){return n.split(bb)}),this.debug(this.pattern,t),t=t.map(function(n,i,s){return n.map(this.parse,this)},this),this.debug(this.pattern,t),t=t.filter(function(n){return n.indexOf(!1)===-1}),this.debug(this.pattern,t),this.set=t}jt.prototype.parseNegate=kk;function kk(){var r=this.pattern,e=!1,t=this.options,n=0;if(!t.nonegate){for(var i=0,s=r.length;i<s&&r.charAt(i)==="!";i++)e=!e,n++;n&&(this.pattern=r.substr(n)),this.negate=e}}vn.braceExpand=function(r,e){return vb(r,e)};jt.prototype.braceExpand=vb;function vb(r,e){return e||(this instanceof jt?e=this.options:e={}),r=typeof r>"u"?this.pattern:r,Ya(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:wk(r)}var Tk=1024*64,Ya=function(r){if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>Tk)throw new TypeError("pattern is too long")};jt.prototype.parse=Pk;var Ka={};function Pk(r,e){Ya(r);var t=this.options;if(r==="**")if(t.noglobstar)r="*";else return of;if(r==="")return"";var n="",i=!!t.nocase,s=!1,o=[],a=[],c,u=!1,h=-1,v=-1,m=r.charAt(0)==="."?"":t.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",b=this;function k(){if(c){switch(c){case"*":n+=sf,i=!0;break;case"?":n+=rf,i=!0;break;default:n+="\\"+c;break}b.debug("clearStateChar %j %j",c,n),c=!1}}for(var f=0,_=r.length,w;f<_&&(w=r.charAt(f));f++){if(this.debug("%s	%s %s %j",r,f,n,w),s&&_b[w]){n+="\\"+w,s=!1;continue}switch(w){case"/":return!1;case"\\":k(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",r,f,n,w),u){this.debug("  in class"),w==="!"&&f===v+1&&(w="^"),n+=w;continue}b.debug("call clearStateChar %j",c),k(),c=w,t.noext&&k();continue;case"(":if(u){n+="(";continue}if(!c){n+="\\(";continue}o.push({type:c,start:f-1,reStart:n.length,open:mb[c].open,close:mb[c].close}),n+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,n),c=!1;continue;case")":if(u||!o.length){n+="\\)";continue}k(),i=!0;var S=o.pop();n+=S.close,S.type==="!"&&a.push(S),S.reEnd=n.length;continue;case"|":if(u||!o.length||s){n+="\\|",s=!1;continue}k(),n+="|";continue;case"[":if(k(),u){n+="\\"+w;continue}u=!0,v=f,h=n.length,n+=w;continue;case"]":if(f===v+1||!u){n+="\\"+w,s=!1;continue}var y=r.substring(v+1,f);try{RegExp("["+y+"]")}catch{var l=this.parse(y,Ka);n=n.substr(0,h)+"\\["+l[0]+"\\]",i=i||l[1],u=!1;continue}i=!0,u=!1,n+=w;continue;default:k(),s?s=!1:_b[w]&&!(w==="^"&&u)&&(n+="\\"),n+=w}}for(u&&(y=r.substr(v+1),l=this.parse(y,Ka),n=n.substr(0,h)+"\\["+l[0],i=i||l[1]),S=o.pop();S;S=o.pop()){var x=n.slice(S.reStart+S.open.length);this.debug("setting tail",n,S),x=x.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Ee,ge,me){return me||(me="\\"),ge+ge+me+"|"}),this.debug(`tail=%j
   %s`,x,x,S,n);var E=S.type==="*"?sf:S.type==="?"?rf:"\\"+S.type;i=!0,n=n.slice(0,S.reStart)+E+"\\("+x}k(),s&&(n+="\\\\");var C=!1;switch(n.charAt(0)){case"[":case".":case"(":C=!0}for(var T=a.length-1;T>-1;T--){var D=a[T],F=n.slice(0,D.reStart),z=n.slice(D.reStart,D.reEnd-8),H=n.slice(D.reEnd-8,D.reEnd),Q=n.slice(D.reEnd);H+=Q;var J=F.split("(").length-1,ie=Q;for(f=0;f<J;f++)ie=ie.replace(/\)[+*?]?/,"");Q=ie;var be="";Q===""&&e!==Ka&&(be="$");var ee=F+z+Q+be+H;n=ee}if(n!==""&&i&&(n="(?=.)"+n),C&&(n=m+n),e===Ka)return[n,i];if(!i)return Dk(r);var Ae=t.nocase?"i":"";try{var ae=new RegExp("^"+n+"$",Ae)}catch{return new RegExp("$.")}return ae._glob=r,ae._src=n,ae}vn.makeRe=function(r,e){return new jt(r,e||{}).makeRe()};jt.prototype.makeRe=Ik;function Ik(){if(this.regexp||this.regexp===!1)return this.regexp;var r=this.set;if(!r.length)return this.regexp=!1,this.regexp;var e=this.options,t=e.noglobstar?sf:e.dot?Rk:Sk,n=e.nocase?"i":"",i=r.map(function(s){return s.map(function(o){return o===of?t:typeof o=="string"?Ok(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch{this.regexp=!1}return this.regexp}vn.match=function(r,e,t){t=t||{};var n=new jt(e,t);return r=r.filter(function(i){return n.match(i)}),n.options.nonull&&!r.length&&r.push(e),r};jt.prototype.match=function(e,t){if(typeof t>"u"&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;co.sep!=="/"&&(e=e.split(co.sep).join("/")),e=e.split(bb),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var s,o;for(o=e.length-1;o>=0&&(s=e[o],!s);o--);for(o=0;o<i.length;o++){var a=i[o],c=e;n.matchBase&&a.length===1&&(c=[s]);var u=this.matchOne(c,a,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate};jt.prototype.matchOne=function(r,e,t){var n=this.options;this.debug("matchOne",{this:this,file:r,pattern:e}),this.debug("matchOne",r.length,e.length);for(var i=0,s=0,o=r.length,a=e.length;i<o&&s<a;i++,s++){this.debug("matchOne loop");var c=e[s],u=r[i];if(this.debug(e,c,u),c===!1)return!1;if(c===of){this.debug("GLOBSTAR",[e,c,u]);var h=i,v=s+1;if(v===a){for(this.debug("** at the end");i<o;i++)if(r[i]==="."||r[i]===".."||!n.dot&&r[i].charAt(0)===".")return!1;return!0}for(;h<o;){var m=r[h];if(this.debug(`
globstar while`,r,h,e,v,m),this.matchOne(r.slice(h),e.slice(v),t))return this.debug("globstar found match!",h,o,m),!0;if(m==="."||m===".."||!n.dot&&m.charAt(0)==="."){this.debug("dot detected!",r,h,e,v);break}this.debug("globstar swallow a segment, and continue"),h++}return!!(t&&(this.debug(`
>>> no match, partial?`,r,h,e,v),h===o))}var b;if(typeof c=="string"?(b=u===c,this.debug("string match",c,u,b)):(b=u.match(c),this.debug("pattern match",c,u,b)),!b)return!1}if(i===o&&s===a)return!0;if(i===o)return t;if(s===a)return i===o-1&&r[i]==="";throw new Error("wtf?")};function Dk(r){return r.replace(/\\(.)/g,"$1")}function Ok(r){return r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Cb=B(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.WillDeleteFilesFeature=hn.WillRenameFilesFeature=hn.WillCreateFilesFeature=hn.DidDeleteFilesFeature=hn.DidRenameFilesFeature=hn.DidCreateFilesFeature=void 0;var er=require("vscode"),Ak=wb(),pr=pt(),Nk=Pa();function Rb(r,e){return r[e]===void 0&&(r[e]={}),r[e]}function Lk(r,e){return r[e]}function Sb(r,e,t){r[e]=t}var Dr=class{constructor(e,t,n,i,s){this._filters=new Map,this._client=e,this._event=t,this._registrationType=n,this._clientCapability=i,this._serverCapability=s}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Rb(Rb(e,"workspace"),"fileOperations");Sb(t,"dynamicRegistration",!0),Sb(t,this._clientCapability,!0)}initialize(e){var t;let n=(t=e.workspace)===null||t===void 0?void 0:t.fileOperations,i=n!==void 0?Lk(n,this._serverCapability):void 0;if(i?.filters!==void 0)try{this.register({id:Nk.generateUuid(),registerOptions:{filters:i.filters}})}catch(s){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${s}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(n=>{let i=new Ak.Minimatch(n.pattern.glob,Dr.asMinimatchOptions(n.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${n.pattern.glob}!`);return{scheme:n.scheme,matcher:i,kind:n.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}async filter(e,t){let n=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let u of c)if(!(u.scheme!==void 0&&u.scheme!==o.scheme)){if(u.matcher.match(a)){if(u.kind===void 0)return!0;let h=await Dr.getFileType(o);if(h===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(h===er.FileType.File&&u.kind===pr.FileOperationPatternKind.file||h===er.FileType.Directory&&u.kind===pr.FileOperationPatternKind.folder)return!0}else if(u.kind===pr.FileOperationPatternKind.folder&&await Dr.getFileType(o)===er.FileType.Directory&&u.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>n[o]);return Object.assign(Object.assign({},e),{files:i})}static async getFileType(e){try{return(await er.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},uo=class extends Dr{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s),this._notificationType=n,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let n=async i=>{this._client.sendNotification(this._notificationType,this._createParams(i))};this.doSend(t,n)}}},af=class extends uo{constructor(e){super(e,er.workspace.onDidCreateFiles,pr.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){var n;let i=(n=this._client.clientOptions.middleware)===null||n===void 0?void 0:n.workspace;return i?.didCreateFiles?i.didCreateFiles(e,t):t(e)}};hn.DidCreateFilesFeature=af;var cf=class extends uo{constructor(e){super(e,er.workspace.onDidRenameFiles,pr.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}doSend(e,t){var n;let i=(n=this._client.clientOptions.middleware)===null||n===void 0?void 0:n.workspace;return i?.didRenameFiles?i.didRenameFiles(e,t):t(e)}};hn.DidRenameFilesFeature=cf;var uf=class extends uo{constructor(e){super(e,er.workspace.onDidDeleteFiles,pr.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}doSend(e,t){var n;let i=(n=this._client.clientOptions.middleware)===null||n===void 0?void 0:n.workspace;return i?.didDeleteFiles?i.didDeleteFiles(e,t):t(e)}};hn.DidDeleteFilesFeature=uf;var lo=class extends Dr{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s),this._requestType=n,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let n=i=>this._client.sendRequest(this._requestType,this._createParams(i)).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,n)}else return}},lf=class extends lo{constructor(e){super(e,er.workspace.onWillCreateFiles,pr.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){var n;let i=(n=this._client.clientOptions.middleware)===null||n===void 0?void 0:n.workspace;return i?.willCreateFiles?i.willCreateFiles(e,t):t(e)}};hn.WillCreateFilesFeature=lf;var df=class extends lo{constructor(e){super(e,er.workspace.onWillRenameFiles,pr.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){var n;let i=(n=this._client.clientOptions.middleware)===null||n===void 0?void 0:n.workspace;return i?.willRenameFiles?i.willRenameFiles(e,t):t(e)}};hn.WillRenameFilesFeature=df;var ff=class extends lo{constructor(e){super(e,er.workspace.onWillDeleteFiles,pr.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){var n;let i=(n=this._client.clientOptions.middleware)===null||n===void 0?void 0:n.workspace;return i?.willDeleteFiles?i.willDeleteFiles(e,t):t(e)}};hn.WillDeleteFilesFeature=ff});var Eb=B(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.LinkedEditingFeature=void 0;var qk=require("vscode"),hf=pt(),Fk=bn();function xb(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var pf=class extends Fk.TextDocumentFeature{constructor(e){super(e,hf.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=xb(xb(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t={provideLinkedEditingRanges:(n,i,s)=>{let o=this._client,a=(u,h,v)=>o.sendRequest(hf.LinkedEditingRangeRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(u,h),v).then(o.protocol2CodeConverter.asLinkedEditingRanges,m=>o.handleFailedRequest(hf.LinkedEditingRangeRequest.type,m,null)),c=o.clientOptions.middleware;return c.provideLinkedEditingRange?c.provideLinkedEditingRange(n,i,s,a):a(n,i,s)}};return[qk.languages.registerLinkedEditingRangeProvider(e.documentSelector,t),t]}};Xa.LinkedEditingFeature=pf});var mf=B(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.ProposedFeatures=ui.CommonLanguageClient=void 0;var Mk=bn(),$k=j_(),jk=Bl(),Bk=U_(),Uk=z_(),zk=G_(),Gk=W_(),Vk=K_(),Wk=X_(),Hk=Q_(),Kk=J_(),Yk=eb(),Yi=Cb(),Xk=Eb(),gf=class extends Mk.BaseLanguageClient{constructor(e,t,n){super(e,t,n)}registerProposedFeatures(){this.registerFeatures(kb.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new jk.ConfigurationFeature(this)),this.registerFeature(new Uk.TypeDefinitionFeature(this)),this.registerFeature(new Bk.ImplementationFeature(this)),this.registerFeature(new $k.ColorProviderFeature(this)),this.registerFeature(new zk.WorkspaceFoldersFeature(this)),this.registerFeature(new Gk.FoldingRangeFeature(this)),this.registerFeature(new Vk.DeclarationFeature(this)),this.registerFeature(new Wk.SelectionRangeFeature(this)),this.registerFeature(new Hk.ProgressFeature(this)),this.registerFeature(new Kk.CallHierarchyFeature(this)),this.registerFeature(new Yk.SemanticTokensFeature(this)),this.registerFeature(new Xk.LinkedEditingFeature(this)),this.registerFeature(new Yi.DidCreateFilesFeature(this)),this.registerFeature(new Yi.DidRenameFilesFeature(this)),this.registerFeature(new Yi.DidDeleteFilesFeature(this)),this.registerFeature(new Yi.WillCreateFilesFeature(this)),this.registerFeature(new Yi.WillRenameFilesFeature(this)),this.registerFeature(new Yi.WillDeleteFilesFeature(this))}};ui.CommonLanguageClient=gf;var kb;(function(r){function e(t){return[]}r.createAll=e})(kb=ui.ProposedFeatures||(ui.ProposedFeatures={}))});var Pb=B(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.terminate=void 0;var Tb=require("child_process"),Qk=require("path"),Zk=process.platform==="win32",Jk=process.platform==="darwin",eT=process.platform==="linux";function tT(r,e){if(Zk)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Tb.execFileSync("taskkill",["/T","/F","/PID",r.pid.toString()],i),!0}catch{return!1}else if(eT||Jk)try{var t=Qk.join(__dirname,"terminateProcess.sh"),n=Tb.spawnSync(t,[r.pid.toString()]);return!n.error}catch{return!1}else return r.kill("SIGKILL"),!0}Qa.terminate=tT});var _f=B((g1,Ib)=>{"use strict";Ib.exports=pt()});var Db=B(gr=>{"use strict";var nT=gr&&gr.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bf=gr&&gr.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&nT(e,r,t)};Object.defineProperty(gr,"__esModule",{value:!0});bf(pt(),gr);bf(bn(),gr);bf(mf(),gr)});var kf=B(cn=>{"use strict";var rT=cn&&cn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Nb=cn&&cn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&rT(e,r,t)};Object.defineProperty(cn,"__esModule",{value:!0});cn.SettingMonitor=cn.LanguageClient=cn.TransportKind=void 0;var li=require("child_process"),vf=require("fs"),yf=require("path"),Ob=mm(),Or=require("vscode"),xt=Cr(),iT=mf(),sT=bn(),oT=Pb(),Ct=_f();Nb(_f(),cn);Nb(Db(),cn);var Ab="^1.52.0",wf;(function(r){function e(t){return xt.string(t.command)}r.is=e})(wf||(wf={}));var Bt;(function(r){r[r.stdio=0]="stdio",r[r.ipc=1]="ipc",r[r.pipe=2]="pipe",r[r.socket=3]="socket"})(Bt=cn.TransportKind||(cn.TransportKind={}));var Xi;(function(r){function e(t){let n=t;return n&&n.kind===Bt.socket&&xt.number(n.port)}r.isSocket=e})(Xi||(Xi={}));var Rf;(function(r){function e(t){return xt.string(t.module)}r.is=e})(Rf||(Rf={}));var Sf;(function(r){function e(t){let n=t;return n&&n.writer!==void 0&&n.reader!==void 0}r.is=e})(Sf||(Sf={}));var Cf;(function(r){function e(t){let n=t;return n&&n.process!==void 0&&typeof n.detached=="boolean"}r.is=e})(Cf||(Cf={}));var xf=class extends iT.CommonLanguageClient{constructor(e,t,n,i,s){let o,a,c,u,h;xt.string(t)?(o=e,a=t,c=n,u=i,h=!!s):(o=e.toLowerCase(),a=e,c=t,u=n,h=i),h===void 0&&(h=!1),super(o,a,u),this._serverOptions=c,this._forceDebug=h;try{this.checkVersion()}catch(v){throw xt.string(v.message)&&this.outputChannel.appendLine(v.message),v}}checkVersion(){let e=Ob.parse(Or.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${Or.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!Ob.satisfies(e,Ab))throw new Error(`The language client requires VS Code version ${Ab} but received version ${Or.version}`)}stop(){return super.stop().then(()=>{if(this._serverProcess){let e=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(e),this._isDetached=void 0}})}checkProcessDied(e){e&&setTimeout(()=>{try{process.kill(e.pid,0),oT.terminate(e)}catch{}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(h,v){if(!h&&!v)return;let m=Object.create(null);return Object.keys(process.env).forEach(b=>m[b]=process.env[b]),v&&(m.ELECTRON_RUN_AS_NODE="1",m.ELECTRON_NO_ASAR="1"),h&&Object.keys(h).forEach(b=>m[b]=h[b]),m}let n=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let h=process.execArgv;return h?h.some(v=>n.some(m=>v.startsWith(m))||i.some(m=>v===m)):!1}function o(h){if(h.stdin===null||h.stdout===null||h.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(xt.func(a))return a().then(h=>{if(sT.MessageTransports.is(h))return this._isDetached=!!h.detached,h;if(Sf.is(h))return this._isDetached=!!h.detached,{reader:new Ct.StreamMessageReader(h.reader),writer:new Ct.StreamMessageWriter(h.writer)};{let v;return Cf.is(h)?(v=h.process,this._isDetached=h.detached):(v=h,this._isDetached=!1),v.stderr.on("data",m=>this.outputChannel.append(xt.string(m)?m:m.toString(e))),{reader:new Ct.StreamMessageReader(v.stdout),writer:new Ct.StreamMessageWriter(v.stdin)}}});let c,u=a;return u.run||u.debug?this._forceDebug||s()?c=u.debug:c=u.run:c=a,this._getServerWorkingDir(c.options).then(h=>{if(Rf.is(c)&&c.module){let v=c,m=v.transport||Bt.stdio;if(v.runtime){let b=[],k=v.options||Object.create(null);k.execArgv&&k.execArgv.forEach(S=>b.push(S)),b.push(v.module),v.args&&v.args.forEach(S=>b.push(S));let f=Object.create(null);f.cwd=h,f.env=t(k.env,!1);let _=this._getRuntimePath(v.runtime,h),w;if(m===Bt.ipc?(f.stdio=[null,null,null,"ipc"],b.push("--node-ipc")):m===Bt.stdio?b.push("--stdio"):m===Bt.pipe?(w=Ct.generateRandomPipeName(),b.push(`--pipe=${w}`)):Xi.isSocket(m)&&b.push(`--socket=${m.port}`),b.push(`--clientProcessId=${process.pid.toString()}`),m===Bt.ipc||m===Bt.stdio){let S=li.spawn(_,b,f);return!S||!S.pid?Promise.reject(`Launching server using runtime ${_} failed.`):(this._serverProcess=S,S.stderr.on("data",y=>this.outputChannel.append(xt.string(y)?y:y.toString(e))),m===Bt.ipc?(S.stdout.on("data",y=>this.outputChannel.append(xt.string(y)?y:y.toString(e))),Promise.resolve({reader:new Ct.IPCMessageReader(S),writer:new Ct.IPCMessageWriter(S)})):Promise.resolve({reader:new Ct.StreamMessageReader(S.stdout),writer:new Ct.StreamMessageWriter(S.stdin)}))}else{if(m===Bt.pipe)return Ct.createClientPipeTransport(w).then(S=>{let y=li.spawn(_,b,f);return!y||!y.pid?Promise.reject(`Launching server using runtime ${_} failed.`):(this._serverProcess=y,y.stderr.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),y.stdout.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),S.onConnected().then(l=>({reader:l[0],writer:l[1]})))});if(Xi.isSocket(m))return Ct.createClientSocketTransport(m.port).then(S=>{let y=li.spawn(_,b,f);return!y||!y.pid?Promise.reject(`Launching server using runtime ${_} failed.`):(this._serverProcess=y,y.stderr.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),y.stdout.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),S.onConnected().then(l=>({reader:l[0],writer:l[1]})))})}}else{let b;return new Promise((k,f)=>{let _=v.args&&v.args.slice()||[];m===Bt.ipc?_.push("--node-ipc"):m===Bt.stdio?_.push("--stdio"):m===Bt.pipe?(b=Ct.generateRandomPipeName(),_.push(`--pipe=${b}`)):Xi.isSocket(m)&&_.push(`--socket=${m.port}`),_.push(`--clientProcessId=${process.pid.toString()}`);let w=v.options||Object.create(null);if(w.env=t(w.env,!0),w.execArgv=w.execArgv||[],w.cwd=h,w.silent=!0,m===Bt.ipc||m===Bt.stdio){let S=li.fork(v.module,_||[],w);o(S),this._serverProcess=S,S.stderr.on("data",y=>this.outputChannel.append(xt.string(y)?y:y.toString(e))),m===Bt.ipc?(S.stdout.on("data",y=>this.outputChannel.append(xt.string(y)?y:y.toString(e))),k({reader:new Ct.IPCMessageReader(this._serverProcess),writer:new Ct.IPCMessageWriter(this._serverProcess)})):k({reader:new Ct.StreamMessageReader(S.stdout),writer:new Ct.StreamMessageWriter(S.stdin)})}else m===Bt.pipe?Ct.createClientPipeTransport(b).then(S=>{let y=li.fork(v.module,_||[],w);o(y),this._serverProcess=y,y.stderr.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),y.stdout.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),S.onConnected().then(l=>{k({reader:l[0],writer:l[1]})})}):Xi.isSocket(m)&&Ct.createClientSocketTransport(m.port).then(S=>{let y=li.fork(v.module,_||[],w);o(y),this._serverProcess=y,y.stderr.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),y.stdout.on("data",l=>this.outputChannel.append(xt.string(l)?l:l.toString(e))),S.onConnected().then(l=>{k({reader:l[0],writer:l[1]})})})})}}else if(wf.is(c)&&c.command){let v=c,m=v.args||[],b=Object.assign({},v.options);b.cwd=b.cwd||h;let k=li.spawn(v.command,m,b);return!k||!k.pid?Promise.reject(`Launching server using command ${v.command} failed.`):(k.stderr.on("data",f=>this.outputChannel.append(xt.string(f)?f:f.toString(e))),this._serverProcess=k,this._isDetached=!!b.detached,Promise.resolve({reader:new Ct.StreamMessageReader(k.stdout),writer:new Ct.StreamMessageWriter(k.stdin)}))}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(yf.isAbsolute(e))return e;let n=this._mainGetRootPath();if(n!==void 0){let i=yf.join(n,e);if(vf.existsSync(i))return i}if(t!==void 0){let i=yf.join(t,e);if(vf.existsSync(i))return i}return e}_mainGetRootPath(){let e=Or.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(n=>{vf.lstat(t,(i,s)=>{n(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}getLocale(){let e=process.env.VSCODE_NLS_CONFIG;if(e===void 0)return"en";let t;try{t=JSON.parse(e)}catch{}return t===void 0||typeof t.locale!="string"?"en":t.locale}};cn.LanguageClient=xf;var Ef=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return Or.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new Or.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,n=e>=0?this._setting.substr(e+1):void 0,i=n?Or.workspace.getConfiguration(t).get(n,!1):Or.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start():!i&&this._client.needsStop()&&this._client.stop()}};cn.SettingMonitor=Ef});var Lb=B((b1,Za)=>{var aT=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};var he=function(r){var e=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,t=0,n={},i={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function f(_){return _ instanceof s?new s(_.type,f(_.content),_.alias):Array.isArray(_)?_.map(f):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(f){return Object.prototype.toString.call(f).slice(8,-1)},objId:function(f){return f.__id||Object.defineProperty(f,"__id",{value:++t}),f.__id},clone:function f(_,w){w=w||{};var S,y;switch(i.util.type(_)){case"Object":if(y=i.util.objId(_),w[y])return w[y];S={},w[y]=S;for(var l in _)_.hasOwnProperty(l)&&(S[l]=f(_[l],w));return S;case"Array":return y=i.util.objId(_),w[y]?w[y]:(S=[],w[y]=S,_.forEach(function(x,E){S[E]=f(x,w)}),S);default:return _}},getLanguage:function(f){for(;f;){var _=e.exec(f.className);if(_)return _[1].toLowerCase();f=f.parentElement}return"none"},setLanguage:function(f,_){f.className=f.className.replace(RegExp(e,"gi"),""),f.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(S){var f=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(S.stack)||[])[1];if(f){var _=document.getElementsByTagName("script");for(var w in _)if(_[w].src==f)return _[w]}return null}},isActive:function(f,_,w){for(var S="no-"+_;f;){var y=f.classList;if(y.contains(_))return!0;if(y.contains(S))return!1;f=f.parentElement}return!!w}},languages:{plain:n,plaintext:n,text:n,txt:n,extend:function(f,_){var w=i.util.clone(i.languages[f]);for(var S in _)w[S]=_[S];return w},insertBefore:function(f,_,w,S){S=S||i.languages;var y=S[f],l={};for(var x in y)if(y.hasOwnProperty(x)){if(x==_)for(var E in w)w.hasOwnProperty(E)&&(l[E]=w[E]);w.hasOwnProperty(x)||(l[x]=y[x])}var C=S[f];return S[f]=l,i.languages.DFS(i.languages,function(T,D){D===C&&T!=f&&(this[T]=l)}),l},DFS:function f(_,w,S,y){y=y||{};var l=i.util.objId;for(var x in _)if(_.hasOwnProperty(x)){w.call(_,x,_[x],S||x);var E=_[x],C=i.util.type(E);C==="Object"&&!y[l(E)]?(y[l(E)]=!0,f(E,w,null,y)):C==="Array"&&!y[l(E)]&&(y[l(E)]=!0,f(E,w,x,y))}}},plugins:{},highlightAll:function(f,_){i.highlightAllUnder(document,f,_)},highlightAllUnder:function(f,_,w){var S={callback:w,container:f,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",S),S.elements=Array.prototype.slice.apply(S.container.querySelectorAll(S.selector)),i.hooks.run("before-all-elements-highlight",S);for(var y=0,l;l=S.elements[y++];)i.highlightElement(l,_===!0,S.callback)},highlightElement:function(f,_,w){var S=i.util.getLanguage(f),y=i.languages[S];i.util.setLanguage(f,S);var l=f.parentElement;l&&l.nodeName.toLowerCase()==="pre"&&i.util.setLanguage(l,S);var x=f.textContent,E={element:f,language:S,grammar:y,code:x};function C(D){E.highlightedCode=D,i.hooks.run("before-insert",E),E.element.innerHTML=E.highlightedCode,i.hooks.run("after-highlight",E),i.hooks.run("complete",E),w&&w.call(E.element)}if(i.hooks.run("before-sanity-check",E),l=E.element.parentElement,l&&l.nodeName.toLowerCase()==="pre"&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!E.code){i.hooks.run("complete",E),w&&w.call(E.element);return}if(i.hooks.run("before-highlight",E),!E.grammar){C(i.util.encode(E.code));return}if(_&&r.Worker){var T=new Worker(i.filename);T.onmessage=function(D){C(D.data)},T.postMessage(JSON.stringify({language:E.language,code:E.code,immediateClose:!0}))}else C(i.highlight(E.code,E.grammar,E.language))},highlight:function(f,_,w){var S={code:f,grammar:_,language:w};if(i.hooks.run("before-tokenize",S),!S.grammar)throw new Error('The language "'+S.language+'" has no grammar.');return S.tokens=i.tokenize(S.code,S.grammar),i.hooks.run("after-tokenize",S),s.stringify(i.util.encode(S.tokens),S.language)},tokenize:function(f,_){var w=_.rest;if(w){for(var S in w)_[S]=w[S];delete _.rest}var y=new c;return u(y,y.head,f),a(f,y,_,y.head,0),v(y)},hooks:{all:{},add:function(f,_){var w=i.hooks.all;w[f]=w[f]||[],w[f].push(_)},run:function(f,_){var w=i.hooks.all[f];if(!(!w||!w.length))for(var S=0,y;y=w[S++];)y(_)}},Token:s};r.Prism=i;function s(f,_,w,S){this.type=f,this.content=_,this.alias=w,this.length=(S||"").length|0}s.stringify=function f(_,w){if(typeof _=="string")return _;if(Array.isArray(_)){var S="";return _.forEach(function(C){S+=f(C,w)}),S}var y={type:_.type,content:f(_.content,w),tag:"span",classes:["token",_.type],attributes:{},language:w},l=_.alias;l&&(Array.isArray(l)?Array.prototype.push.apply(y.classes,l):y.classes.push(l)),i.hooks.run("wrap",y);var x="";for(var E in y.attributes)x+=" "+E+'="'+(y.attributes[E]||"").replace(/"/g,"&quot;")+'"';return"<"+y.tag+' class="'+y.classes.join(" ")+'"'+x+">"+y.content+"</"+y.tag+">"};function o(f,_,w,S){f.lastIndex=_;var y=f.exec(w);if(y&&S&&y[1]){var l=y[1].length;y.index+=l,y[0]=y[0].slice(l)}return y}function a(f,_,w,S,y,l){for(var x in w)if(!(!w.hasOwnProperty(x)||!w[x])){var E=w[x];E=Array.isArray(E)?E:[E];for(var C=0;C<E.length;++C){if(l&&l.cause==x+","+C)return;var T=E[C],D=T.inside,F=!!T.lookbehind,z=!!T.greedy,H=T.alias;if(z&&!T.pattern.global){var Q=T.pattern.toString().match(/[imsuy]*$/)[0];T.pattern=RegExp(T.pattern.source,Q+"g")}for(var J=T.pattern||T,ie=S.next,be=y;ie!==_.tail&&!(l&&be>=l.reach);be+=ie.value.length,ie=ie.next){var ee=ie.value;if(_.length>f.length)return;if(!(ee instanceof s)){var Ae=1,ae;if(z){if(ae=o(J,be,f,F),!ae||ae.index>=f.length)break;var De=ae.index,Ee=ae.index+ae[0].length,ge=be;for(ge+=ie.value.length;De>=ge;)ie=ie.next,ge+=ie.value.length;if(ge-=ie.value.length,be=ge,ie.value instanceof s)continue;for(var me=ie;me!==_.tail&&(ge<Ee||typeof me.value=="string");me=me.next)Ae++,ge+=me.value.length;Ae--,ee=f.slice(be,ge),ae.index-=be}else if(ae=o(J,0,ee,F),!ae)continue;var De=ae.index,Je=ae[0],W=ee.slice(0,De),je=ee.slice(De+Je.length),ke=be+ee.length;l&&ke>l.reach&&(l.reach=ke);var Qe=ie.prev;W&&(Qe=u(_,Qe,W),be+=W.length),h(_,Qe,Ae);var Et=new s(x,D?i.tokenize(Je,D):Je,H,Je);if(ie=u(_,Qe,Et),je&&u(_,ie,je),Ae>1){var rt={cause:x+","+C,reach:ke};a(f,_,w,ie.prev,be,rt),l&&rt.reach>l.reach&&(l.reach=rt.reach)}}}}}}function c(){var f={value:null,prev:null,next:null},_={value:null,prev:f,next:null};f.next=_,this.head=f,this.tail=_,this.length=0}function u(f,_,w){var S=_.next,y={value:w,prev:_,next:S};return _.next=y,S.prev=y,f.length++,y}function h(f,_,w){for(var S=_.next,y=0;y<w&&S!==f.tail;y++)S=S.next;_.next=S,S.prev=_,f.length-=y}function v(f){for(var _=[],w=f.head.next;w!==f.tail;)_.push(w.value),w=w.next;return _}if(!r.document)return r.addEventListener&&(i.disableWorkerMessageHandler||r.addEventListener("message",function(f){var _=JSON.parse(f.data),w=_.language,S=_.code,y=_.immediateClose;r.postMessage(i.highlight(S,i.languages[w],w)),y&&r.close()},!1)),i;var m=i.util.currentScript();m&&(i.filename=m.src,m.hasAttribute("data-manual")&&(i.manual=!0));function b(){i.manual||i.highlightAll()}if(!i.manual){var k=document.readyState;k==="loading"||k==="interactive"&&m&&m.defer?document.addEventListener("DOMContentLoaded",b):window.requestAnimationFrame?window.requestAnimationFrame(b):window.setTimeout(b,16)}return i}(aT);typeof Za<"u"&&Za.exports&&(Za.exports=he);typeof global<"u"&&(global.Prism=he);he.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};he.languages.markup.tag.inside["attr-value"].inside.entity=he.languages.markup.entity;he.languages.markup.doctype.inside["internal-subset"].inside=he.languages.markup;he.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))});Object.defineProperty(he.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:he.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};i["language-"+t]={pattern:/[\s\S]+/,inside:he.languages[t]};var s={};s[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:i},he.languages.insertBefore("markup","cdata",s)}});Object.defineProperty(he.languages.markup.tag,"addAttribute",{value:function(r,e){he.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:he.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});he.languages.html=he.languages.markup;he.languages.mathml=he.languages.markup;he.languages.svg=he.languages.markup;he.languages.xml=he.languages.extend("markup",{});he.languages.ssml=he.languages.xml;he.languages.atom=he.languages.xml;he.languages.rss=he.languages.xml;(function(r){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var t=r.languages.markup;t&&(t.tag.addInlined("style","css"),t.tag.addAttribute("style","css"))})(he);he.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};he.languages.javascript=he.languages.extend("clike",{"class-name":[he.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});he.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;he.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:he.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:he.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:he.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:he.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:he.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});he.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:he.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});he.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});he.languages.markup&&(he.languages.markup.tag.addInlined("script","javascript"),he.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));he.languages.js=he.languages.javascript;(function(){if(typeof he>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading\u2026",e=function(m,b){return"\u2716 Error "+m+" while fetching file: "+b},t="\u2716 Error: File does not exist or is empty",n={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},i="data-src-status",s="loading",o="loaded",a="failed",c="pre[data-src]:not(["+i+'="'+o+'"]):not(['+i+'="'+s+'"])';function u(m,b,k){var f=new XMLHttpRequest;f.open("GET",m,!0),f.onreadystatechange=function(){f.readyState==4&&(f.status<400&&f.responseText?b(f.responseText):f.status>=400?k(e(f.status,f.statusText)):k(t))},f.send(null)}function h(m){var b=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(m||"");if(b){var k=Number(b[1]),f=b[2],_=b[3];return f?_?[k,Number(_)]:[k,void 0]:[k,k]}}he.hooks.add("before-highlightall",function(m){m.selector+=", "+c}),he.hooks.add("before-sanity-check",function(m){var b=m.element;if(b.matches(c)){m.code="",b.setAttribute(i,s);var k=b.appendChild(document.createElement("CODE"));k.textContent=r;var f=b.getAttribute("data-src"),_=m.language;if(_==="none"){var w=(/\.(\w+)$/.exec(f)||[,"none"])[1];_=n[w]||w}he.util.setLanguage(k,_),he.util.setLanguage(b,_);var S=he.plugins.autoloader;S&&S.loadLanguages(_),u(f,function(y){b.setAttribute(i,o);var l=h(b.getAttribute("data-range"));if(l){var x=y.split(/\r\n?|\n/g),E=l[0],C=l[1]==null?x.length:l[1];E<0&&(E+=x.length),E=Math.max(0,Math.min(E-1,x.length)),C<0&&(C+=x.length),C=Math.max(0,Math.min(C,x.length)),y=x.slice(E,C).join(`
`),b.hasAttribute("data-start")||b.setAttribute("data-start",String(E+1))}k.textContent=y,he.highlightElement(k)},function(y){b.setAttribute(i,a),k.textContent=y})}}),he.plugins.fileHighlight={highlight:function(b){for(var k=(b||document).querySelectorAll(c),f=0,_;_=k[f++];)he.highlightElement(_)}};var v=!1;he.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),he.plugins.fileHighlight.highlight.apply(this,arguments)}})()});var qb=B(()=>{(function(r){function e(ae,Ee){return ae.replace(/<<(\d+)>>/g,function(ge,me){return"(?:"+Ee[+me]+")"})}function t(ae,Ee,ge){return RegExp(e(ae,Ee),ge||"")}function n(ae,Ee){for(var ge=0;ge<Ee;ge++)ae=ae.replace(/<<self>>/g,function(){return"(?:"+ae+")"});return ae.replace(/<<self>>/g,"[^\\s\\S]")}var i={type:"bool byte char decimal double dynamic float int long object sbyte short string uint ulong ushort var void",typeDeclaration:"class enum interface record struct",contextual:"add alias and ascending async await by descending from(?=\\s*(?:\\w|$)) get global group into init(?=\\s*;) join let nameof not notnull on or orderby partial remove select set unmanaged value when where with(?=\\s*{)",other:"abstract as base break case catch checked const continue default delegate do else event explicit extern finally fixed for foreach goto if implicit in internal is lock namespace new null operator out override params private protected public readonly ref return sealed sizeof stackalloc static switch this throw try typeof unchecked unsafe using virtual volatile while yield"};function s(ae){return"\\b(?:"+ae.trim().replace(/ /g,"|")+")\\b"}var o=s(i.typeDeclaration),a=RegExp(s(i.type+" "+i.typeDeclaration+" "+i.contextual+" "+i.other)),c=s(i.typeDeclaration+" "+i.contextual+" "+i.other),u=s(i.type+" "+i.typeDeclaration+" "+i.other),h=n(/<(?:[^<>;=+\-*/%&|^]|<<self>>)*>/.source,2),v=n(/\((?:[^()]|<<self>>)*\)/.source,2),m=/@?\b[A-Za-z_]\w*\b/.source,b=e(/<<0>>(?:\s*<<1>>)?/.source,[m,h]),k=e(/(?!<<0>>)<<1>>(?:\s*\.\s*<<1>>)*/.source,[c,b]),f=/\[\s*(?:,\s*)*\]/.source,_=e(/<<0>>(?:\s*(?:\?\s*)?<<1>>)*(?:\s*\?)?/.source,[k,f]),w=e(/[^,()<>[\];=+\-*/%&|^]|<<0>>|<<1>>|<<2>>/.source,[h,v,f]),S=e(/\(<<0>>+(?:,<<0>>+)+\)/.source,[w]),y=e(/(?:<<0>>|<<1>>)(?:\s*(?:\?\s*)?<<2>>)*(?:\s*\?)?/.source,[S,k,f]),l={keyword:a,punctuation:/[<>()?,.:[\]]/},x=/'(?:[^\r\n'\\]|\\.|\\[Uux][\da-fA-F]{1,8})'/.source,E=/"(?:\\.|[^\\"\r\n])*"/.source,C=/@"(?:""|\\[\s\S]|[^\\"])*"(?!")/.source;r.languages.csharp=r.languages.extend("clike",{string:[{pattern:t(/(^|[^$\\])<<0>>/.source,[C]),lookbehind:!0,greedy:!0},{pattern:t(/(^|[^@$\\])<<0>>/.source,[E]),lookbehind:!0,greedy:!0}],"class-name":[{pattern:t(/(\busing\s+static\s+)<<0>>(?=\s*;)/.source,[k]),lookbehind:!0,inside:l},{pattern:t(/(\busing\s+<<0>>\s*=\s*)<<1>>(?=\s*;)/.source,[m,y]),lookbehind:!0,inside:l},{pattern:t(/(\busing\s+)<<0>>(?=\s*=)/.source,[m]),lookbehind:!0},{pattern:t(/(\b<<0>>\s+)<<1>>/.source,[o,b]),lookbehind:!0,inside:l},{pattern:t(/(\bcatch\s*\(\s*)<<0>>/.source,[k]),lookbehind:!0,inside:l},{pattern:t(/(\bwhere\s+)<<0>>/.source,[m]),lookbehind:!0},{pattern:t(/(\b(?:is(?:\s+not)?|as)\s+)<<0>>/.source,[_]),lookbehind:!0,inside:l},{pattern:t(/\b<<0>>(?=\s+(?!<<1>>|with\s*\{)<<2>>(?:\s*[=,;:{)\]]|\s+(?:in|when)\b))/.source,[y,u,m]),inside:l}],keyword:a,number:/(?:\b0(?:x[\da-f_]*[\da-f]|b[01_]*[01])|(?:\B\.\d+(?:_+\d+)*|\b\d+(?:_+\d+)*(?:\.\d+(?:_+\d+)*)?)(?:e[-+]?\d+(?:_+\d+)*)?)(?:[dflmu]|lu|ul)?\b/i,operator:/>>=?|<<=?|[-=]>|([-+&|])\1|~|\?\?=?|[-+*/%&|^!=<>]=?/,punctuation:/\?\.?|::|[{}[\];(),.:]/}),r.languages.insertBefore("csharp","number",{range:{pattern:/\.\./,alias:"operator"}}),r.languages.insertBefore("csharp","punctuation",{"named-parameter":{pattern:t(/([(,]\s*)<<0>>(?=\s*:)/.source,[m]),lookbehind:!0,alias:"punctuation"}}),r.languages.insertBefore("csharp","class-name",{namespace:{pattern:t(/(\b(?:namespace|using)\s+)<<0>>(?:\s*\.\s*<<0>>)*(?=\s*[;{])/.source,[m]),lookbehind:!0,inside:{punctuation:/\./}},"type-expression":{pattern:t(/(\b(?:default|sizeof|typeof)\s*\(\s*(?!\s))(?:[^()\s]|\s(?!\s)|<<0>>)*(?=\s*\))/.source,[v]),lookbehind:!0,alias:"class-name",inside:l},"return-type":{pattern:t(/<<0>>(?=\s+(?:<<1>>\s*(?:=>|[({]|\.\s*this\s*\[)|this\s*\[))/.source,[y,k]),inside:l,alias:"class-name"},"constructor-invocation":{pattern:t(/(\bnew\s+)<<0>>(?=\s*[[({])/.source,[y]),lookbehind:!0,inside:l,alias:"class-name"},"generic-method":{pattern:t(/<<0>>\s*<<1>>(?=\s*\()/.source,[m,h]),inside:{function:t(/^<<0>>/.source,[m]),generic:{pattern:RegExp(h),alias:"class-name",inside:l}}},"type-list":{pattern:t(/\b((?:<<0>>\s+<<1>>|record\s+<<1>>\s*<<5>>|where\s+<<2>>)\s*:\s*)(?:<<3>>|<<4>>|<<1>>\s*<<5>>|<<6>>)(?:\s*,\s*(?:<<3>>|<<4>>|<<6>>))*(?=\s*(?:where|[{;]|=>|$))/.source,[o,b,m,y,a.source,v,/\bnew\s*\(\s*\)/.source]),lookbehind:!0,inside:{"record-arguments":{pattern:t(/(^(?!new\s*\()<<0>>\s*)<<1>>/.source,[b,v]),lookbehind:!0,greedy:!0,inside:r.languages.csharp},keyword:a,"class-name":{pattern:RegExp(y),greedy:!0,inside:l},punctuation:/[,()]/}},preprocessor:{pattern:/(^[\t ]*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(#)\b(?:define|elif|else|endif|endregion|error|if|line|nullable|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}});var T=E+"|"+x,D=e(/\/(?![*/])|\/\/[^\r\n]*[\r\n]|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>/.source,[T]),F=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[D]),2),z=/\b(?:assembly|event|field|method|module|param|property|return|type)\b/.source,H=e(/<<0>>(?:\s*\(<<1>>*\))?/.source,[k,F]);r.languages.insertBefore("csharp","class-name",{attribute:{pattern:t(/((?:^|[^\s\w>)?])\s*\[\s*)(?:<<0>>\s*:\s*)?<<1>>(?:\s*,\s*<<1>>)*(?=\s*\])/.source,[z,H]),lookbehind:!0,greedy:!0,inside:{target:{pattern:t(/^<<0>>(?=\s*:)/.source,[z]),alias:"keyword"},"attribute-arguments":{pattern:t(/\(<<0>>*\)/.source,[F]),inside:r.languages.csharp},"class-name":{pattern:RegExp(k),inside:{punctuation:/\./}},punctuation:/[:,]/}}});var Q=/:[^}\r\n]+/.source,J=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[D]),2),ie=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[J,Q]),be=n(e(/[^"'/()]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>|\(<<self>>*\)/.source,[T]),2),ee=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[be,Q]);function Ae(ae,Ee){return{interpolation:{pattern:t(/((?:^|[^{])(?:\{\{)*)<<0>>/.source,[ae]),lookbehind:!0,inside:{"format-string":{pattern:t(/(^\{(?:(?![}:])<<0>>)*)<<1>>(?=\}$)/.source,[Ee,Q]),lookbehind:!0,inside:{punctuation:/^:/}},punctuation:/^\{|\}$/,expression:{pattern:/[\s\S]+/,alias:"language-csharp",inside:r.languages.csharp}}},string:/[\s\S]+/}}r.languages.insertBefore("csharp","string",{"interpolation-string":[{pattern:t(/(^|[^\\])(?:\$@|@\$)"(?:""|\\[\s\S]|\{\{|<<0>>|[^\\{"])*"/.source,[ie]),lookbehind:!0,greedy:!0,inside:Ae(ie,J)},{pattern:t(/(^|[^@\\])\$"(?:\\.|\{\{|<<0>>|[^\\"{])*"/.source,[ee]),lookbehind:!0,greedy:!0,inside:Ae(ee,be)}],char:{pattern:RegExp(x),greedy:!0}}),r.languages.dotnet=r.languages.cs=r.languages.csharp})(Prism)});var Hb=B((P1,Wb)=>{"use strict";var Tf=class{tags={url:{type:"replace",open:e=>`<a href="${e||"#"}">`,close:"</a>"},quote:{type:"replace",open:e=>`<blockquote author="${e||""}">`,close:"</blockquote>"},b:{type:"replace",open:"<strong>",close:"</strong>"},u:{type:"replace",open:"<u>",close:"</u>"},i:{type:"replace",open:"<i>",close:"</i>"},h1:{type:"replace",open:"<h1>",close:"</h1>"},h2:{type:"replace",open:"<h2>",close:"</h2>"},h3:{type:"replace",open:"<h3>",close:"</h3>"},h4:{type:"replace",open:"<h4>",close:"</h4>"},h5:{type:"replace",open:"<h5>",close:"</h5>"},h6:{type:"replace",open:"<h6>",close:"</h6>"},code:{type:"replace",open:"<code>",close:"</code>"},strike:{type:"replace",open:'<span class="yabbcode-strike">',close:"</span>"},spoiler:{type:"replace",open:'<span class="yabbcode-spoiler">',close:"</span>"},list:{type:"replace",open:"<ul>",close:"</ul>"},olist:{type:"replace",open:"<ol>",close:"</ol>"},"*":{type:"replace",open:"<li>",close:null},img:{type:"content",replace:(e,t)=>t?`<img src="${t}" alt="${e||""}"/>`:""},noparse:{type:"ignore"}};regex={tags:/(\[[^\]^]+])/g,newline:/\r\n|\r|\n/g,placeholders:/\[TAG-[1-9]+]/g};contentModules={replace:(e,t,n)=>{let i=t.open,s=t.close;return typeof i=="function"&&(i=i(e.attr)),typeof s=="function"&&(s=s(e.attr)),i&&!e.isClosing&&(n=n.replace("[TAG-"+e.index+"]",i)),s&&e.closing&&(n=n.replace("[TAG-"+e.closing.index+"]",s)),n},content:(e,t,n)=>{if(!e.closing)return n;let i="[TAG-"+e.index+"]",s="[TAG-"+e.closing.index+"]",o=n.indexOf(i),a=n.indexOf(s),c=t.replace,u=n.slice(o+i.length,a);typeof c=="function"&&(c=c(e.attr,u));let h=n.slice(0,Math.max(0,o)),v=n.slice(a+s.length);return h+c+v},ignore:(e,t,n)=>{let i="[TAG-"+e.index+"]",s=n.indexOf(i),o="",a=n.length;e.closing&&(o="[TAG-"+e.closing.index+"]",a=n.indexOf(o));let c=n.slice(s+i.length,a);c=this.#e(e.children,c);let u=n.slice(0,Math.max(0,s)),h=n.slice(a+o.length);return u+c+h}};constructor(e={}){this.config={newline:!0,paragraph:!1,cleanUnmatchable:!0,sanitizeHtml:!0},e.newline!==void 0&&(this.config.newline=e.newline),e.paragraph!==void 0&&(this.config.paragraph=e.paragraph),e.cleanUnmatchable!==void 0&&(this.config.cleanUnmatchable=e.cleanUnmatchable),e.sanitizeHtml!==void 0&&(this.config.sanitizeHtml=e.sanitizeHtml)}#e=function(e,t){for(let n of e)t=t.replace("[TAG-"+n.index+"]",n.raw),n.closing&&(t=t.replace("[TAG-"+n.closing.index+"]",n.closing.raw)),n.children.length>0&&(t=this.#e(n.children,t));return t};#t=function(e,t){for(let n of e){let i=this.tags[n.module];if(i||(i={type:"replace",open:n.raw,close:n.closing&&n.closing.raw||""}),!this.contentModules[i.type])throw new Error("Cannot parse content block. Invalid block type ["+i.type+"] provided for tag ["+n.module+"]");t=this.contentModules[i.type](n,i,t),n.children.length>0&&i.type!=="ignore"&&(t=this.#t(n.children,t))}return t};#n=function(e,t){let n=0;for(;n<e.length;){let i=!1;if(e[n].matchTag!==null||e[n].isClosing){n++;continue}for(let[a,c]of e.entries())i||e[n].matchTag!==null||c.index===e[n].index||c.matchTag!==null||!c.isClosing||e[n].module!==c.module||(e[a].matchTag=e[n].index,e[n].matchTag=c.index,i=a);let s=n+1;i!==!1?e[n].closing=e[e[n].matchTag]:(e[n].matchTag=!1,i=e.length-1),s<i&&(e[n].children=e.slice(s,i).map(a=>(a.parent=e[n].index,a)));let o=s;for(;o<i;)e[o].parent=e[n].index,o++;n++}return e=e.filter(i=>!(t===void 0&&i.parent!==null||i.parent!==null&&i.parent!==t||i.isClosing)),e.map(i=>(i.children.length>0&&(i.children=this.#n(i.children,i.index)),i))};clearTags(){return this.tags={},this}registerTag(e,t){return this.tags[String(e).toLowerCase()]=t,this}parse(e){if(typeof e=="boolean"||typeof e!="string"&&Number.isNaN(Number(e)))return"";let t=String(e).slice(0);this.config.sanitizeHtml&&(t=t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"));let n=[],i=String(t).match(this.regex.tags);if(this.config.newline&&(this.config.paragraph?t=t.replace(this.regex.newline,"</p><p>"):t=t.replace(this.regex.newline,"<br/>")),this.config.paragraph&&(t="<p>"+t+"</p>"),!i||i.length===0)return t;for(let[s,o]of i.entries()){let a=o.slice(1,-1).split("="),c={index:s,module:a[0].toLowerCase(),isClosing:o.slice(1,2)==="/",raw:o,attr:a.slice(1).join("="),closing:null,children:[],parent:null,matchTag:null};c.isClosing&&(c.module=c.module.slice(1)),n.push(c),t=t.replace(o,"[TAG-"+s+"]")}return n=this.#n(n),t=this.#t(n,t),this.config.cleanUnmatchable&&(t=t.replace(this.regex.placeholders,"")),t}};Wb.exports=Tf});var Qb=B((Q1,Xb)=>{"use strict";Xb.exports=kf()});var tv=B((Z1,ev)=>{"use strict";var{Duplex:PT}=require("stream");function Zb(r){r.emit("close")}function IT(){!this.destroyed&&this._writableState.finished&&this.destroy()}function Jb(r){this.removeListener("error",Jb),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function DT(r,e){let t=!0,n=new PT({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(s,o){let a=!o&&n._readableState.objectMode?s.toString():s;n.push(a)||r.pause()}),r.once("error",function(s){n.destroyed||(t=!1,n.destroy(s))}),r.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(i,s){if(r.readyState===r.CLOSED){s(i),process.nextTick(Zb,n);return}let o=!1;r.once("error",function(c){o=!0,s(c)}),r.once("close",function(){o||s(i),process.nextTick(Zb,n)}),t&&r.terminate()},n._final=function(i){if(r.readyState===r.CONNECTING){r.once("open",function(){n._final(i)});return}r._socket!==null&&(r._socket._writableState.finished?(i(),n._readableState.endEmitted&&n.destroy()):(r._socket.once("finish",function(){i()}),r.close()))},n._read=function(){r.isPaused&&r.resume()},n._write=function(i,s,o){if(r.readyState===r.CONNECTING){r.once("open",function(){n._write(i,s,o)});return}r.send(i,o)},n.on("end",IT),n.on("error",Jb),n}ev.exports=DT});var Ar=B((J1,nv)=>{"use strict";nv.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var _o=B((eN,sc)=>{"use strict";var{EMPTY_BUFFER:OT}=Ar(),Of=Buffer[Symbol.species];function AT(r,e){if(r.length===0)return OT;if(r.length===1)return r[0];let t=Buffer.allocUnsafe(e),n=0;for(let i=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return n<e?new Of(t.buffer,t.byteOffset,n):t}function rv(r,e,t,n,i){for(let s=0;s<i;s++)t[n+s]=r[s]^e[s&3]}function iv(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t&3]}function NT(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function Af(r){if(Af.readOnly=!0,Buffer.isBuffer(r))return r;let e;return r instanceof ArrayBuffer?e=new Of(r):ArrayBuffer.isView(r)?e=new Of(r.buffer,r.byteOffset,r.byteLength):(e=Buffer.from(r),Af.readOnly=!1),e}sc.exports={concat:AT,mask:rv,toArrayBuffer:NT,toBuffer:Af,unmask:iv};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=require("bufferutil");sc.exports.mask=function(e,t,n,i,s){s<48?rv(e,t,n,i,s):r.mask(e,t,n,i,s)},sc.exports.unmask=function(e,t){e.length<32?iv(e,t):r.unmask(e,t)}}catch{}});var av=B((tN,ov)=>{"use strict";var sv=Symbol("kDone"),Nf=Symbol("kRun"),Lf=class{constructor(e){this[sv]=()=>{this.pending--,this[Nf]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Nf]()}[Nf](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[sv])}}};ov.exports=Lf});var yo=B((nN,dv)=>{"use strict";var bo=require("zlib"),cv=_o(),LT=av(),{kStatusCode:uv}=Ar(),qT=Buffer[Symbol.species],FT=Buffer.from([0,0,255,255]),cc=Symbol("permessage-deflate"),mr=Symbol("total-length"),vo=Symbol("callback"),Nr=Symbol("buffers"),ac=Symbol("error"),oc,qf=class{constructor(e,t,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!oc){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;oc=new LT(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[vo];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,n=e.find(i=>!(t.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>i.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(n.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?n.client_max_window_bits=t.clientMaxWindowBits:(n.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(n=>{let i=t[n];if(i.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(i=i[0],n==="client_max_window_bits"){if(i!==!0){let s=+i;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=s}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else if(n==="server_max_window_bits"){let s=+i;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=s}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else throw new Error(`Unknown parameter "${n}"`);t[n]=i})}),e}decompress(e,t,n){oc.add(i=>{this._decompress(e,t,(s,o)=>{i(),n(s,o)})})}compress(e,t,n){oc.add(i=>{this._compress(e,t,(s,o)=>{i(),n(s,o)})})}_decompress(e,t,n){let i=this._isServer?"client":"server";if(!this._inflate){let s=`${i}_max_window_bits`,o=typeof this.params[s]!="number"?bo.Z_DEFAULT_WINDOWBITS:this.params[s];this._inflate=bo.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[cc]=this,this._inflate[mr]=0,this._inflate[Nr]=[],this._inflate.on("error",$T),this._inflate.on("data",lv)}this._inflate[vo]=n,this._inflate.write(e),t&&this._inflate.write(FT),this._inflate.flush(()=>{let s=this._inflate[ac];if(s){this._inflate.close(),this._inflate=null,n(s);return}let o=cv.concat(this._inflate[Nr],this._inflate[mr]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[mr]=0,this._inflate[Nr]=[],t&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),n(null,o)})}_compress(e,t,n){let i=this._isServer?"server":"client";if(!this._deflate){let s=`${i}_max_window_bits`,o=typeof this.params[s]!="number"?bo.Z_DEFAULT_WINDOWBITS:this.params[s];this._deflate=bo.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[mr]=0,this._deflate[Nr]=[],this._deflate.on("data",MT)}this._deflate[vo]=n,this._deflate.write(e),this._deflate.flush(bo.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let s=cv.concat(this._deflate[Nr],this._deflate[mr]);t&&(s=new qT(s.buffer,s.byteOffset,s.length-4)),this._deflate[vo]=null,this._deflate[mr]=0,this._deflate[Nr]=[],t&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),n(null,s)})}};dv.exports=qf;function MT(r){this[Nr].push(r),this[mr]+=r.length}function lv(r){if(this[mr]+=r.length,this[cc]._maxPayload<1||this[mr]<=this[cc]._maxPayload){this[Nr].push(r);return}this[ac]=new RangeError("Max payload size exceeded"),this[ac].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[ac][uv]=1009,this.removeListener("data",lv),this.reset()}function $T(r){this[cc]._inflate=null,r[uv]=1007,this[vo](r)}});var wo=B((rN,uc)=>{"use strict";var{isUtf8:fv}=require("buffer"),jT=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function BT(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function Ff(r){let e=r.length,t=0;for(;t<e;)if(!(r[t]&128))t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}uc.exports={isValidStatusCode:BT,isValidUTF8:Ff,tokenChars:jT};if(fv)uc.exports.isValidUTF8=function(r){return r.length<24?Ff(r):fv(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=require("utf-8-validate");uc.exports.isValidUTF8=function(e){return e.length<32?Ff(e):r(e)}}catch{}});var Uf=B((iN,yv)=>{"use strict";var{Writable:UT}=require("stream"),hv=yo(),{BINARY_TYPES:zT,EMPTY_BUFFER:pv,kStatusCode:GT,kWebSocket:VT}=Ar(),{concat:Mf,toArrayBuffer:WT,unmask:HT}=_o(),{isValidStatusCode:KT,isValidUTF8:gv}=wo(),lc=Buffer[Symbol.species],YT=Promise.resolve(),XT=typeof queueMicrotask=="function"?queueMicrotask:QT,es=0,mv=1,_v=2,bv=3,$f=4,vv=5,jf=6,Bf=class extends UT{constructor(e={}){super(),this._binaryType=e.binaryType||zT[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[VT]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=es,this._loop=!1}_write(e,t,n){if(this._opcode===8&&this._state==es)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new lc(n.buffer,n.byteOffset+e,n.length-e),new lc(n.buffer,n.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let n=this._buffers[0],i=t.length-e;e>=n.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new lc(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do switch(this._state){case es:t=this.getInfo();break;case mv:t=this.getPayloadLength16();break;case _v:t=this.getPayloadLength64();break;case bv:this.getMask();break;case $f:t=this.getData(e);break;case vv:this._loop=!1;return;default:this._loop=!1,XT(()=>{this._state=es,this.startLoop(e)});return}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if(e[0]&48)return this._loop=!1,Lt(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let t=(e[0]&64)===64;if(t&&!this._extensions[hv.extensionName])return this._loop=!1,Lt(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(e[0]&128)===128,this._opcode=e[0]&15,this._payloadLength=e[1]&127,this._opcode===0){if(t)return this._loop=!1,Lt(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,Lt(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,Lt(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,Lt(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,Lt(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1)return this._loop=!1,Lt(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,Lt(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(e[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,Lt(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,Lt(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=mv;else if(this._payloadLength===127)this._state=_v;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,53-32)-1?(this._loop=!1,Lt(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,Lt(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=bv:this._state=$f}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=$f}getData(e){let t=pv;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&HT(t,this._mask)}if(this._opcode>7)return this.controlMessage(t);if(this._compressed){this._state=vv,this.decompress(t,e);return}return t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage()}decompress(e,t){this._extensions[hv.extensionName].decompress(e,this._fin,(i,s)=>{if(i)return t(i);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(Lt(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(s)}let o=this.dataMessage();if(o)return t(o);this.startLoop(t)})}dataMessage(){if(this._fin){let e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let n;this._binaryType==="nodebuffer"?n=Mf(t,e):this._binaryType==="arraybuffer"?n=WT(Mf(t,e)):n=t,this.emit("message",n,!0)}else{let n=Mf(t,e);if(!this._skipUTF8Validation&&!gv(n))return this._loop=!1,Lt(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n,!1)}}this._state=jf}controlMessage(e){if(this._opcode===8)if(this._loop=!1,e.length===0)this.emit("conclude",1005,pv),this.end(),this._state=es;else{let t=e.readUInt16BE(0);if(!KT(t))return Lt(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let n=new lc(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!gv(n))return Lt(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,n),this.end(),this._state=es}else this._opcode===9?(this.emit("ping",e),this._state=jf):(this.emit("pong",e),this._state=jf)}};yv.exports=Bf;function Lt(r,e,t,n,i){let s=new r(t?`Invalid WebSocket frame: ${e}`:e);return Error.captureStackTrace(s,Lt),s.code=i,s[GT]=n,s}function QT(r){YT.then(r).catch(JT)}function ZT(r){throw r}function JT(r){process.nextTick(ZT,r)}});var zf=B((oN,Sv)=>{"use strict";var{Duplex:sN}=require("stream"),{randomFillSync:eP}=require("crypto"),wv=yo(),{EMPTY_BUFFER:tP}=Ar(),{isValidStatusCode:nP}=wo(),{mask:Rv,toBuffer:ts}=_o(),Un=Symbol("kByteLength"),rP=Buffer.alloc(4),tr=class{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let n,i=!1,s=2,o=!1;t.mask&&(n=t.maskBuffer||rP,t.generateMask?t.generateMask(n):eP(n,0,4),o=(n[0]|n[1]|n[2]|n[3])===0,s=6);let a;typeof e=="string"?(!t.mask||o)&&t[Un]!==void 0?a=t[Un]:(e=Buffer.from(e),a=e.length):(a=e.length,i=t.mask&&t.readOnly&&!o);let c=a;a>=65536?(s+=8,c=127):a>125&&(s+=2,c=126);let u=Buffer.allocUnsafe(i?a+s:s);return u[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(u[0]|=64),u[1]=c,c===126?u.writeUInt16BE(a,2):c===127&&(u[2]=u[3]=0,u.writeUIntBE(a,4,6)),t.mask?(u[1]|=128,u[s-4]=n[0],u[s-3]=n[1],u[s-2]=n[2],u[s-1]=n[3],o?[u,e]:i?(Rv(e,n,u,s,a),[u]):(Rv(e,n,e,0,a),[u,e])):[u,e]}close(e,t,n,i){let s;if(e===void 0)s=tP;else{if(typeof e!="number"||!nP(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)s=Buffer.allocUnsafe(2),s.writeUInt16BE(e,0);else{let a=Buffer.byteLength(t);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+a),s.writeUInt16BE(e,0),typeof t=="string"?s.write(t,2):s.set(t,2)}}let o={[Un]:s.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,s,!1,o,i]):this.sendFrame(tr.frame(s,o),i)}ping(e,t,n){let i,s;if(typeof e=="string"?(i=Buffer.byteLength(e),s=!1):(e=ts(e),i=e.length,s=ts.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[Un]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(tr.frame(e,o),n)}pong(e,t,n){let i,s;if(typeof e=="string"?(i=Buffer.byteLength(e),s=!1):(e=ts(e),i=e.length,s=ts.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[Un]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(tr.frame(e,o),n)}send(e,t,n){let i=this._extensions[wv.extensionName],s=t.binary?2:1,o=t.compress,a,c;if(typeof e=="string"?(a=Buffer.byteLength(e),c=!1):(e=ts(e),a=e.length,c=ts.readOnly),this._firstFragment?(this._firstFragment=!1,o&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=a>=i._threshold),this._compress=o):(o=!1,s=0),t.fin&&(this._firstFragment=!0),i){let u={[Un]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:c,rsv1:o};this._deflating?this.enqueue([this.dispatch,e,this._compress,u,n]):this.dispatch(e,this._compress,u,n)}else this.sendFrame(tr.frame(e,{[Un]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:c,rsv1:!1}),n)}dispatch(e,t,n,i){if(!t){this.sendFrame(tr.frame(e,n),i);return}let s=this._extensions[wv.extensionName];this._bufferedBytes+=n[Un],this._deflating=!0,s.compress(e,n.fin,(o,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof i=="function"&&i(c);for(let u=0;u<this._queue.length;u++){let h=this._queue[u],v=h[h.length-1];typeof v=="function"&&v(c)}return}this._bufferedBytes-=n[Un],this._deflating=!1,n.readOnly=!1,this.sendFrame(tr.frame(a,n),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][Un],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][Un],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};Sv.exports=tr});var Ov=B((aN,Dv)=>{"use strict";var{kForOnEventAttribute:Ro,kListener:Gf}=Ar(),Cv=Symbol("kCode"),xv=Symbol("kData"),Ev=Symbol("kError"),kv=Symbol("kMessage"),Tv=Symbol("kReason"),ns=Symbol("kTarget"),Pv=Symbol("kType"),Iv=Symbol("kWasClean"),_r=class{constructor(e){this[ns]=null,this[Pv]=e}get target(){return this[ns]}get type(){return this[Pv]}};Object.defineProperty(_r.prototype,"target",{enumerable:!0});Object.defineProperty(_r.prototype,"type",{enumerable:!0});var di=class extends _r{constructor(e,t={}){super(e),this[Cv]=t.code===void 0?0:t.code,this[Tv]=t.reason===void 0?"":t.reason,this[Iv]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[Cv]}get reason(){return this[Tv]}get wasClean(){return this[Iv]}};Object.defineProperty(di.prototype,"code",{enumerable:!0});Object.defineProperty(di.prototype,"reason",{enumerable:!0});Object.defineProperty(di.prototype,"wasClean",{enumerable:!0});var rs=class extends _r{constructor(e,t={}){super(e),this[Ev]=t.error===void 0?null:t.error,this[kv]=t.message===void 0?"":t.message}get error(){return this[Ev]}get message(){return this[kv]}};Object.defineProperty(rs.prototype,"error",{enumerable:!0});Object.defineProperty(rs.prototype,"message",{enumerable:!0});var So=class extends _r{constructor(e,t={}){super(e),this[xv]=t.data===void 0?null:t.data}get data(){return this[xv]}};Object.defineProperty(So.prototype,"data",{enumerable:!0});var iP={addEventListener(r,e,t={}){for(let i of this.listeners(r))if(!t[Ro]&&i[Gf]===e&&!i[Ro])return;let n;if(r==="message")n=function(s,o){let a=new So("message",{data:o?s:s.toString()});a[ns]=this,dc(e,this,a)};else if(r==="close")n=function(s,o){let a=new di("close",{code:s,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[ns]=this,dc(e,this,a)};else if(r==="error")n=function(s){let o=new rs("error",{error:s,message:s.message});o[ns]=this,dc(e,this,o)};else if(r==="open")n=function(){let s=new _r("open");s[ns]=this,dc(e,this,s)};else return;n[Ro]=!!t[Ro],n[Gf]=e,t.once?this.once(r,n):this.on(r,n)},removeEventListener(r,e){for(let t of this.listeners(r))if(t[Gf]===e&&!t[Ro]){this.removeListener(r,t);break}}};Dv.exports={CloseEvent:di,ErrorEvent:rs,Event:_r,EventTarget:iP,MessageEvent:So};function dc(r,e,t){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,t):r.call(e,t)}});var Vf=B((cN,Av)=>{"use strict";var{tokenChars:Co}=wo();function nr(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}function sP(r){let e=Object.create(null),t=Object.create(null),n=!1,i=!1,s=!1,o,a,c=-1,u=-1,h=-1,v=0;for(;v<r.length;v++)if(u=r.charCodeAt(v),o===void 0)if(h===-1&&Co[u]===1)c===-1&&(c=v);else if(v!==0&&(u===32||u===9))h===-1&&c!==-1&&(h=v);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${v}`);h===-1&&(h=v);let b=r.slice(c,h);u===44?(nr(e,b,t),t=Object.create(null)):o=b,c=h=-1}else throw new SyntaxError(`Unexpected character at index ${v}`);else if(a===void 0)if(h===-1&&Co[u]===1)c===-1&&(c=v);else if(u===32||u===9)h===-1&&c!==-1&&(h=v);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${v}`);h===-1&&(h=v),nr(t,r.slice(c,h),!0),u===44&&(nr(e,o,t),t=Object.create(null),o=void 0),c=h=-1}else if(u===61&&c!==-1&&h===-1)a=r.slice(c,v),c=h=-1;else throw new SyntaxError(`Unexpected character at index ${v}`);else if(i){if(Co[u]!==1)throw new SyntaxError(`Unexpected character at index ${v}`);c===-1?c=v:n||(n=!0),i=!1}else if(s)if(Co[u]===1)c===-1&&(c=v);else if(u===34&&c!==-1)s=!1,h=v;else if(u===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${v}`);else if(u===34&&r.charCodeAt(v-1)===61)s=!0;else if(h===-1&&Co[u]===1)c===-1&&(c=v);else if(c!==-1&&(u===32||u===9))h===-1&&(h=v);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${v}`);h===-1&&(h=v);let b=r.slice(c,h);n&&(b=b.replace(/\\/g,""),n=!1),nr(t,a,b),u===44&&(nr(e,o,t),t=Object.create(null),o=void 0),a=void 0,c=h=-1}else throw new SyntaxError(`Unexpected character at index ${v}`);if(c===-1||s||u===32||u===9)throw new SyntaxError("Unexpected end of input");h===-1&&(h=v);let m=r.slice(c,h);return o===void 0?nr(e,m,t):(a===void 0?nr(t,m,!0):n?nr(t,a,m.replace(/\\/g,"")):nr(t,a,m),nr(e,o,t)),e}function oP(r){return Object.keys(r).map(e=>{let t=r[e];return Array.isArray(t)||(t=[t]),t.map(n=>[e].concat(Object.keys(n).map(i=>{let s=n[i];return Array.isArray(s)||(s=[s]),s.map(o=>o===!0?i:`${i}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Av.exports={format:oP,parse:sP}});var Xf=B((dN,Gv)=>{"use strict";var aP=require("events"),cP=require("https"),uP=require("http"),qv=require("net"),lP=require("tls"),{randomBytes:dP,createHash:fP}=require("crypto"),{Duplex:uN,Readable:lN}=require("stream"),{URL:Wf}=require("url"),Lr=yo(),hP=Uf(),pP=zf(),{BINARY_TYPES:Nv,EMPTY_BUFFER:fc,GUID:gP,kForOnEventAttribute:Hf,kListener:mP,kStatusCode:_P,kWebSocket:Yt,NOOP:Fv}=Ar(),{EventTarget:{addEventListener:bP,removeEventListener:vP}}=Ov(),{format:yP,parse:wP}=Vf(),{toBuffer:RP}=_o(),SP=30*1e3,Mv=Symbol("kAborted"),Kf=[8,13],br=["CONNECTING","OPEN","CLOSING","CLOSED"],CP=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Ne=class extends aP{constructor(e,t,n){super(),this._binaryType=Nv[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=fc,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=Ne.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(n=t,t=[]):t=[t]),$v(this,e,t,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){Nv.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){let i=new hP({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new pP(e,this._extensions,n.generateMask),this._receiver=i,this._socket=e,i[Yt]=this,e[Yt]=this,i.on("conclude",kP),i.on("drain",TP),i.on("error",PP),i.on("message",IP),i.on("ping",DP),i.on("pong",OP),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Bv),e.on("data",pc),e.on("end",Uv),e.on("error",zv),this._readyState=Ne.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=Ne.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Lr.extensionName]&&this._extensions[Lr.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=Ne.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==Ne.CLOSED){if(this.readyState===Ne.CONNECTING){let n="WebSocket was closed before the connection was established";yn(this,this._req,n);return}if(this.readyState===Ne.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=Ne.CLOSING,this._sender.close(e,t,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),SP)}}pause(){this.readyState===Ne.CONNECTING||this.readyState===Ne.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===Ne.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==Ne.OPEN){Yf(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||fc,t,n)}pong(e,t,n){if(this.readyState===Ne.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==Ne.OPEN){Yf(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||fc,t,n)}resume(){this.readyState===Ne.CONNECTING||this.readyState===Ne.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===Ne.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(n=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==Ne.OPEN){Yf(this,e,n);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[Lr.extensionName]||(i.compress=!1),this._sender.send(e||fc,i,n)}terminate(){if(this.readyState!==Ne.CLOSED){if(this.readyState===Ne.CONNECTING){let e="WebSocket was closed before the connection was established";yn(this,this._req,e);return}this._socket&&(this._readyState=Ne.CLOSING,this._socket.destroy())}}};Object.defineProperty(Ne,"CONNECTING",{enumerable:!0,value:br.indexOf("CONNECTING")});Object.defineProperty(Ne.prototype,"CONNECTING",{enumerable:!0,value:br.indexOf("CONNECTING")});Object.defineProperty(Ne,"OPEN",{enumerable:!0,value:br.indexOf("OPEN")});Object.defineProperty(Ne.prototype,"OPEN",{enumerable:!0,value:br.indexOf("OPEN")});Object.defineProperty(Ne,"CLOSING",{enumerable:!0,value:br.indexOf("CLOSING")});Object.defineProperty(Ne.prototype,"CLOSING",{enumerable:!0,value:br.indexOf("CLOSING")});Object.defineProperty(Ne,"CLOSED",{enumerable:!0,value:br.indexOf("CLOSED")});Object.defineProperty(Ne.prototype,"CLOSED",{enumerable:!0,value:br.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(Ne.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(Ne.prototype,`on${r}`,{enumerable:!0,get(){for(let e of this.listeners(r))if(e[Hf])return e[mP];return null},set(e){for(let t of this.listeners(r))if(t[Hf]){this.removeListener(r,t);break}typeof e=="function"&&this.addEventListener(r,e,{[Hf]:!0})}})});Ne.prototype.addEventListener=bP;Ne.prototype.removeEventListener=vP;Gv.exports=Ne;function $v(r,e,t,n){let i={protocolVersion:Kf[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Kf.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${Kf.join(", ")})`);let s;if(e instanceof Wf)s=e;else try{s=new Wf(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}s.protocol==="http:"?s.protocol="ws:":s.protocol==="https:"&&(s.protocol="wss:"),r._url=s.href;let o=s.protocol==="wss:",a=s.protocol==="ws+unix:",c;if(s.protocol!=="ws:"&&!o&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!s.pathname?c="The URL's pathname is empty":s.hash&&(c="The URL contains a fragment identifier"),c){let f=new SyntaxError(c);if(r._redirects===0)throw f;hc(r,f);return}let u=o?443:80,h=dP(16).toString("base64"),v=o?cP.request:uP.request,m=new Set,b;if(i.createConnection=o?EP:xP,i.defaultPort=i.defaultPort||u,i.port=s.port||u,i.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":h,Connection:"Upgrade",Upgrade:"websocket"},i.path=s.pathname+s.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(b=new Lr(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=yP({[Lr.extensionName]:b.offer()})),t.length){for(let f of t){if(typeof f!="string"||!CP.test(f)||m.has(f))throw new SyntaxError("An invalid or duplicated subprotocol was specified");m.add(f)}i.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(s.username||s.password)&&(i.auth=`${s.username}:${s.password}`),a){let f=i.path.split(":");i.socketPath=f[0],i.path=f[1]}let k;if(i.followRedirects){if(r._redirects===0){r._originalIpc=a,r._originalSecure=o,r._originalHostOrSocketPath=a?i.socketPath:s.host;let f=n&&n.headers;if(n={...n,headers:{}},f)for(let[_,w]of Object.entries(f))n.headers[_.toLowerCase()]=w}else if(r.listenerCount("redirect")===0){let f=a?r._originalIpc?i.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:s.host===r._originalHostOrSocketPath;(!f||r._originalSecure&&!o)&&(delete i.headers.authorization,delete i.headers.cookie,f||delete i.headers.host,i.auth=void 0)}i.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),k=r._req=v(i),r._redirects&&r.emit("redirect",r.url,k)}else k=r._req=v(i);i.timeout&&k.on("timeout",()=>{yn(r,k,"Opening handshake has timed out")}),k.on("error",f=>{k===null||k[Mv]||(k=r._req=null,hc(r,f))}),k.on("response",f=>{let _=f.headers.location,w=f.statusCode;if(_&&i.followRedirects&&w>=300&&w<400){if(++r._redirects>i.maxRedirects){yn(r,k,"Maximum redirects exceeded");return}k.abort();let S;try{S=new Wf(_,e)}catch{let l=new SyntaxError(`Invalid URL: ${_}`);hc(r,l);return}$v(r,S,t,n)}else r.emit("unexpected-response",k,f)||yn(r,k,`Unexpected server response: ${f.statusCode}`)}),k.on("upgrade",(f,_,w)=>{if(r.emit("upgrade",f),r.readyState!==Ne.CONNECTING)return;if(k=r._req=null,f.headers.upgrade.toLowerCase()!=="websocket"){yn(r,_,"Invalid Upgrade header");return}let S=fP("sha1").update(h+gP).digest("base64");if(f.headers["sec-websocket-accept"]!==S){yn(r,_,"Invalid Sec-WebSocket-Accept header");return}let y=f.headers["sec-websocket-protocol"],l;if(y!==void 0?m.size?m.has(y)||(l="Server sent an invalid subprotocol"):l="Server sent a subprotocol but none was requested":m.size&&(l="Server sent no subprotocol"),l){yn(r,_,l);return}y&&(r._protocol=y);let x=f.headers["sec-websocket-extensions"];if(x!==void 0){if(!b){yn(r,_,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let E;try{E=wP(x)}catch{yn(r,_,"Invalid Sec-WebSocket-Extensions header");return}let C=Object.keys(E);if(C.length!==1||C[0]!==Lr.extensionName){yn(r,_,"Server indicated an extension that was not requested");return}try{b.accept(E[Lr.extensionName])}catch{yn(r,_,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[Lr.extensionName]=b}r.setSocket(_,w,{generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(k,r):k.end()}function hc(r,e){r._readyState=Ne.CLOSING,r.emit("error",e),r.emitClose()}function xP(r){return r.path=r.socketPath,qv.connect(r)}function EP(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=qv.isIP(r.host)?"":r.host),lP.connect(r)}function yn(r,e,t){r._readyState=Ne.CLOSING;let n=new Error(t);Error.captureStackTrace(n,yn),e.setHeader?(e[Mv]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(hc,r,n)):(e.destroy(n),e.once("error",r.emit.bind(r,"error")),e.once("close",r.emitClose.bind(r)))}function Yf(r,e,t){if(e){let n=RP(e).length;r._socket?r._sender._bufferedBytes+=n:r._bufferedAmount+=n}if(t){let n=new Error(`WebSocket is not open: readyState ${r.readyState} (${br[r.readyState]})`);process.nextTick(t,n)}}function kP(r,e){let t=this[Yt];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=r,t._socket[Yt]!==void 0&&(t._socket.removeListener("data",pc),process.nextTick(jv,t._socket),r===1005?t.close():t.close(r,e))}function TP(){let r=this[Yt];r.isPaused||r._socket.resume()}function PP(r){let e=this[Yt];e._socket[Yt]!==void 0&&(e._socket.removeListener("data",pc),process.nextTick(jv,e._socket),e.close(r[_P])),e.emit("error",r)}function Lv(){this[Yt].emitClose()}function IP(r,e){this[Yt].emit("message",r,e)}function DP(r){let e=this[Yt];e.pong(r,!e._isServer,Fv),e.emit("ping",r)}function OP(r){this[Yt].emit("pong",r)}function jv(r){r.resume()}function Bv(){let r=this[Yt];this.removeListener("close",Bv),this.removeListener("data",pc),this.removeListener("end",Uv),r._readyState=Ne.CLOSING;let e;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(e=r._socket.read())!==null&&r._receiver.write(e),r._receiver.end(),this[Yt]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",Lv),r._receiver.on("finish",Lv))}function pc(r){this[Yt]._receiver.write(r)||this.pause()}function Uv(){let r=this[Yt];r._readyState=Ne.CLOSING,r._receiver.end(),this.end()}function zv(){let r=this[Yt];this.removeListener("error",zv),this.on("error",Fv),r&&(r._readyState=Ne.CLOSING,this.destroy())}});var Wv=B((fN,Vv)=>{"use strict";var{tokenChars:AP}=wo();function NP(r){let e=new Set,t=-1,n=-1,i=0;for(i;i<r.length;i++){let o=r.charCodeAt(i);if(n===-1&&AP[o]===1)t===-1&&(t=i);else if(i!==0&&(o===32||o===9))n===-1&&t!==-1&&(n=i);else if(o===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${i}`);n===-1&&(n=i);let a=r.slice(t,n);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),t=n=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(t===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let s=r.slice(t,i);if(e.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return e.add(s),e}Vv.exports={parse:NP}});var Jv=B((pN,Zv)=>{"use strict";var LP=require("events"),gc=require("http"),{Duplex:hN}=require("stream"),{createHash:qP}=require("crypto"),Hv=Vf(),fi=yo(),FP=Wv(),MP=Xf(),{GUID:$P,kWebSocket:jP}=Ar(),BP=/^[+/0-9A-Za-z]{22}==$/,Kv=0,Yv=1,Qv=2,Qf=class extends LP{constructor(e,t){if(super(),e={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:MP,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=gc.createServer((n,i)=>{let s=gc.STATUS_CODES[426];i.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),i.end(s)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=UP(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,s,o)=>{this.handleUpgrade(i,s,o,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=Kv}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===Qv){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(xo,this);return}if(e&&this.once("close",e),this._state!==Yv)if(this._state=Yv,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(xo,this):process.nextTick(xo,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{xo(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,i){t.on("error",Xv);let s=e.headers["sec-websocket-key"],o=+e.headers["sec-websocket-version"];if(e.method!=="GET"){hi(this,e,t,405,"Invalid HTTP method");return}if(e.headers.upgrade.toLowerCase()!=="websocket"){hi(this,e,t,400,"Invalid Upgrade header");return}if(!s||!BP.test(s)){hi(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(o!==8&&o!==13){hi(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Eo(t,400);return}let a=e.headers["sec-websocket-protocol"],c=new Set;if(a!==void 0)try{c=FP.parse(a)}catch{hi(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let u=e.headers["sec-websocket-extensions"],h={};if(this.options.perMessageDeflate&&u!==void 0){let v=new fi(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let m=Hv.parse(u);m[fi.extensionName]&&(v.accept(m[fi.extensionName]),h[fi.extensionName]=v)}catch{hi(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let v={origin:e.headers[`${o===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(v,(m,b,k,f)=>{if(!m)return Eo(t,b||401,k,f);this.completeUpgrade(h,s,c,e,t,n,i)});return}if(!this.options.verifyClient(v))return Eo(t,401)}this.completeUpgrade(h,s,c,e,t,n,i)}completeUpgrade(e,t,n,i,s,o,a){if(!s.readable||!s.writable)return s.destroy();if(s[jP])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>Kv)return Eo(s,503);let u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${qP("sha1").update(t+$P).digest("base64")}`],h=new this.options.WebSocket(null);if(n.size){let v=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;v&&(u.push(`Sec-WebSocket-Protocol: ${v}`),h._protocol=v)}if(e[fi.extensionName]){let v=e[fi.extensionName].params,m=Hv.format({[fi.extensionName]:[v]});u.push(`Sec-WebSocket-Extensions: ${m}`),h._extensions=e}this.emit("headers",u,i),s.write(u.concat(`\r
`).join(`\r
`)),s.removeListener("error",Xv),h.setSocket(s,o,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(h),h.on("close",()=>{this.clients.delete(h),this._shouldEmitClose&&!this.clients.size&&process.nextTick(xo,this)})),a(h,i)}};Zv.exports=Qf;function UP(r,e){for(let t of Object.keys(e))r.on(t,e[t]);return function(){for(let n of Object.keys(e))r.removeListener(n,e[n])}}function xo(r){r._state=Qv,r.emit("close")}function Xv(){this.destroy()}function Eo(r,e,t,n){t=t||gc.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...n},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${e} ${gc.STATUS_CODES[e]}\r
`+Object.keys(n).map(i=>`${i}: ${n[i]}`).join(`\r
`)+`\r
\r
`+t)}function hi(r,e,t,n,i){if(r.listenerCount("wsClientError")){let s=new Error(i);Error.captureStackTrace(s,hi),r.emit("wsClientError",s,t,e)}else Eo(t,n,i)}});var Rc=B(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.Event=Fr.Response=Fr.Message=void 0;var Do=class{constructor(e){this.seq=0,this.type=e}};Fr.Message=Do;var ih=class extends Do{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};Fr.Response=ih;var sh=class extends Do{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}};Fr.Event=sh});var dy=B(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.ProtocolServer=void 0;var XP=require("events"),Oo=Rc(),oh=class{get event(){return this._event||(this._event=(e,t)=>{this._listener=e,this._this=t;let n;return n={dispose:()=>{this._listener=void 0,this._this=void 0}},n}),this._event}fire(e){if(this._listener)try{this._listener.call(this._this,e)}catch{}}hasListener(){return!!this._listener}dispose(){this._listener=void 0,this._this=void 0}},mi=class extends XP.EventEmitter{constructor(){super(),this._sendMessage=new oh,this._sequence=1,this._pendingRequests=new Map,this.onDidSendMessage=this._sendMessage.event}dispose(){}handleMessage(e){if(e.type==="request")this.dispatchRequest(e);else if(e.type==="response"){let t=e,n=this._pendingRequests.get(t.request_seq);n&&(this._pendingRequests.delete(t.request_seq),n(t))}}_isRunningInline(){return this._sendMessage&&this._sendMessage.hasListener()}start(e,t){this._writableStream=t,this._rawData=Buffer.alloc(0),e.on("data",n=>this._handleData(n)),e.on("close",()=>{this._emitEvent(new Oo.Event("close"))}),e.on("error",n=>{this._emitEvent(new Oo.Event("error","inStream error: "+(n&&n.message)))}),t.on("error",n=>{this._emitEvent(new Oo.Event("error","outStream error: "+(n&&n.message)))}),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,n,i){let s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this._send("request",s),i){this._pendingRequests.set(s.seq,i);let o=setTimeout(()=>{clearTimeout(o);let a=this._pendingRequests.get(s.seq);a&&(this._pendingRequests.delete(s.seq),a(new Oo.Response(s,"timeout")))},n)}}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){let n=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(n,"utf8")}\r
\r
${n}`,"utf8")}this._sendMessage.fire(t)}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){let t=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,t.length>0)try{let n=JSON.parse(t);this.handleMessage(n)}catch(n){this._emitEvent(new Oo.Event("error","Error handling data: "+(n&&n.message)))}continue}}else{let t=this._rawData.indexOf(mi.TWO_CRLF);if(t!==-1){let i=this._rawData.toString("utf8",0,t).split(`\r
`);for(let s=0;s<i.length;s++){let o=i[s].split(/: +/);o[0]=="Content-Length"&&(this._contentLength=+o[1])}this._rawData=this._rawData.slice(t+mi.TWO_CRLF.length);continue}}break}}};Sc.ProtocolServer=mi;mi.TWO_CRLF=`\r
\r
`});var fy=B(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.runDebugAdapter=void 0;var QP=require("net");function ZP(r){let e=0;if(process.argv.slice(2).forEach(function(n,i,s){let o=/^--server=(\d{4,5})$/.exec(n);o&&(e=parseInt(o[1],10))}),e>0)console.error(`waiting for debug protocol on port ${e}`),QP.createServer(n=>{console.error(">> accepted connection from client"),n.on("end",()=>{console.error(`>> client connection closed
`)});let i=new r(!1,!0);i.setRunAsServer(!0),i.start(n,n)}).listen(e);else{let n=new r(!1);process.on("SIGTERM",()=>{n.shutdown()}),n.start(process.stdin,process.stdout)}}Cc.runDebugAdapter=ZP});var xc=B(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.DebugSession=ye.ErrorDestination=ye.MemoryEvent=ye.InvalidatedEvent=ye.ProgressEndEvent=ye.ProgressUpdateEvent=ye.ProgressStartEvent=ye.CapabilitiesEvent=ye.LoadedSourceEvent=ye.ModuleEvent=ye.BreakpointEvent=ye.ThreadEvent=ye.OutputEvent=ye.ExitedEvent=ye.TerminatedEvent=ye.InitializedEvent=ye.ContinuedEvent=ye.StoppedEvent=ye.CompletionItem=ye.Module=ye.Breakpoint=ye.Variable=ye.Thread=ye.StackFrame=ye.Scope=ye.Source=void 0;var JP=dy(),Ut=Rc(),eI=fy(),hy=require("url"),ah=class{constructor(e,t,n=0,i,s){this.name=e,this.path=t,this.sourceReference=n,i&&(this.origin=i),s&&(this.adapterData=s)}};ye.Source=ah;var ch=class{constructor(e,t,n=!1){this.name=e,this.variablesReference=t,this.expensive=n}};ye.Scope=ch;var uh=class{constructor(e,t,n,i=0,s=0){this.id=e,this.source=n,this.line=i,this.column=s,this.name=t}};ye.StackFrame=uh;var lh=class{constructor(e,t){this.id=e,t?this.name=t:this.name="Thread #"+e}};ye.Thread=lh;var dh=class{constructor(e,t,n=0,i,s){this.name=e,this.value=t,this.variablesReference=n,typeof s=="number"&&(this.namedVariables=s),typeof i=="number"&&(this.indexedVariables=i)}};ye.Variable=dh;var fh=class{constructor(e,t,n,i){this.verified=e;let s=this;typeof t=="number"&&(s.line=t),typeof n=="number"&&(s.column=n),i&&(s.source=i)}setId(e){this.id=e}};ye.Breakpoint=fh;var hh=class{constructor(e,t){this.id=e,this.name=t}};ye.Module=hh;var ph=class{constructor(e,t,n=0){this.label=e,this.start=t,this.length=n}};ye.CompletionItem=ph;var gh=class extends Ut.Event{constructor(e,t,n){super("stopped"),this.body={reason:e},typeof t=="number"&&(this.body.threadId=t),typeof n=="string"&&(this.body.text=n)}};ye.StoppedEvent=gh;var mh=class extends Ut.Event{constructor(e,t){super("continued"),this.body={threadId:e},typeof t=="boolean"&&(this.body.allThreadsContinued=t)}};ye.ContinuedEvent=mh;var _h=class extends Ut.Event{constructor(){super("initialized")}};ye.InitializedEvent=_h;var bh=class extends Ut.Event{constructor(e){if(super("terminated"),typeof e=="boolean"||e){let t=this;t.body={restart:e}}}};ye.TerminatedEvent=bh;var vh=class extends Ut.Event{constructor(e){super("exited"),this.body={exitCode:e}}};ye.ExitedEvent=vh;var yh=class extends Ut.Event{constructor(e,t="console",n){super("output"),this.body={category:t,output:e},n!==void 0&&(this.body.data=n)}};ye.OutputEvent=yh;var wh=class extends Ut.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}};ye.ThreadEvent=wh;var Rh=class extends Ut.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}};ye.BreakpointEvent=Rh;var Sh=class extends Ut.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}};ye.ModuleEvent=Sh;var Ch=class extends Ut.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}};ye.LoadedSourceEvent=Ch;var xh=class extends Ut.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}};ye.CapabilitiesEvent=xh;var Eh=class extends Ut.Event{constructor(e,t,n){super("progressStart"),this.body={progressId:e,title:t},typeof n=="string"&&(this.body.message=n)}};ye.ProgressStartEvent=Eh;var kh=class extends Ut.Event{constructor(e,t){super("progressUpdate"),this.body={progressId:e},typeof t=="string"&&(this.body.message=t)}};ye.ProgressUpdateEvent=kh;var Th=class extends Ut.Event{constructor(e,t){super("progressEnd"),this.body={progressId:e},typeof t=="string"&&(this.body.message=t)}};ye.ProgressEndEvent=Th;var Ph=class extends Ut.Event{constructor(e,t,n){super("invalidated"),this.body={},e&&(this.body.areas=e),t&&(this.body.threadId=t),n&&(this.body.stackFrameId=n)}};ye.InvalidatedEvent=Ph;var Ih=class extends Ut.Event{constructor(e,t,n){super("memory"),this.body={memoryReference:e,offset:t,count:n}}};ye.MemoryEvent=Ih;var _i;(function(r){r[r.User=1]="User",r[r.Telemetry=2]="Telemetry"})(_i=ye.ErrorDestination||(ye.ErrorDestination={}));var Gn=class extends JP.ProtocolServer{constructor(e,t){super();let n=typeof e=="boolean"?e:!1;this._debuggerLinesStartAt1=n,this._debuggerColumnsStartAt1=n,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer=typeof t=="boolean"?t:!1,this.on("close",()=>{this.shutdown()}),this.on("error",i=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs=e!=="path"}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){(0,eI.runDebugAdapter)(e)}shutdown(){this._isServer||this._isRunningInline()||setTimeout(()=>{process.exit(0)},100)}sendErrorResponse(e,t,n,i,s=_i.User){let o;typeof t=="number"?(o={id:t,format:n},i&&(o.variables=i),s&_i.User&&(o.showUser=!0),s&_i.Telemetry&&(o.sendTelemetry=!0)):o=t,e.success=!1,e.message=Gn.formatPII(o.format,!0,o.variables),e.body||(e.body={}),e.body.error=o,this.sendResponse(e)}runInTerminalRequest(e,t,n){this.sendRequest("runInTerminal",e,t,n)}dispatchRequest(e){let t=new Ut.Response(e);try{if(e.command==="initialize"){var n=e.arguments;if(typeof n.linesStartAt1=="boolean"&&(this._clientLinesStartAt1=n.linesStartAt1),typeof n.columnsStartAt1=="boolean"&&(this._clientColumnsStartAt1=n.columnsStartAt1),n.pathFormat!=="path")this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,_i.Telemetry);else{let i=t;i.body={},this.initializeRequest(i,n)}}else e.command==="launch"?this.launchRequest(t,e.arguments,e):e.command==="attach"?this.attachRequest(t,e.arguments,e):e.command==="disconnect"?this.disconnectRequest(t,e.arguments,e):e.command==="terminate"?this.terminateRequest(t,e.arguments,e):e.command==="restart"?this.restartRequest(t,e.arguments,e):e.command==="setBreakpoints"?this.setBreakPointsRequest(t,e.arguments,e):e.command==="setFunctionBreakpoints"?this.setFunctionBreakPointsRequest(t,e.arguments,e):e.command==="setExceptionBreakpoints"?this.setExceptionBreakPointsRequest(t,e.arguments,e):e.command==="configurationDone"?this.configurationDoneRequest(t,e.arguments,e):e.command==="continue"?this.continueRequest(t,e.arguments,e):e.command==="next"?this.nextRequest(t,e.arguments,e):e.command==="stepIn"?this.stepInRequest(t,e.arguments,e):e.command==="stepOut"?this.stepOutRequest(t,e.arguments,e):e.command==="stepBack"?this.stepBackRequest(t,e.arguments,e):e.command==="reverseContinue"?this.reverseContinueRequest(t,e.arguments,e):e.command==="restartFrame"?this.restartFrameRequest(t,e.arguments,e):e.command==="goto"?this.gotoRequest(t,e.arguments,e):e.command==="pause"?this.pauseRequest(t,e.arguments,e):e.command==="stackTrace"?this.stackTraceRequest(t,e.arguments,e):e.command==="scopes"?this.scopesRequest(t,e.arguments,e):e.command==="variables"?this.variablesRequest(t,e.arguments,e):e.command==="setVariable"?this.setVariableRequest(t,e.arguments,e):e.command==="setExpression"?this.setExpressionRequest(t,e.arguments,e):e.command==="source"?this.sourceRequest(t,e.arguments,e):e.command==="threads"?this.threadsRequest(t,e):e.command==="terminateThreads"?this.terminateThreadsRequest(t,e.arguments,e):e.command==="evaluate"?this.evaluateRequest(t,e.arguments,e):e.command==="stepInTargets"?this.stepInTargetsRequest(t,e.arguments,e):e.command==="gotoTargets"?this.gotoTargetsRequest(t,e.arguments,e):e.command==="completions"?this.completionsRequest(t,e.arguments,e):e.command==="exceptionInfo"?this.exceptionInfoRequest(t,e.arguments,e):e.command==="loadedSources"?this.loadedSourcesRequest(t,e.arguments,e):e.command==="dataBreakpointInfo"?this.dataBreakpointInfoRequest(t,e.arguments,e):e.command==="setDataBreakpoints"?this.setDataBreakpointsRequest(t,e.arguments,e):e.command==="readMemory"?this.readMemoryRequest(t,e.arguments,e):e.command==="writeMemory"?this.writeMemoryRequest(t,e.arguments,e):e.command==="disassemble"?this.disassembleRequest(t,e.arguments,e):e.command==="cancel"?this.cancelRequest(t,e.arguments,e):e.command==="breakpointLocations"?this.breakpointLocationsRequest(t,e.arguments,e):e.command==="setInstructionBreakpoints"?this.setInstructionBreakpointsRequest(t,e.arguments,e):this.customRequest(e.command,t,e.arguments,e)}catch(i){this.sendErrorResponse(t,1104,"{_stack}",{_exception:i.message,_stack:i.stack},_i.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsClipboardContext=!1,e.body.supportsSteppingGranularity=!1,e.body.supportsInstructionBreakpoints=!1,e.body.supportsExceptionFilterOptions=!1,this.sendResponse(e)}disconnectRequest(e,t,n){this.sendResponse(e),this.shutdown()}launchRequest(e,t,n){this.sendResponse(e)}attachRequest(e,t,n){this.sendResponse(e)}terminateRequest(e,t,n){this.sendResponse(e)}restartRequest(e,t,n){this.sendResponse(e)}setBreakPointsRequest(e,t,n){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t,n){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t,n){this.sendResponse(e)}configurationDoneRequest(e,t,n){this.sendResponse(e)}continueRequest(e,t,n){this.sendResponse(e)}nextRequest(e,t,n){this.sendResponse(e)}stepInRequest(e,t,n){this.sendResponse(e)}stepOutRequest(e,t,n){this.sendResponse(e)}stepBackRequest(e,t,n){this.sendResponse(e)}reverseContinueRequest(e,t,n){this.sendResponse(e)}restartFrameRequest(e,t,n){this.sendResponse(e)}gotoRequest(e,t,n){this.sendResponse(e)}pauseRequest(e,t,n){this.sendResponse(e)}sourceRequest(e,t,n){this.sendResponse(e)}threadsRequest(e,t){this.sendResponse(e)}terminateThreadsRequest(e,t,n){this.sendResponse(e)}stackTraceRequest(e,t,n){this.sendResponse(e)}scopesRequest(e,t,n){this.sendResponse(e)}variablesRequest(e,t,n){this.sendResponse(e)}setVariableRequest(e,t,n){this.sendResponse(e)}setExpressionRequest(e,t,n){this.sendResponse(e)}evaluateRequest(e,t,n){this.sendResponse(e)}stepInTargetsRequest(e,t,n){this.sendResponse(e)}gotoTargetsRequest(e,t,n){this.sendResponse(e)}completionsRequest(e,t,n){this.sendResponse(e)}exceptionInfoRequest(e,t,n){this.sendResponse(e)}loadedSourcesRequest(e,t,n){this.sendResponse(e)}dataBreakpointInfoRequest(e,t,n){this.sendResponse(e)}setDataBreakpointsRequest(e,t,n){this.sendResponse(e)}readMemoryRequest(e,t,n){this.sendResponse(e)}writeMemoryRequest(e,t,n){this.sendResponse(e)}disassembleRequest(e,t,n){this.sendResponse(e)}cancelRequest(e,t,n){this.sendResponse(e)}breakpointLocationsRequest(e,t,n){this.sendResponse(e)}setInstructionBreakpointsRequest(e,t,n){this.sendResponse(e)}customRequest(e,t,n,i){this.sendErrorResponse(t,1014,"unrecognized request",null,_i.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?Gn.uri2path(e):Gn.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?Gn.uri2path(e):Gn.path2uri(e):e}static path2uri(e){process.platform==="win32"&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new hy.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new hy.URL(e),n=decodeURIComponent(t.pathname);return process.platform==="win32"&&(/^\/[a-zA-Z]:/.test(n)&&(n=n[1].toLowerCase()+n.substr(2)),n=n.replace(/\//g,"\\")),n}static formatPII(e,t,n){return e.replace(Gn._formatPIIRegexp,function(i,s){return t&&s.length>0&&s[0]!=="_"?i:n[s]&&n.hasOwnProperty(s)?n[s]:i})}};ye.DebugSession=Gn;Gn._formatPIIRegexp=/{([^}]+)}/g});var _y=B(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.InternalLogger=void 0;var py=require("fs"),gy=require("path"),wn=Tc(),Dh=class{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=wn.LogLevel.Warn,this.disposeCallback=(n,i)=>{this.dispose(),i=i||2,i+=128,process.exit(i)}}async setup(e){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(!gy.isAbsolute(e.logFilePath))this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,wn.LogLevel.Error);else{let t=n=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${n.toString()}
`,wn.LogLevel.Error);try{await py.promises.mkdir(gy.dirname(e.logFilePath),{recursive:!0}),this.log(`Verbose logs are written to:
`,wn.LogLevel.Warn),this.log(e.logFilePath+`
`,wn.LogLevel.Warn),this._logFileStream=py.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",n=>{t(n)})}catch(n){t(n)}}}logDateTime(){let e=new Date,n=e.getUTCFullYear()+`-${e.getUTCMonth()+1}-`+e.getUTCDate()+", "+my();this.log(n+`
`,wn.LogLevel.Verbose,!1)}setupShutdownListeners(){process.on("beforeExit",this.beforeExitCallback),process.on("SIGTERM",this.disposeCallback),process.on("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,n=!0){if(this._minLogLevel!==wn.LogLevel.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){let i=t===wn.LogLevel.Error?console.error:t===wn.LogLevel.Warn?console.warn:null;i&&i((0,wn.trimLastNewline)(e))}t===wn.LogLevel.Error&&(e=`[${wn.LogLevel[t]}] ${e}`),this._prependTimestamp&&n&&(e="["+my()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){let n=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",n&&(e=e+`
`)}if(this._logCallback){let n=new wn.LogOutputEvent(e,t);this._logCallback(n)}}};kc.InternalLogger=Dh;function my(){let r=new Date,e=Ec(2,String(r.getUTCHours())),t=Ec(2,String(r.getUTCMinutes())),n=Ec(2,String(r.getUTCSeconds())),i=Ec(3,String(r.getUTCMilliseconds()));return e+":"+t+":"+n+"."+i+" UTC"}function Ec(r,e){return e.length>=r?e:String("0".repeat(r)+e).slice(-r)}});var Tc=B(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.trimLastNewline=Rn.LogOutputEvent=Rn.logger=Rn.Logger=Rn.LogLevel=void 0;var tI=_y(),nI=xc(),Mr;(function(r){r[r.Verbose=0]="Verbose",r[r.Log=1]="Log",r[r.Warn=2]="Warn",r[r.Error=3]="Error",r[r.Stop=4]="Stop"})(Mr=Rn.LogLevel||(Rn.LogLevel={}));var Pc=class{constructor(){this._pendingLogQ=[]}log(e,t=Mr.Log){e=e+`
`,this._write(e,t)}verbose(e){this.log(e,Mr.Verbose)}warn(e){this.log(e,Mr.Warn)}error(e){this.log(e,Mr.Error)}dispose(){if(this._currentLogger){let e=this._currentLogger.dispose();return this._currentLogger=null,e}else return Promise.resolve()}_write(e,t=Mr.Log){e=e+"",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,n=!0){let i=typeof t=="string"?t:t&&this._logFilePathFromInit;if(this._currentLogger){let s={consoleMinLogLevel:e,logFilePath:i,prependTimestamp:n};this._currentLogger.setup(s).then(()=>{if(this._pendingLogQ){let o=this._pendingLogQ;this._pendingLogQ=null,o.forEach(a=>this._write(a.msg,a.level))}})}}init(e,t,n){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new tI.InternalLogger(e,n),this._logFilePathFromInit=t}};Rn.Logger=Pc;Rn.logger=new Pc;var Oh=class extends nI.OutputEvent{constructor(e,t){let n=t===Mr.Error?"stderr":t===Mr.Warn?"console":"stdout";super(e,n)}};Rn.LogOutputEvent=Oh;function rI(r){return r.replace(/(\n|\r\n)$/,"")}Rn.trimLastNewline=rI});var yy=B(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.LoggingDebugSession=void 0;var vy=Tc(),is=vy.logger,by=xc(),Ah=class extends by.DebugSession{constructor(e,t,n){super(t,n),this.obsolete_logFilePath=e,this.on("error",i=>{is.error(i.body)})}start(e,t){super.start(e,t),is.init(n=>this.sendEvent(n),this.obsolete_logFilePath,this._isServer)}sendEvent(e){if(!(e instanceof vy.LogOutputEvent)){let t=e;e instanceof by.OutputEvent&&e.body&&e.body.data&&e.body.data.doNotLogOutput&&(delete e.body.data.doNotLogOutput,t={...e},t.body={...e.body,output:"<output not logged>"}),is.verbose(`To client: ${JSON.stringify(t)}`)}super.sendEvent(e)}sendRequest(e,t,n,i){is.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${n}`),super.sendRequest(e,t,n,i)}sendResponse(e){is.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){is.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}};Ic.LoggingDebugSession=Ah});var wy=B(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Handles=void 0;var Nh=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle=typeof e=="number"?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}};Dc.Handles=Nh});var Ao=B(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.Handles=re.Response=re.Event=re.ErrorDestination=re.CompletionItem=re.Module=re.Source=re.Breakpoint=re.Variable=re.Scope=re.StackFrame=re.Thread=re.MemoryEvent=re.InvalidatedEvent=re.ProgressEndEvent=re.ProgressUpdateEvent=re.ProgressStartEvent=re.CapabilitiesEvent=re.LoadedSourceEvent=re.ModuleEvent=re.BreakpointEvent=re.ThreadEvent=re.OutputEvent=re.ContinuedEvent=re.StoppedEvent=re.ExitedEvent=re.TerminatedEvent=re.InitializedEvent=re.logger=re.Logger=re.LoggingDebugSession=re.DebugSession=void 0;var st=xc();Object.defineProperty(re,"DebugSession",{enumerable:!0,get:function(){return st.DebugSession}});Object.defineProperty(re,"InitializedEvent",{enumerable:!0,get:function(){return st.InitializedEvent}});Object.defineProperty(re,"TerminatedEvent",{enumerable:!0,get:function(){return st.TerminatedEvent}});Object.defineProperty(re,"ExitedEvent",{enumerable:!0,get:function(){return st.ExitedEvent}});Object.defineProperty(re,"StoppedEvent",{enumerable:!0,get:function(){return st.StoppedEvent}});Object.defineProperty(re,"ContinuedEvent",{enumerable:!0,get:function(){return st.ContinuedEvent}});Object.defineProperty(re,"OutputEvent",{enumerable:!0,get:function(){return st.OutputEvent}});Object.defineProperty(re,"ThreadEvent",{enumerable:!0,get:function(){return st.ThreadEvent}});Object.defineProperty(re,"BreakpointEvent",{enumerable:!0,get:function(){return st.BreakpointEvent}});Object.defineProperty(re,"ModuleEvent",{enumerable:!0,get:function(){return st.ModuleEvent}});Object.defineProperty(re,"LoadedSourceEvent",{enumerable:!0,get:function(){return st.LoadedSourceEvent}});Object.defineProperty(re,"CapabilitiesEvent",{enumerable:!0,get:function(){return st.CapabilitiesEvent}});Object.defineProperty(re,"ProgressStartEvent",{enumerable:!0,get:function(){return st.ProgressStartEvent}});Object.defineProperty(re,"ProgressUpdateEvent",{enumerable:!0,get:function(){return st.ProgressUpdateEvent}});Object.defineProperty(re,"ProgressEndEvent",{enumerable:!0,get:function(){return st.ProgressEndEvent}});Object.defineProperty(re,"InvalidatedEvent",{enumerable:!0,get:function(){return st.InvalidatedEvent}});Object.defineProperty(re,"MemoryEvent",{enumerable:!0,get:function(){return st.MemoryEvent}});Object.defineProperty(re,"Thread",{enumerable:!0,get:function(){return st.Thread}});Object.defineProperty(re,"StackFrame",{enumerable:!0,get:function(){return st.StackFrame}});Object.defineProperty(re,"Scope",{enumerable:!0,get:function(){return st.Scope}});Object.defineProperty(re,"Variable",{enumerable:!0,get:function(){return st.Variable}});Object.defineProperty(re,"Breakpoint",{enumerable:!0,get:function(){return st.Breakpoint}});Object.defineProperty(re,"Source",{enumerable:!0,get:function(){return st.Source}});Object.defineProperty(re,"Module",{enumerable:!0,get:function(){return st.Module}});Object.defineProperty(re,"CompletionItem",{enumerable:!0,get:function(){return st.CompletionItem}});Object.defineProperty(re,"ErrorDestination",{enumerable:!0,get:function(){return st.ErrorDestination}});var iI=yy();Object.defineProperty(re,"LoggingDebugSession",{enumerable:!0,get:function(){return iI.LoggingDebugSession}});var Ry=Tc();re.Logger=Ry;var Sy=Rc();Object.defineProperty(re,"Event",{enumerable:!0,get:function(){return Sy.Event}});Object.defineProperty(re,"Response",{enumerable:!0,get:function(){return Sy.Response}});var sI=wy();Object.defineProperty(re,"Handles",{enumerable:!0,get:function(){return sI.Handles}});var oI=Ry.logger;re.logger=oI});var Lh=B(Cy=>{function Oc(){this.waiters=[]}Oc.prototype.wait=function(r){var e=this,t={};this.waiters.push(t);var n=new Promise(function(i){var s=!1;t.resolve=function(o){if(!s){if(s=!0,t.timeout&&(clearTimeout(t.timeout),t.timeout=null),!o){var a=e.waiters.indexOf(t);a>-1&&e.waiters.splice(a,1)}i()}}});return r>0&&isFinite(r)&&(t.timeout=setTimeout(function(){t.timeout=null,t.resolve()},r)),n};Oc.prototype.notify=function(){this.waiters.length>0&&this.waiters.pop().resolve(!0)};Oc.prototype.notifyAll=function(){for(var r=this.waiters.length-1;r>=0;r--)this.waiters[r].resolve(!0);this.waiters=[]};Cy.Subject=Oc});var $y=B((qo,Yh)=>{(function(r,e){typeof qo=="object"&&typeof Yh=="object"?Yh.exports=e():typeof define=="function"&&define.amd?define([],e):typeof qo=="object"?qo.vscodetextmate=e():r.vscodetextmate=e()})(qo,function(){return(()=>{"use strict";var r={350:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UseOnigurumaFindOptions=n.DebugFlags=void 0,n.DebugFlags={InDebugMode:typeof process<"u"&&!!process.env.VSCODE_TEXTMATE_DEBUG},n.UseOnigurumaFindOptions=!1},442:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.applyStateStackDiff=n.diffStateStacksRefEq=void 0;let s=i(391);n.diffStateStacksRefEq=function(o,a){let c=0,u=[],h=o,v=a;for(;h!==v;)h&&(!v||h.depth>=v.depth)?(c++,h=h.parent):(u.push(v.toStateStackFrame()),v=v.parent);return{pops:c,newFrames:u.reverse()}},n.applyStateStackDiff=function(o,a){let c=o;for(let u=0;u<a.pops;u++)c=c.parent;for(let u of a.newFrames)c=s.StateStackImpl.pushFrame(c,u);return c}},36:(t,n)=>{var i;Object.defineProperty(n,"__esModule",{value:!0}),n.toOptionalTokenType=n.EncodedTokenAttributes=void 0,(i=n.EncodedTokenAttributes||(n.EncodedTokenAttributes={})).toBinaryStr=function(s){let o=s.toString(2);for(;o.length<32;)o="0"+o;return o},i.print=function(s){let o=i.getLanguageId(s),a=i.getTokenType(s),c=i.getFontStyle(s),u=i.getForeground(s),h=i.getBackground(s);console.log({languageId:o,tokenType:a,fontStyle:c,foreground:u,background:h})},i.getLanguageId=function(s){return(255&s)>>>0},i.getTokenType=function(s){return(768&s)>>>8},i.containsBalancedBrackets=function(s){return(1024&s)!=0},i.getFontStyle=function(s){return(30720&s)>>>11},i.getForeground=function(s){return(16744448&s)>>>15},i.getBackground=function(s){return(4278190080&s)>>>24},i.set=function(s,o,a,c,u,h,v){let m=i.getLanguageId(s),b=i.getTokenType(s),k=i.containsBalancedBrackets(s)?1:0,f=i.getFontStyle(s),_=i.getForeground(s),w=i.getBackground(s);return o!==0&&(m=o),a!==8&&(b=a),c!==null&&(k=c?1:0),u!==-1&&(f=u),h!==0&&(_=h),v!==0&&(w=v),(m<<0|b<<8|k<<10|f<<11|_<<15|w<<24)>>>0},n.toOptionalTokenType=function(s){return s}},996:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BasicScopeAttributesProvider=n.BasicScopeAttributes=void 0;let s=i(878);class o{constructor(h,v){this.languageId=h,this.tokenType=v}}n.BasicScopeAttributes=o;class a{constructor(h,v){this._getBasicScopeAttributes=new s.CachedFn(m=>{let b=this._scopeToLanguage(m),k=this._toStandardTokenType(m);return new o(b,k)}),this._defaultAttributes=new o(h,8),this._embeddedLanguagesMatcher=new c(Object.entries(v||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(h){return h===null?a._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(h)}_scopeToLanguage(h){return this._embeddedLanguagesMatcher.match(h)||0}_toStandardTokenType(h){let v=h.match(a.STANDARD_TOKEN_TYPE_REGEXP);if(!v)return 8;switch(v[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}}n.BasicScopeAttributesProvider=a,a._NULL_SCOPE_METADATA=new o(0,0),a.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;class c{constructor(h){if(h.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(h);let v=h.map(([m,b])=>s.escapeRegExpCharacters(m));v.sort(),v.reverse(),this.scopesRegExp=new RegExp(`^((${v.join(")|(")}))($|\\.)`,"")}}match(h){if(!this.scopesRegExp)return;let v=h.match(this.scopesRegExp);return v?this.values.get(v[1]):void 0}}},947:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LineTokens=n.BalancedBracketSelectors=n.StateStackImpl=n.AttributedScopeStack=n.Grammar=n.createGrammar=void 0;let s=i(350),o=i(36),a=i(736),c=i(44),u=i(792),h=i(583),v=i(878),m=i(996),b=i(47);function k(E,C,T,D,F){let z=a.createMatchers(C,f),H=u.RuleFactory.getCompiledRuleId(T,D,F.repository);for(let Q of z)E.push({debugSelector:C,matcher:Q.matcher,ruleId:H,grammar:F,priority:Q.priority})}function f(E,C){if(C.length<E.length)return!1;let T=0;return E.every(D=>{for(let F=T;F<C.length;F++)if(_(C[F],D))return T=F+1,!0;return!1})}function _(E,C){if(!E)return!1;if(E===C)return!0;let T=C.length;return E.length>T&&E.substr(0,T)===C&&E[T]==="."}n.createGrammar=function(E,C,T,D,F,z,H,Q){return new w(E,C,T,D,F,z,H,Q)};class w{constructor(C,T,D,F,z,H,Q,J){if(this._rootScopeName=C,this.balancedBracketSelectors=H,this._onigLib=J,this._basicScopeAttributesProvider=new m.BasicScopeAttributesProvider(D,F),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=Q,this._grammar=S(T,null),this._injections=null,this._tokenTypeMatchers=[],z)for(let ie of Object.keys(z)){let be=a.createMatchers(ie,f);for(let ee of be)this._tokenTypeMatchers.push({matcher:ee.matcher,type:z[ie]})}}get themeProvider(){return this._grammarRepository}dispose(){for(let C of this._ruleId2desc)C&&C.dispose()}createOnigScanner(C){return this._onigLib.createOnigScanner(C)}createOnigString(C){return this._onigLib.createOnigString(C)}getMetadataForScope(C){return this._basicScopeAttributesProvider.getBasicScopeAttributes(C)}_collectInjections(){let C=[],T=this._rootScopeName,D=(F=>F===this._rootScopeName?this._grammar:this.getExternalGrammar(F))(T);if(D){let F=D.injections;if(F)for(let H in F)k(C,H,F[H],this,D);let z=this._grammarRepository.injections(T);z&&z.forEach(H=>{let Q=this.getExternalGrammar(H);if(Q){let J=Q.injectionSelector;J&&k(C,J,Q,this,Q)}})}return C.sort((F,z)=>F.priority-z.priority),C}getInjections(){if(this._injections===null&&(this._injections=this._collectInjections(),s.DebugFlags.InDebugMode&&this._injections.length>0)){console.log(`Grammar ${this._rootScopeName} contains the following injections:`);for(let C of this._injections)console.log(`  - ${C.debugSelector}`)}return this._injections}registerRule(C){let T=++this._lastRuleId,D=C(u.ruleIdFromNumber(T));return this._ruleId2desc[T]=D,D}getRule(C){return this._ruleId2desc[u.ruleIdToNumber(C)]}getExternalGrammar(C,T){if(this._includedGrammars[C])return this._includedGrammars[C];if(this._grammarRepository){let D=this._grammarRepository.lookup(C);if(D)return this._includedGrammars[C]=S(D,T&&T.$base),this._includedGrammars[C]}}tokenizeLine(C,T,D=0){let F=this._tokenize(C,T,!1,D);return{tokens:F.lineTokens.getResult(F.ruleStack,F.lineLength),ruleStack:F.ruleStack,stoppedEarly:F.stoppedEarly}}tokenizeLine2(C,T,D=0){let F=this._tokenize(C,T,!0,D);return{tokens:F.lineTokens.getBinaryResult(F.ruleStack,F.lineLength),ruleStack:F.ruleStack,stoppedEarly:F.stoppedEarly}}_tokenize(C,T,D,F){let z;if(this._rootId===-1&&(this._rootId=u.RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections()),T&&T!==l.NULL)z=!1,T.reset();else{z=!0;let be=this._basicScopeAttributesProvider.getDefaultAttributes(),ee=this.themeProvider.getDefaults(),Ae=o.EncodedTokenAttributes.set(0,be.languageId,be.tokenType,null,ee.fontStyle,ee.foregroundId,ee.backgroundId),ae=this.getRule(this._rootId).getName(null,null),Ee;Ee=ae?y.createRootAndLookUpScopeName(ae,Ae,this):y.createRoot("unknown",Ae),T=new l(null,this._rootId,-1,-1,!1,null,Ee,Ee)}C+=`
`;let H=this.createOnigString(C),Q=H.content.length,J=new x(D,C,this._tokenTypeMatchers,this.balancedBracketSelectors),ie=b._tokenizeString(this,H,z,0,T,J,!0,F);return c.disposeOnigString(H),{lineLength:Q,lineTokens:J,ruleStack:ie.stack,stoppedEarly:ie.stoppedEarly}}}function S(E,C){return(E=v.clone(E)).repository=E.repository||{},E.repository.$self={$vscodeTextmateLocation:E.$vscodeTextmateLocation,patterns:E.patterns,name:E.scopeName},E.repository.$base=C||E.repository.$self,E}n.Grammar=w;class y{constructor(C,T,D){this.parent=C,this.scopePath=T,this.tokenAttributes=D}static fromExtension(C,T){let D=C,F=C?.scopePath??null;for(let z of T)F=h.ScopeStack.push(F,z.scopeNames),D=new y(D,F,z.encodedTokenAttributes);return D}static createRoot(C,T){return new y(null,new h.ScopeStack(null,C),T)}static createRootAndLookUpScopeName(C,T,D){let F=D.getMetadataForScope(C),z=new h.ScopeStack(null,C),H=D.themeProvider.themeMatch(z),Q=y.mergeAttributes(T,F,H);return new y(null,z,Q)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(C){return y.equals(this,C)}static equals(C,T){for(;;){if(C===T||!C&&!T)return!0;if(!C||!T||C.scopeName!==T.scopeName||C.tokenAttributes!==T.tokenAttributes)return!1;C=C.parent,T=T.parent}}static mergeAttributes(C,T,D){let F=-1,z=0,H=0;return D!==null&&(F=D.fontStyle,z=D.foregroundId,H=D.backgroundId),o.EncodedTokenAttributes.set(C,T.languageId,T.tokenType,null,F,z,H)}pushAttributed(C,T){if(C===null)return this;if(C.indexOf(" ")===-1)return y._pushAttributed(this,C,T);let D=C.split(/ /g),F=this;for(let z of D)F=y._pushAttributed(F,z,T);return F}static _pushAttributed(C,T,D){let F=D.getMetadataForScope(T),z=C.scopePath.push(T),H=D.themeProvider.themeMatch(z),Q=y.mergeAttributes(C.tokenAttributes,F,H);return new y(C,z,Q)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(C){let T=[],D=this;for(;D&&D!==C;)T.push({encodedTokenAttributes:D.tokenAttributes,scopeNames:D.scopePath.getExtensionIfDefined(D.parent?.scopePath??null)}),D=D.parent;return D===C?T.reverse():void 0}}n.AttributedScopeStack=y;class l{constructor(C,T,D,F,z,H,Q,J){this.parent=C,this.ruleId=T,this.beginRuleCapturedEOL=z,this.endRule=H,this.nameScopesList=Q,this.contentNameScopesList=J,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=D,this._anchorPos=F}equals(C){return C!==null&&l._equals(this,C)}static _equals(C,T){return C===T||!!this._structuralEquals(C,T)&&y.equals(C.contentNameScopesList,T.contentNameScopesList)}static _structuralEquals(C,T){for(;;){if(C===T||!C&&!T)return!0;if(!C||!T||C.depth!==T.depth||C.ruleId!==T.ruleId||C.endRule!==T.endRule)return!1;C=C.parent,T=T.parent}}clone(){return this}static _reset(C){for(;C;)C._enterPos=-1,C._anchorPos=-1,C=C.parent}reset(){l._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(C,T,D,F,z,H,Q){return new l(this,C,T,D,F,z,H,Q)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(C){return C.getRule(this.ruleId)}toString(){let C=[];return this._writeString(C,0),"["+C.join(",")+"]"}_writeString(C,T){return this.parent&&(T=this.parent._writeString(C,T)),C[T++]=`(${this.ruleId}, ${this.nameScopesList?.toString()}, ${this.contentNameScopesList?.toString()})`,T}withContentNameScopesList(C){return this.contentNameScopesList===C?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,C)}withEndRule(C){return this.endRule===C?this:new l(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,C,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(C){let T=this;for(;T&&T._enterPos===C._enterPos;){if(T.ruleId===C.ruleId)return!0;T=T.parent}return!1}toStateStackFrame(){return{ruleId:u.ruleIdToNumber(this.ruleId),beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:this.nameScopesList?.getExtensionIfDefined(this.parent?.nameScopesList??null)??[],contentNameScopesList:this.contentNameScopesList?.getExtensionIfDefined(this.nameScopesList)??[]}}static pushFrame(C,T){let D=y.fromExtension(C?.nameScopesList??null,T.nameScopesList);return new l(C,u.ruleIdFromNumber(T.ruleId),T.enterPos??-1,T.anchorPos??-1,T.beginRuleCapturedEOL,T.endRule,D,y.fromExtension(D,T.contentNameScopesList))}}n.StateStackImpl=l,l.NULL=new l(null,0,0,0,!1,null,null,null),n.BalancedBracketSelectors=class{constructor(E,C){this.allowAny=!1,this.balancedBracketScopes=E.flatMap(T=>T==="*"?(this.allowAny=!0,[]):a.createMatchers(T,f).map(D=>D.matcher)),this.unbalancedBracketScopes=C.flatMap(T=>a.createMatchers(T,f).map(D=>D.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(E){for(let C of this.unbalancedBracketScopes)if(C(E))return!1;for(let C of this.balancedBracketScopes)if(C(E))return!0;return this.allowAny}};class x{constructor(C,T,D,F){this.balancedBracketSelectors=F,this._emitBinaryTokens=C,this._tokenTypeOverrides=D,s.DebugFlags.InDebugMode?this._lineText=T:this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(C,T){this.produceFromScopes(C.contentNameScopesList,T)}produceFromScopes(C,T){if(this._lastTokenEndIndex>=T)return;if(this._emitBinaryTokens){let F=C?.tokenAttributes??0,z=!1;if(this.balancedBracketSelectors?.matchesAlways&&(z=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){let H=C?.getScopeNames()??[];for(let Q of this._tokenTypeOverrides)Q.matcher(H)&&(F=o.EncodedTokenAttributes.set(F,0,o.toOptionalTokenType(Q.type),null,-1,0,0));this.balancedBracketSelectors&&(z=this.balancedBracketSelectors.match(H))}if(z&&(F=o.EncodedTokenAttributes.set(F,0,8,z,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===F)return void(this._lastTokenEndIndex=T);if(s.DebugFlags.InDebugMode){let H=C?.getScopeNames()??[];console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,T).replace(/\n$/,"\\n")+"|");for(let Q=0;Q<H.length;Q++)console.log("      * "+H[Q])}return this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(F),void(this._lastTokenEndIndex=T)}let D=C?.getScopeNames()??[];if(s.DebugFlags.InDebugMode){console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,T).replace(/\n$/,"\\n")+"|");for(let F=0;F<D.length;F++)console.log("      * "+D[F])}this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:T,scopes:D}),this._lastTokenEndIndex=T}getResult(C,T){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===T-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(C,T),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(C,T){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===T-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(C,T),this._binaryTokens[this._binaryTokens.length-2]=0);let D=new Uint32Array(this._binaryTokens.length);for(let F=0,z=this._binaryTokens.length;F<z;F++)D[F]=this._binaryTokens[F];return D}}n.LineTokens=x},965:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.parseInclude=n.TopLevelRepositoryReference=n.TopLevelReference=n.RelativeReference=n.SelfReference=n.BaseReference=n.ScopeDependencyProcessor=n.ExternalReferenceCollector=n.TopLevelRepositoryRuleReference=n.TopLevelRuleReference=void 0;let s=i(878);class o{constructor(l){this.scopeName=l}toKey(){return this.scopeName}}n.TopLevelRuleReference=o;class a{constructor(l,x){this.scopeName=l,this.ruleName=x}toKey(){return`${this.scopeName}#${this.ruleName}`}}n.TopLevelRepositoryRuleReference=a;class c{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(l){let x=l.toKey();this._seenReferenceKeys.has(x)||(this._seenReferenceKeys.add(x),this._references.push(l))}}function u(y,l,x,E){let C=x.lookup(y.scopeName);if(!C){if(y.scopeName===l)throw new Error(`No grammar provided for <${l}>`);return}let T=x.lookup(l);y instanceof o?v({baseGrammar:T,selfGrammar:C},E):h(y.ruleName,{baseGrammar:T,selfGrammar:C,repository:C.repository},E);let D=x.injections(y.scopeName);if(D)for(let F of D)E.add(new o(F))}function h(y,l,x){l.repository&&l.repository[y]&&m([l.repository[y]],l,x)}function v(y,l){y.selfGrammar.patterns&&Array.isArray(y.selfGrammar.patterns)&&m(y.selfGrammar.patterns,{...y,repository:y.selfGrammar.repository},l),y.selfGrammar.injections&&m(Object.values(y.selfGrammar.injections),{...y,repository:y.selfGrammar.repository},l)}function m(y,l,x){for(let E of y){if(x.visitedRule.has(E))continue;x.visitedRule.add(E);let C=E.repository?s.mergeObjects({},l.repository,E.repository):l.repository;Array.isArray(E.patterns)&&m(E.patterns,{...l,repository:C},x);let T=E.include;if(!T)continue;let D=S(T);switch(D.kind){case 0:v({...l,selfGrammar:l.baseGrammar},x);break;case 1:v(l,x);break;case 2:h(D.ruleName,{...l,repository:C},x);break;case 3:case 4:let F=D.scopeName===l.selfGrammar.scopeName?l.selfGrammar:D.scopeName===l.baseGrammar.scopeName?l.baseGrammar:void 0;if(F){let z={baseGrammar:l.baseGrammar,selfGrammar:F,repository:C};D.kind===4?h(D.ruleName,z,x):v(z,x)}else D.kind===4?x.add(new a(D.scopeName,D.ruleName)):x.add(new o(D.scopeName))}}}n.ExternalReferenceCollector=c,n.ScopeDependencyProcessor=class{constructor(y,l){this.repo=y,this.initialScopeName=l,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new o(this.initialScopeName)]}processQueue(){let y=this.Q;this.Q=[];let l=new c;for(let x of y)u(x,this.initialScopeName,this.repo,l);for(let x of l.references)if(x instanceof o){if(this.seenFullScopeRequests.has(x.scopeName))continue;this.seenFullScopeRequests.add(x.scopeName),this.Q.push(x)}else{if(this.seenFullScopeRequests.has(x.scopeName)||this.seenPartialScopeRequests.has(x.toKey()))continue;this.seenPartialScopeRequests.add(x.toKey()),this.Q.push(x)}}};class b{constructor(){this.kind=0}}n.BaseReference=b;class k{constructor(){this.kind=1}}n.SelfReference=k;class f{constructor(l){this.ruleName=l,this.kind=2}}n.RelativeReference=f;class _{constructor(l){this.scopeName=l,this.kind=3}}n.TopLevelReference=_;class w{constructor(l,x){this.scopeName=l,this.ruleName=x,this.kind=4}}function S(y){if(y==="$base")return new b;if(y==="$self")return new k;let l=y.indexOf("#");if(l===-1)return new _(y);if(l===0)return new f(y.substring(1));{let x=y.substring(0,l),E=y.substring(l+1);return new w(x,E)}}n.TopLevelRepositoryReference=w,n.parseInclude=S},391:function(t,n,i){var s=this&&this.__createBinding||(Object.create?function(a,c,u,h){h===void 0&&(h=u),Object.defineProperty(a,h,{enumerable:!0,get:function(){return c[u]}})}:function(a,c,u,h){h===void 0&&(h=u),a[h]=c[u]}),o=this&&this.__exportStar||function(a,c){for(var u in a)u==="default"||Object.prototype.hasOwnProperty.call(c,u)||s(c,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),o(i(947),n)},47:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LocalStackElement=n._tokenizeString=void 0;let s=i(350),o=i(44),a=i(792),c=i(878);class u{constructor(w,S){this.stack=w,this.stoppedEarly=S}}function h(_,w,S,y,l,x,E,C){let T=w.content.length,D=!1,F=-1;if(E){let Q=function(J,ie,be,ee,Ae,ae){let Ee=Ae.beginRuleCapturedEOL?0:-1,ge=[];for(let me=Ae;me;me=me.pop()){let De=me.getRule(J);De instanceof a.BeginWhileRule&&ge.push({rule:De,stack:me})}for(let me=ge.pop();me;me=ge.pop()){let{ruleScanner:De,findOptions:Je}=m(me.rule,J,me.stack.endRule,be,ee===Ee),W=De.findNextMatchSync(ie,ee,Je);if(s.DebugFlags.InDebugMode&&(console.log("  scanning for while rule"),console.log(De.toString())),!W){s.DebugFlags.InDebugMode&&console.log("  popping "+me.rule.debugName+" - "+me.rule.debugWhileRegExp),Ae=me.stack.pop();break}if(W.ruleId!==a.whileRuleId){Ae=me.stack.pop();break}W.captureIndices&&W.captureIndices.length&&(ae.produce(me.stack,W.captureIndices[0].start),k(J,ie,be,me.stack,ae,me.rule.whileCaptures,W.captureIndices),ae.produce(me.stack,W.captureIndices[0].end),Ee=W.captureIndices[0].end,W.captureIndices[0].end>ee&&(ee=W.captureIndices[0].end,be=!1))}return{stack:Ae,linePos:ee,anchorPosition:Ee,isFirstLine:be}}(_,w,S,y,l,x);l=Q.stack,y=Q.linePos,S=Q.isFirstLine,F=Q.anchorPosition}let z=Date.now();for(;!D;){if(C!==0&&Date.now()-z>C)return new u(l,!0);H()}return new u(l,!1);function H(){s.DebugFlags.InDebugMode&&(console.log(""),console.log(`@@scanNext ${y}: |${w.content.substr(y).replace(/\n$/,"\\n")}|`));let Q=function(ee,Ae,ae,Ee,ge,me){let De=function(Qe,Et,rt,Gt,Ge,Qt){let wt=Ge.getRule(Qe),{ruleScanner:Zt,findOptions:He}=v(wt,Qe,Ge.endRule,rt,Gt===Qt),ft=0;s.DebugFlags.InDebugMode&&(ft=c.performanceNow());let mt=Zt.findNextMatchSync(Et,Gt,He);if(s.DebugFlags.InDebugMode){let un=c.performanceNow()-ft;un>5&&console.warn(`Rule ${wt.debugName} (${wt.id}) matching took ${un} against '${Et}'`),console.log(`  scanning for (linePos: ${Gt}, anchorPosition: ${Qt})`),console.log(Zt.toString()),mt&&console.log(`matched rule id: ${mt.ruleId} from ${mt.captureIndices[0].start} to ${mt.captureIndices[0].end}`)}return mt?{captureIndices:mt.captureIndices,matchedRuleId:mt.ruleId}:null}(ee,Ae,ae,Ee,ge,me),Je=ee.getInjections();if(Je.length===0)return De;let W=function(Qe,Et,rt,Gt,Ge,Qt,wt){let Zt,He=Number.MAX_VALUE,ft=null,mt=0,un=Qt.contentNameScopesList.getScopeNames();for(let kt=0,mn=Qe.length;kt<mn;kt++){let qt=Qe[kt];if(!qt.matcher(un))continue;let Ft=Et.getRule(qt.ruleId),{ruleScanner:Jt,findOptions:Vt}=v(Ft,Et,null,Gt,Ge===wt),L=Jt.findNextMatchSync(rt,Ge,Vt);if(!L)continue;s.DebugFlags.InDebugMode&&(console.log(`  matched injection: ${qt.debugSelector}`),console.log(Jt.toString()));let I=L.captureIndices[0].start;if(!(I>=He)&&(He=I,ft=L.captureIndices,Zt=L.ruleId,mt=qt.priority,He===Ge))break}return ft?{priorityMatch:mt===-1,captureIndices:ft,matchedRuleId:Zt}:null}(Je,ee,Ae,ae,Ee,ge,me);if(!W)return De;if(!De)return W;let je=De.captureIndices[0].start,ke=W.captureIndices[0].start;return ke<je||W.priorityMatch&&ke===je?W:De}(_,w,S,y,l,F);if(!Q)return s.DebugFlags.InDebugMode&&console.log("  no more matches."),x.produce(l,T),void(D=!0);let J=Q.captureIndices,ie=Q.matchedRuleId,be=!!(J&&J.length>0)&&J[0].end>y;if(ie===a.endRuleId){let ee=l.getRule(_);s.DebugFlags.InDebugMode&&console.log("  popping "+ee.debugName+" - "+ee.debugEndRegExp),x.produce(l,J[0].start),l=l.withContentNameScopesList(l.nameScopesList),k(_,w,S,l,x,ee.endCaptures,J),x.produce(l,J[0].end);let Ae=l;if(l=l.parent,F=Ae.getAnchorPos(),!be&&Ae.getEnterPos()===y)return s.DebugFlags.InDebugMode&&console.error("[1] - Grammar is in an endless loop - Grammar pushed & popped a rule without advancing"),l=Ae,x.produce(l,T),void(D=!0)}else{let ee=_.getRule(ie);x.produce(l,J[0].start);let Ae=l,ae=ee.getName(w.content,J),Ee=l.contentNameScopesList.pushAttributed(ae,_);if(l=l.push(ie,y,F,J[0].end===T,null,Ee,Ee),ee instanceof a.BeginEndRule){let ge=ee;s.DebugFlags.InDebugMode&&console.log("  pushing "+ge.debugName+" - "+ge.debugBeginRegExp),k(_,w,S,l,x,ge.beginCaptures,J),x.produce(l,J[0].end),F=J[0].end;let me=ge.getContentName(w.content,J),De=Ee.pushAttributed(me,_);if(l=l.withContentNameScopesList(De),ge.endHasBackReferences&&(l=l.withEndRule(ge.getEndWithResolvedBackReferences(w.content,J))),!be&&Ae.hasSameRuleAs(l))return s.DebugFlags.InDebugMode&&console.error("[2] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),l=l.pop(),x.produce(l,T),void(D=!0)}else if(ee instanceof a.BeginWhileRule){let ge=ee;s.DebugFlags.InDebugMode&&console.log("  pushing "+ge.debugName),k(_,w,S,l,x,ge.beginCaptures,J),x.produce(l,J[0].end),F=J[0].end;let me=ge.getContentName(w.content,J),De=Ee.pushAttributed(me,_);if(l=l.withContentNameScopesList(De),ge.whileHasBackReferences&&(l=l.withEndRule(ge.getWhileWithResolvedBackReferences(w.content,J))),!be&&Ae.hasSameRuleAs(l))return s.DebugFlags.InDebugMode&&console.error("[3] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),l=l.pop(),x.produce(l,T),void(D=!0)}else{let ge=ee;if(s.DebugFlags.InDebugMode&&console.log("  matched "+ge.debugName+" - "+ge.debugMatchRegExp),k(_,w,S,l,x,ge.captures,J),x.produce(l,J[0].end),l=l.pop(),!be)return s.DebugFlags.InDebugMode&&console.error("[4] - Grammar is in an endless loop - Grammar is not advancing, nor is it pushing/popping"),l=l.safePop(),x.produce(l,T),void(D=!0)}}J[0].end>y&&(y=J[0].end,S=!1)}}function v(_,w,S,y,l){return s.UseOnigurumaFindOptions?{ruleScanner:_.compile(w,S),findOptions:b(y,l)}:{ruleScanner:_.compileAG(w,S,y,l),findOptions:0}}function m(_,w,S,y,l){return s.UseOnigurumaFindOptions?{ruleScanner:_.compileWhile(w,S),findOptions:b(y,l)}:{ruleScanner:_.compileWhileAG(w,S,y,l),findOptions:0}}function b(_,w){let S=0;return _||(S|=1),w||(S|=4),S}function k(_,w,S,y,l,x,E){if(x.length===0)return;let C=w.content,T=Math.min(x.length,E.length),D=[],F=E[0].end;for(let z=0;z<T;z++){let H=x[z];if(H===null)continue;let Q=E[z];if(Q.length===0)continue;if(Q.start>F)break;for(;D.length>0&&D[D.length-1].endPos<=Q.start;)l.produceFromScopes(D[D.length-1].scopes,D[D.length-1].endPos),D.pop();if(D.length>0?l.produceFromScopes(D[D.length-1].scopes,Q.start):l.produce(y,Q.start),H.retokenizeCapturedWithRuleId){let ie=H.getName(C,E),be=y.contentNameScopesList.pushAttributed(ie,_),ee=H.getContentName(C,E),Ae=be.pushAttributed(ee,_),ae=y.push(H.retokenizeCapturedWithRuleId,Q.start,-1,!1,null,be,Ae),Ee=_.createOnigString(C.substring(0,Q.end));h(_,Ee,S&&Q.start===0,Q.start,ae,l,!1,0),o.disposeOnigString(Ee);continue}let J=H.getName(C,E);if(J!==null){let ie=(D.length>0?D[D.length-1].scopes:y.contentNameScopesList).pushAttributed(J,_);D.push(new f(ie,Q.end))}}for(;D.length>0;)l.produceFromScopes(D[D.length-1].scopes,D[D.length-1].endPos),D.pop()}n._tokenizeString=h;class f{constructor(w,S){this.scopes=w,this.endPos=S}}n.LocalStackElement=f},974:(t,n)=>{function i(c,u){throw new Error("Near offset "+c.pos+": "+u+" ~~~"+c.source.substr(c.pos,50)+"~~~")}Object.defineProperty(n,"__esModule",{value:!0}),n.parseJSON=void 0,n.parseJSON=function(c,u,h){let v=new s(c),m=new o,b=0,k=null,f=[],_=[];function w(){f.push(b),_.push(k)}function S(){b=f.pop(),k=_.pop()}function y(l){i(v,l)}for(;a(v,m);){if(b===0){if(k!==null&&y("too many constructs in root"),m.type===3){k={},h&&(k.$vscodeTextmateLocation=m.toLocation(u)),w(),b=1;continue}if(m.type===2){k=[],w(),b=4;continue}y("unexpected token in root")}if(b===2){if(m.type===5){S();continue}if(m.type===7){b=3;continue}y("expected , or }")}if(b===1||b===3){if(b===1&&m.type===5){S();continue}if(m.type===1){let l=m.value;if(a(v,m)&&m.type===6||y("expected colon"),a(v,m)||y("expected value"),b=2,m.type===1){k[l]=m.value;continue}if(m.type===8){k[l]=null;continue}if(m.type===9){k[l]=!0;continue}if(m.type===10){k[l]=!1;continue}if(m.type===11){k[l]=parseFloat(m.value);continue}if(m.type===2){let x=[];k[l]=x,w(),b=4,k=x;continue}if(m.type===3){let x={};h&&(x.$vscodeTextmateLocation=m.toLocation(u)),k[l]=x,w(),b=1,k=x;continue}}y("unexpected token in dict")}if(b===5){if(m.type===4){S();continue}if(m.type===7){b=6;continue}y("expected , or ]")}if(b===4||b===6){if(b===4&&m.type===4){S();continue}if(b=5,m.type===1){k.push(m.value);continue}if(m.type===8){k.push(null);continue}if(m.type===9){k.push(!0);continue}if(m.type===10){k.push(!1);continue}if(m.type===11){k.push(parseFloat(m.value));continue}if(m.type===2){let l=[];k.push(l),w(),b=4,k=l;continue}if(m.type===3){let l={};h&&(l.$vscodeTextmateLocation=m.toLocation(u)),k.push(l),w(),b=1,k=l;continue}y("unexpected token in array")}y("unknown state")}return _.length!==0&&y("unclosed constructs"),k};class s{constructor(u){this.source=u,this.pos=0,this.len=u.length,this.line=1,this.char=0}}class o{constructor(){this.value=null,this.type=0,this.offset=-1,this.len=-1,this.line=-1,this.char=-1}toLocation(u){return{filename:u,line:this.line,char:this.char}}}function a(c,u){u.value=null,u.type=0,u.offset=-1,u.len=-1,u.line=-1,u.char=-1;let h,v=c.source,m=c.pos,b=c.len,k=c.line,f=c.char;for(;;){if(m>=b)return!1;if(h=v.charCodeAt(m),h!==32&&h!==9&&h!==13){if(h!==10)break;m++,k++,f=0}else m++,f++}if(u.offset=m,u.line=k,u.char=f,h===34){for(u.type=1,m++,f++;;){if(m>=b)return!1;if(h=v.charCodeAt(m),m++,f++,h!==92){if(h===34)break}else m++,f++}u.value=v.substring(u.offset+1,m-1).replace(/\\u([0-9A-Fa-f]{4})/g,(_,w)=>String.fromCodePoint(parseInt(w,16))).replace(/\\(.)/g,(_,w)=>{switch(w){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:i(c,"invalid escape sequence")}throw new Error("unreachable")})}else if(h===91)u.type=2,m++,f++;else if(h===123)u.type=3,m++,f++;else if(h===93)u.type=4,m++,f++;else if(h===125)u.type=5,m++,f++;else if(h===58)u.type=6,m++,f++;else if(h===44)u.type=7,m++,f++;else if(h===110){if(u.type=8,m++,f++,h=v.charCodeAt(m),h!==117||(m++,f++,h=v.charCodeAt(m),h!==108)||(m++,f++,h=v.charCodeAt(m),h!==108))return!1;m++,f++}else if(h===116){if(u.type=9,m++,f++,h=v.charCodeAt(m),h!==114||(m++,f++,h=v.charCodeAt(m),h!==117)||(m++,f++,h=v.charCodeAt(m),h!==101))return!1;m++,f++}else if(h===102){if(u.type=10,m++,f++,h=v.charCodeAt(m),h!==97||(m++,f++,h=v.charCodeAt(m),h!==108)||(m++,f++,h=v.charCodeAt(m),h!==115)||(m++,f++,h=v.charCodeAt(m),h!==101))return!1;m++,f++}else for(u.type=11;;){if(m>=b)return!1;if(h=v.charCodeAt(m),!(h===46||h>=48&&h<=57||h===101||h===69||h===45||h===43))break;m++,f++}return u.len=m-u.offset,u.value===null&&(u.value=v.substr(u.offset,u.len)),c.pos=m,c.line=k,c.char=f,!0}},787:function(t,n,i){var s=this&&this.__createBinding||(Object.create?function(b,k,f,_){_===void 0&&(_=f),Object.defineProperty(b,_,{enumerable:!0,get:function(){return k[f]}})}:function(b,k,f,_){_===void 0&&(_=f),b[_]=k[f]}),o=this&&this.__exportStar||function(b,k){for(var f in b)f==="default"||Object.prototype.hasOwnProperty.call(k,f)||s(k,b,f)};Object.defineProperty(n,"__esModule",{value:!0}),n.applyStateStackDiff=n.diffStateStacksRefEq=n.parseRawGrammar=n.INITIAL=n.Registry=void 0;let a=i(391),c=i(50),u=i(652),h=i(583),v=i(965),m=i(442);Object.defineProperty(n,"applyStateStackDiff",{enumerable:!0,get:function(){return m.applyStateStackDiff}}),Object.defineProperty(n,"diffStateStacksRefEq",{enumerable:!0,get:function(){return m.diffStateStacksRefEq}}),o(i(44),n),n.Registry=class{constructor(b){this._options=b,this._syncRegistry=new u.SyncRegistry(h.Theme.createFromRawTheme(b.theme,b.colorMap),b.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(b,k){this._syncRegistry.setTheme(h.Theme.createFromRawTheme(b,k))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(b,k,f){return this.loadGrammarWithConfiguration(b,k,{embeddedLanguages:f})}loadGrammarWithConfiguration(b,k,f){return this._loadGrammar(b,k,f.embeddedLanguages,f.tokenTypes,new a.BalancedBracketSelectors(f.balancedBracketSelectors||[],f.unbalancedBracketSelectors||[]))}loadGrammar(b){return this._loadGrammar(b,0,null,null,null)}async _loadGrammar(b,k,f,_,w){let S=new v.ScopeDependencyProcessor(this._syncRegistry,b);for(;S.Q.length>0;)await Promise.all(S.Q.map(y=>this._loadSingleGrammar(y.scopeName))),S.processQueue();return this._grammarForScopeName(b,k,f,_,w)}async _loadSingleGrammar(b){return this._ensureGrammarCache.has(b)||this._ensureGrammarCache.set(b,this._doLoadSingleGrammar(b)),this._ensureGrammarCache.get(b)}async _doLoadSingleGrammar(b){let k=await this._options.loadGrammar(b);if(k){let f=typeof this._options.getInjections=="function"?this._options.getInjections(b):void 0;this._syncRegistry.addGrammar(k,f)}}async addGrammar(b,k=[],f=0,_=null){return this._syncRegistry.addGrammar(b,k),await this._grammarForScopeName(b.scopeName,f,_)}_grammarForScopeName(b,k=0,f=null,_=null,w=null){return this._syncRegistry.grammarForScopeName(b,k,f,_,w)}},n.INITIAL=a.StateStackImpl.NULL,n.parseRawGrammar=c.parseRawGrammar},736:(t,n)=>{function i(s){return!!s&&!!s.match(/[\w\.:]+/)}Object.defineProperty(n,"__esModule",{value:!0}),n.createMatchers=void 0,n.createMatchers=function(s,o){let a=[],c=function(m){let b=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,k=b.exec(m);return{next:()=>{if(!k)return null;let f=k[0];return k=b.exec(m),f}}}(s),u=c.next();for(;u!==null;){let m=0;if(u.length===2&&u.charAt(1)===":"){switch(u.charAt(0)){case"R":m=1;break;case"L":m=-1;break;default:console.log(`Unknown priority ${u} in scope selector`)}u=c.next()}let b=v();if(a.push({matcher:b,priority:m}),u!==",")break;u=c.next()}return a;function h(){if(u==="-"){u=c.next();let m=h();return b=>!!m&&!m(b)}if(u==="("){u=c.next();let m=function(){let b=[],k=v();for(;k&&(b.push(k),u==="|"||u===",");){do u=c.next();while(u==="|"||u===",");k=v()}return f=>b.some(_=>_(f))}();return u===")"&&(u=c.next()),m}if(i(u)){let m=[];do m.push(u),u=c.next();while(i(u));return b=>o(m,b)}return null}function v(){let m=[],b=h();for(;b;)m.push(b),b=h();return k=>m.every(f=>f(k))}}},44:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.disposeOnigString=void 0,n.disposeOnigString=function(i){typeof i.dispose=="function"&&i.dispose()}},50:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.parseRawGrammar=void 0;let s=i(69),o=i(350),a=i(974);n.parseRawGrammar=function(c,u=null){return u!==null&&/\.json$/.test(u)?(h=c,v=u,o.DebugFlags.InDebugMode?a.parseJSON(h,v,!0):JSON.parse(h)):function(m,b){return o.DebugFlags.InDebugMode?s.parseWithLocation(m,b,"$vscodeTextmateLocation"):s.parsePLIST(m)}(c,u);var h,v}},69:(t,n)=>{function i(s,o,a){let c=s.length,u=0,h=1,v=0;function m(W){if(a===null)u+=W;else for(;W>0;)s.charCodeAt(u)===10?(u++,h++,v=0):(u++,v++),W--}function b(W){a===null?u=W:m(W-u)}function k(){for(;u<c;){let W=s.charCodeAt(u);if(W!==32&&W!==9&&W!==13&&W!==10)break;m(1)}}function f(W){return s.substr(u,W.length)===W&&(m(W.length),!0)}function _(W){let je=s.indexOf(W,u);b(je!==-1?je+W.length:c)}function w(W){let je=s.indexOf(W,u);if(je!==-1){let ke=s.substring(u,je);return b(je+W.length),ke}{let ke=s.substr(u);return b(c),ke}}c>0&&s.charCodeAt(0)===65279&&(u=1);let S=0,y=null,l=[],x=[],E=null;function C(W,je){l.push(S),x.push(y),S=W,y=je}function T(){if(l.length===0)return D("illegal state stack");S=l.pop(),y=x.pop()}function D(W){throw new Error("Near offset "+u+": "+W+" ~~~"+s.substr(u,50)+"~~~")}let F=function(){if(E===null)return D("missing <key>");let W={};a!==null&&(W[a]={filename:o,line:h,char:v}),y[E]=W,E=null,C(1,W)},z=function(){if(E===null)return D("missing <key>");let W=[];y[E]=W,E=null,C(2,W)},H=function(){let W={};a!==null&&(W[a]={filename:o,line:h,char:v}),y.push(W),C(1,W)},Q=function(){let W=[];y.push(W),C(2,W)};function J(){if(S!==1)return D("unexpected </dict>");T()}function ie(){return S===1||S!==2?D("unexpected </array>"):void T()}function be(W){if(S===1){if(E===null)return D("missing <key>");y[E]=W,E=null}else S===2?y.push(W):y=W}function ee(W){if(isNaN(W))return D("cannot parse float");if(S===1){if(E===null)return D("missing <key>");y[E]=W,E=null}else S===2?y.push(W):y=W}function Ae(W){if(isNaN(W))return D("cannot parse integer");if(S===1){if(E===null)return D("missing <key>");y[E]=W,E=null}else S===2?y.push(W):y=W}function ae(W){if(S===1){if(E===null)return D("missing <key>");y[E]=W,E=null}else S===2?y.push(W):y=W}function Ee(W){if(S===1){if(E===null)return D("missing <key>");y[E]=W,E=null}else S===2?y.push(W):y=W}function ge(W){if(S===1){if(E===null)return D("missing <key>");y[E]=W,E=null}else S===2?y.push(W):y=W}function me(){let W=w(">"),je=!1;return W.charCodeAt(W.length-1)===47&&(je=!0,W=W.substring(0,W.length-1)),{name:W.trim(),isClosed:je}}function De(W){if(W.isClosed)return"";let je=w("</");return _(">"),je.replace(/&#([0-9]+);/g,function(ke,Qe){return String.fromCodePoint(parseInt(Qe,10))}).replace(/&#x([0-9a-f]+);/g,function(ke,Qe){return String.fromCodePoint(parseInt(Qe,16))}).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g,function(ke){switch(ke){case"&amp;":return"&";case"&lt;":return"<";case"&gt;":return">";case"&quot;":return'"';case"&apos;":return"'"}return ke})}for(;u<c&&(k(),!(u>=c));){let W=s.charCodeAt(u);if(m(1),W!==60)return D("expected <");if(u>=c)return D("unexpected end of input");let je=s.charCodeAt(u);if(je===63){m(1),_("?>");continue}if(je===33){if(m(1),f("--")){_("-->");continue}_(">");continue}if(je===47){if(m(1),k(),f("plist")){_(">");continue}if(f("dict")){_(">"),J();continue}if(f("array")){_(">"),ie();continue}return D("unexpected closed tag")}let ke=me();switch(ke.name){case"dict":S===1?F():S===2?H():(y={},a!==null&&(y[a]={filename:o,line:h,char:v}),C(1,y)),ke.isClosed&&J();continue;case"array":S===1?z():S===2?Q():(y=[],C(2,y)),ke.isClosed&&ie();continue;case"key":Je=De(ke),S!==1?D("unexpected <key>"):E!==null?D("too many <key>"):E=Je;continue;case"string":be(De(ke));continue;case"real":ee(parseFloat(De(ke)));continue;case"integer":Ae(parseInt(De(ke),10));continue;case"date":ae(new Date(De(ke)));continue;case"data":Ee(De(ke));continue;case"true":De(ke),ge(!0);continue;case"false":De(ke),ge(!1);continue}if(!/^plist/.test(ke.name))return D("unexpected opened tag "+ke.name)}var Je;return y}Object.defineProperty(n,"__esModule",{value:!0}),n.parsePLIST=n.parseWithLocation=void 0,n.parseWithLocation=function(s,o,a){return i(s,o,a)},n.parsePLIST=function(s){return i(s,null,null)}},652:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SyncRegistry=void 0;let s=i(391);n.SyncRegistry=class{constructor(o,a){this._onigLibPromise=a,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=o}dispose(){for(let o of this._grammars.values())o.dispose()}setTheme(o){this._theme=o}getColorMap(){return this._theme.getColorMap()}addGrammar(o,a){this._rawGrammars.set(o.scopeName,o),a&&this._injectionGrammars.set(o.scopeName,a)}lookup(o){return this._rawGrammars.get(o)}injections(o){return this._injectionGrammars.get(o)}getDefaults(){return this._theme.getDefaults()}themeMatch(o){return this._theme.match(o)}async grammarForScopeName(o,a,c,u,h){if(!this._grammars.has(o)){let v=this._rawGrammars.get(o);if(!v)return null;this._grammars.set(o,s.createGrammar(o,v,a,c,u,h,this,await this._onigLibPromise))}return this._grammars.get(o)}}},792:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CompiledRule=n.RegExpSourceList=n.RegExpSource=n.RuleFactory=n.BeginWhileRule=n.BeginEndRule=n.IncludeOnlyRule=n.MatchRule=n.CaptureRule=n.Rule=n.ruleIdToNumber=n.ruleIdFromNumber=n.whileRuleId=n.endRuleId=void 0;let s=i(878),o=i(965),a=/\\(\d+)/,c=/\\(\d+)/g;Symbol("RuleId"),n.endRuleId=-1,n.whileRuleId=-2,n.ruleIdFromNumber=function(y){return y},n.ruleIdToNumber=function(y){return y};class u{constructor(l,x,E,C){this.$location=l,this.id=x,this._name=E||null,this._nameIsCapturing=s.RegexSource.hasCaptures(this._name),this._contentName=C||null,this._contentNameIsCapturing=s.RegexSource.hasCaptures(this._contentName)}get debugName(){let l=this.$location?`${s.basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${l}`}getName(l,x){return this._nameIsCapturing&&this._name!==null&&l!==null&&x!==null?s.RegexSource.replaceCaptures(this._name,l,x):this._name}getContentName(l,x){return this._contentNameIsCapturing&&this._contentName!==null?s.RegexSource.replaceCaptures(this._contentName,l,x):this._contentName}}n.Rule=u;class h extends u{constructor(l,x,E,C,T){super(l,x,E,C),this.retokenizeCapturedWithRuleId=T}dispose(){}collectPatterns(l,x){throw new Error("Not supported!")}compile(l,x){throw new Error("Not supported!")}compileAG(l,x,E,C){throw new Error("Not supported!")}}n.CaptureRule=h;class v extends u{constructor(l,x,E,C,T){super(l,x,E,null),this._match=new _(C,this.id),this.captures=T,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(l,x){x.push(this._match)}compile(l,x){return this._getCachedCompiledPatterns(l).compile(l)}compileAG(l,x,E,C){return this._getCachedCompiledPatterns(l).compileAG(l,E,C)}_getCachedCompiledPatterns(l){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new w,this.collectPatterns(l,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}n.MatchRule=v;class m extends u{constructor(l,x,E,C,T){super(l,x,E,C),this.patterns=T.patterns,this.hasMissingPatterns=T.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(l,x){for(let E of this.patterns)l.getRule(E).collectPatterns(l,x)}compile(l,x){return this._getCachedCompiledPatterns(l).compile(l)}compileAG(l,x,E,C){return this._getCachedCompiledPatterns(l).compileAG(l,E,C)}_getCachedCompiledPatterns(l){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new w,this.collectPatterns(l,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}n.IncludeOnlyRule=m;class b extends u{constructor(l,x,E,C,T,D,F,z,H,Q){super(l,x,E,C),this._begin=new _(T,this.id),this.beginCaptures=D,this._end=new _(F||"\uFFFF",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=z,this.applyEndPatternLast=H||!1,this.patterns=Q.patterns,this.hasMissingPatterns=Q.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(l,x){return this._end.resolveBackReferences(l,x)}collectPatterns(l,x){x.push(this._begin)}compile(l,x){return this._getCachedCompiledPatterns(l,x).compile(l)}compileAG(l,x,E,C){return this._getCachedCompiledPatterns(l,x).compileAG(l,E,C)}_getCachedCompiledPatterns(l,x){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new w;for(let E of this.patterns)l.getRule(E).collectPatterns(l,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,x):this._cachedCompiledPatterns.setSource(0,x)),this._cachedCompiledPatterns}}n.BeginEndRule=b;class k extends u{constructor(l,x,E,C,T,D,F,z,H){super(l,x,E,C),this._begin=new _(T,this.id),this.beginCaptures=D,this.whileCaptures=z,this._while=new _(F,n.whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=H.patterns,this.hasMissingPatterns=H.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(l,x){return this._while.resolveBackReferences(l,x)}collectPatterns(l,x){x.push(this._begin)}compile(l,x){return this._getCachedCompiledPatterns(l).compile(l)}compileAG(l,x,E,C){return this._getCachedCompiledPatterns(l).compileAG(l,E,C)}_getCachedCompiledPatterns(l){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new w;for(let x of this.patterns)l.getRule(x).collectPatterns(l,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(l,x){return this._getCachedCompiledWhilePatterns(l,x).compile(l)}compileWhileAG(l,x,E,C){return this._getCachedCompiledWhilePatterns(l,x).compileAG(l,E,C)}_getCachedCompiledWhilePatterns(l,x){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new w,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,x||"\uFFFF"),this._cachedCompiledWhilePatterns}}n.BeginWhileRule=k;class f{static createCaptureRule(l,x,E,C,T){return l.registerRule(D=>new h(x,D,E,C,T))}static getCompiledRuleId(l,x,E){return l.id||x.registerRule(C=>{if(l.id=C,l.match)return new v(l.$vscodeTextmateLocation,l.id,l.name,l.match,f._compileCaptures(l.captures,x,E));if(l.begin===void 0){l.repository&&(E=s.mergeObjects({},E,l.repository));let T=l.patterns;return T===void 0&&l.include&&(T=[{include:l.include}]),new m(l.$vscodeTextmateLocation,l.id,l.name,l.contentName,f._compilePatterns(T,x,E))}return l.while?new k(l.$vscodeTextmateLocation,l.id,l.name,l.contentName,l.begin,f._compileCaptures(l.beginCaptures||l.captures,x,E),l.while,f._compileCaptures(l.whileCaptures||l.captures,x,E),f._compilePatterns(l.patterns,x,E)):new b(l.$vscodeTextmateLocation,l.id,l.name,l.contentName,l.begin,f._compileCaptures(l.beginCaptures||l.captures,x,E),l.end,f._compileCaptures(l.endCaptures||l.captures,x,E),l.applyEndPatternLast,f._compilePatterns(l.patterns,x,E))}),l.id}static _compileCaptures(l,x,E){let C=[];if(l){let T=0;for(let D in l){if(D==="$vscodeTextmateLocation")continue;let F=parseInt(D,10);F>T&&(T=F)}for(let D=0;D<=T;D++)C[D]=null;for(let D in l){if(D==="$vscodeTextmateLocation")continue;let F=parseInt(D,10),z=0;l[D].patterns&&(z=f.getCompiledRuleId(l[D],x,E)),C[F]=f.createCaptureRule(x,l[D].$vscodeTextmateLocation,l[D].name,l[D].contentName,z)}}return C}static _compilePatterns(l,x,E){let C=[];if(l)for(let T=0,D=l.length;T<D;T++){let F=l[T],z=-1;if(F.include){let H=o.parseInclude(F.include);switch(H.kind){case 0:case 1:z=f.getCompiledRuleId(E[F.include],x,E);break;case 2:let Q=E[H.ruleName];Q&&(z=f.getCompiledRuleId(Q,x,E));break;case 3:case 4:let J=H.scopeName,ie=H.kind===4?H.ruleName:null,be=x.getExternalGrammar(J,E);if(be)if(ie){let ee=be.repository[ie];ee&&(z=f.getCompiledRuleId(ee,x,be.repository))}else z=f.getCompiledRuleId(be.repository.$self,x,be.repository)}}else z=f.getCompiledRuleId(F,x,E);if(z!==-1){let H=x.getRule(z),Q=!1;if((H instanceof m||H instanceof b||H instanceof k)&&H.hasMissingPatterns&&H.patterns.length===0&&(Q=!0),Q)continue;C.push(z)}}return{patterns:C,hasMissingPatterns:(l?l.length:0)!==C.length}}}n.RuleFactory=f;class _{constructor(l,x){if(l){let E=l.length,C=0,T=[],D=!1;for(let F=0;F<E;F++)if(l.charAt(F)==="\\"&&F+1<E){let z=l.charAt(F+1);z==="z"?(T.push(l.substring(C,F)),T.push("$(?!\\n)(?<!\\n)"),C=F+2):z!=="A"&&z!=="G"||(D=!0),F++}this.hasAnchor=D,C===0?this.source=l:(T.push(l.substring(C,E)),this.source=T.join(""))}else this.hasAnchor=!1,this.source=l;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=x,this.hasBackReferences=a.test(this.source)}clone(){return new _(this.source,this.ruleId)}setSource(l){this.source!==l&&(this.source=l,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(l,x){let E=x.map(C=>l.substring(C.start,C.end));return c.lastIndex=0,this.source.replace(c,(C,T)=>s.escapeRegExpCharacters(E[parseInt(T,10)]||""))}_buildAnchorCache(){let l,x,E,C,T=[],D=[],F=[],z=[];for(l=0,x=this.source.length;l<x;l++)E=this.source.charAt(l),T[l]=E,D[l]=E,F[l]=E,z[l]=E,E==="\\"&&l+1<x&&(C=this.source.charAt(l+1),C==="A"?(T[l+1]="\uFFFF",D[l+1]="\uFFFF",F[l+1]="A",z[l+1]="A"):C==="G"?(T[l+1]="\uFFFF",D[l+1]="G",F[l+1]="\uFFFF",z[l+1]="G"):(T[l+1]=C,D[l+1]=C,F[l+1]=C,z[l+1]=C),l++);return{A0_G0:T.join(""),A0_G1:D.join(""),A1_G0:F.join(""),A1_G1:z.join("")}}resolveAnchors(l,x){return this.hasAnchor&&this._anchorCache?l?x?this._anchorCache.A1_G1:this._anchorCache.A1_G0:x?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}}n.RegExpSource=_;class w{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(l){this._items.push(l),this._hasAnchors=this._hasAnchors||l.hasAnchor}unshift(l){this._items.unshift(l),this._hasAnchors=this._hasAnchors||l.hasAnchor}length(){return this._items.length}setSource(l,x){this._items[l].source!==x&&(this._disposeCaches(),this._items[l].setSource(x))}compile(l){if(!this._cached){let x=this._items.map(E=>E.source);this._cached=new S(l,x,this._items.map(E=>E.ruleId))}return this._cached}compileAG(l,x,E){return this._hasAnchors?x?E?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(l,x,E)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(l,x,E)),this._anchorCache.A1_G0):E?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(l,x,E)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(l,x,E)),this._anchorCache.A0_G0):this.compile(l)}_resolveAnchors(l,x,E){let C=this._items.map(T=>T.resolveAnchors(x,E));return new S(l,C,this._items.map(T=>T.ruleId))}}n.RegExpSourceList=w;class S{constructor(l,x,E){this.regExps=x,this.rules=E,this.scanner=l.createOnigScanner(x)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){let l=[];for(let x=0,E=this.rules.length;x<E;x++)l.push("   - "+this.rules[x]+": "+this.regExps[x]);return l.join(`
`)}findNextMatchSync(l,x,E){let C=this.scanner.findNextMatchSync(l,x,E);return C?{ruleId:this.rules[C.index],captureIndices:C.captureIndices}:null}}n.CompiledRule=S},583:(t,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeTrieElement=n.ThemeTrieElementRule=n.ColorMap=n.fontStyleToString=n.ParsedThemeRule=n.parseTheme=n.StyleAttributes=n.ScopeStack=n.Theme=void 0;let s=i(878);class o{constructor(_,w,S){this._colorMap=_,this._defaults=w,this._root=S,this._cachedMatchRoot=new s.CachedFn(y=>this._root.match(y))}static createFromRawTheme(_,w){return this.createFromParsedTheme(h(_),w)}static createFromParsedTheme(_,w){return function(S,y){S.sort((F,z)=>{let H=s.strcmp(F.scope,z.scope);return H!==0?H:(H=s.strArrCmp(F.parentScopes,z.parentScopes),H!==0?H:F.index-z.index)});let l=0,x="#000000",E="#ffffff";for(;S.length>=1&&S[0].scope==="";){let F=S.shift();F.fontStyle!==-1&&(l=F.fontStyle),F.foreground!==null&&(x=F.foreground),F.background!==null&&(E=F.background)}let C=new m(y),T=new u(l,C.getId(x),C.getId(E)),D=new k(new b(0,null,-1,0,0),[]);for(let F=0,z=S.length;F<z;F++){let H=S[F];D.insert(0,H.scope,H.parentScopes,H.fontStyle,C.getId(H.foreground),C.getId(H.background))}return new o(C,T,D)}(_,w)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(_){if(_===null)return this._defaults;let w=_.scopeName,S=this._cachedMatchRoot.get(w).find(y=>function(l,x){if(x===null)return!0;let E=0,C=x[E];for(;l;){if(c(l.scopeName,C)){if(E++,E===x.length)return!0;C=x[E]}l=l.parent}return!1}(_.parent,y.parentScopes));return S?new u(S.fontStyle,S.foreground,S.background):null}}n.Theme=o;class a{constructor(_,w){this.parent=_,this.scopeName=w}static push(_,w){for(let S of w)_=new a(_,S);return _}static from(..._){let w=null;for(let S=0;S<_.length;S++)w=new a(w,_[S]);return w}push(_){return new a(this,_)}getSegments(){let _=this,w=[];for(;_;)w.push(_.scopeName),_=_.parent;return w.reverse(),w}toString(){return this.getSegments().join(" ")}extends(_){return this===_||this.parent!==null&&this.parent.extends(_)}getExtensionIfDefined(_){let w=[],S=this;for(;S&&S!==_;)w.push(S.scopeName),S=S.parent;return S===_?w.reverse():void 0}}function c(f,_){return _===f||f.startsWith(_)&&f[_.length]==="."}n.ScopeStack=a;class u{constructor(_,w,S){this.fontStyle=_,this.foregroundId=w,this.backgroundId=S}}function h(f){if(!f)return[];if(!f.settings||!Array.isArray(f.settings))return[];let _=f.settings,w=[],S=0;for(let y=0,l=_.length;y<l;y++){let x,E=_[y];if(!E.settings)continue;if(typeof E.scope=="string"){let F=E.scope;F=F.replace(/^[,]+/,""),F=F.replace(/[,]+$/,""),x=F.split(",")}else x=Array.isArray(E.scope)?E.scope:[""];let C=-1;if(typeof E.settings.fontStyle=="string"){C=0;let F=E.settings.fontStyle.split(" ");for(let z=0,H=F.length;z<H;z++)switch(F[z]){case"italic":C|=1;break;case"bold":C|=2;break;case"underline":C|=4;break;case"strikethrough":C|=8}}let T=null;typeof E.settings.foreground=="string"&&s.isValidHexColor(E.settings.foreground)&&(T=E.settings.foreground);let D=null;typeof E.settings.background=="string"&&s.isValidHexColor(E.settings.background)&&(D=E.settings.background);for(let F=0,z=x.length;F<z;F++){let H=x[F].trim().split(" "),Q=H[H.length-1],J=null;H.length>1&&(J=H.slice(0,H.length-1),J.reverse()),w[S++]=new v(Q,J,y,C,T,D)}}return w}n.StyleAttributes=u,n.parseTheme=h;class v{constructor(_,w,S,y,l,x){this.scope=_,this.parentScopes=w,this.index=S,this.fontStyle=y,this.foreground=l,this.background=x}}n.ParsedThemeRule=v,n.fontStyleToString=function(f){if(f===-1)return"not set";let _="";return 1&f&&(_+="italic "),2&f&&(_+="bold "),4&f&&(_+="underline "),8&f&&(_+="strikethrough "),_===""&&(_="none"),_.trim()};class m{constructor(_){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(_)){this._isFrozen=!0;for(let w=0,S=_.length;w<S;w++)this._color2id[_[w]]=w,this._id2color[w]=_[w]}else this._isFrozen=!1}getId(_){if(_===null)return 0;_=_.toUpperCase();let w=this._color2id[_];if(w)return w;if(this._isFrozen)throw new Error(`Missing color in color map - ${_}`);return w=++this._lastColorId,this._color2id[_]=w,this._id2color[w]=_,w}getColorMap(){return this._id2color.slice(0)}}n.ColorMap=m;class b{constructor(_,w,S,y,l){this.scopeDepth=_,this.parentScopes=w,this.fontStyle=S,this.foreground=y,this.background=l}clone(){return new b(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(_){let w=[];for(let S=0,y=_.length;S<y;S++)w[S]=_[S].clone();return w}acceptOverwrite(_,w,S,y){this.scopeDepth>_?console.log("how did this happen?"):this.scopeDepth=_,w!==-1&&(this.fontStyle=w),S!==0&&(this.foreground=S),y!==0&&(this.background=y)}}n.ThemeTrieElementRule=b;class k{constructor(_,w=[],S={}){this._mainRule=_,this._children=S,this._rulesWithParentScopes=w}static _sortBySpecificity(_){return _.length===1||_.sort(this._cmpBySpecificity),_}static _cmpBySpecificity(_,w){if(_.scopeDepth===w.scopeDepth){let S=_.parentScopes,y=w.parentScopes,l=S===null?0:S.length,x=y===null?0:y.length;if(l===x)for(let E=0;E<l;E++){let C=S[E].length,T=y[E].length;if(C!==T)return T-C}return x-l}return w.scopeDepth-_.scopeDepth}match(_){if(_==="")return k._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let w,S,y=_.indexOf(".");return y===-1?(w=_,S=""):(w=_.substring(0,y),S=_.substring(y+1)),this._children.hasOwnProperty(w)?this._children[w].match(S):k._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(_,w,S,y,l,x){if(w==="")return void this._doInsertHere(_,S,y,l,x);let E,C,T,D=w.indexOf(".");D===-1?(E=w,C=""):(E=w.substring(0,D),C=w.substring(D+1)),this._children.hasOwnProperty(E)?T=this._children[E]:(T=new k(this._mainRule.clone(),b.cloneArr(this._rulesWithParentScopes)),this._children[E]=T),T.insert(_+1,C,S,y,l,x)}_doInsertHere(_,w,S,y,l){if(w!==null){for(let x=0,E=this._rulesWithParentScopes.length;x<E;x++){let C=this._rulesWithParentScopes[x];if(s.strArrCmp(C.parentScopes,w)===0)return void C.acceptOverwrite(_,S,y,l)}S===-1&&(S=this._mainRule.fontStyle),y===0&&(y=this._mainRule.foreground),l===0&&(l=this._mainRule.background),this._rulesWithParentScopes.push(new b(_,w,S,y,l))}else this._mainRule.acceptOverwrite(_,S,y,l)}}n.ThemeTrieElement=k},878:(t,n)=>{function i(a){return Array.isArray(a)?function(c){let u=[];for(let h=0,v=c.length;h<v;h++)u[h]=i(c[h]);return u}(a):typeof a=="object"?function(c){let u={};for(let h in c)u[h]=i(c[h]);return u}(a):a}Object.defineProperty(n,"__esModule",{value:!0}),n.performanceNow=n.CachedFn=n.escapeRegExpCharacters=n.isValidHexColor=n.strArrCmp=n.strcmp=n.RegexSource=n.basename=n.mergeObjects=n.clone=void 0,n.clone=function(a){return i(a)},n.mergeObjects=function(a,...c){return c.forEach(u=>{for(let h in u)a[h]=u[h]}),a},n.basename=function a(c){let u=~c.lastIndexOf("/")||~c.lastIndexOf("\\");return u===0?c:~u==c.length-1?a(c.substring(0,c.length-1)):c.substr(1+~u)};let s=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;function o(a,c){return a<c?-1:a>c?1:0}n.RegexSource=class{static hasCaptures(a){return a!==null&&(s.lastIndex=0,s.test(a))}static replaceCaptures(a,c,u){return a.replace(s,(h,v,m,b)=>{let k=u[parseInt(v||m,10)];if(!k)return h;{let f=c.substring(k.start,k.end);for(;f[0]===".";)f=f.substring(1);switch(b){case"downcase":return f.toLowerCase();case"upcase":return f.toUpperCase();default:return f}}})}},n.strcmp=o,n.strArrCmp=function(a,c){if(a===null&&c===null)return 0;if(!a)return-1;if(!c)return 1;let u=a.length,h=c.length;if(u===h){for(let v=0;v<u;v++){let m=o(a[v],c[v]);if(m!==0)return m}return 0}return u-h},n.isValidHexColor=function(a){return!!(/^#[0-9a-f]{6}$/i.test(a)||/^#[0-9a-f]{8}$/i.test(a)||/^#[0-9a-f]{3}$/i.test(a)||/^#[0-9a-f]{4}$/i.test(a))},n.escapeRegExpCharacters=function(a){return a.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")},n.CachedFn=class{constructor(a){this.fn=a,this.cache=new Map}get(a){if(this.cache.has(a))return this.cache.get(a);let c=this.fn(a);return this.cache.set(a,c),c}},n.performanceNow=typeof performance>"u"?function(){return Date.now()}:function(){return performance.now()}}},e={};return function t(n){var i=e[n];if(i!==void 0)return i.exports;var s=e[n]={exports:{}};return r[n].call(s.exports,s,s.exports,t),s.exports}(787)})()})});var jy=B((Fo,Xh)=>{(function(r,e){typeof Fo=="object"&&typeof Xh=="object"?Xh.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Fo=="object"?Fo.onig=e():r.onig=e()})(Fo,()=>{return r={770:function(t,n,i){"use strict";var s=this&&this.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(n,"__esModule",{value:!0}),n.setDefaultDebugCall=n.createOnigScanner=n.createOnigString=n.loadWASM=n.OnigScanner=n.OnigString=void 0;let o=s(i(418)),a=null,c=!1;class u{static _utf8ByteLength(f){let _=0;for(let w=0,S=f.length;w<S;w++){let y=f.charCodeAt(w),l=y,x=!1;if(y>=55296&&y<=56319&&w+1<S){let E=f.charCodeAt(w+1);E>=56320&&E<=57343&&(l=65536+(y-55296<<10)|E-56320,x=!0)}_+=l<=127?1:l<=2047?2:l<=65535?3:4,x&&w++}return _}constructor(f){let _=f.length,w=u._utf8ByteLength(f),S=w!==_,y=S?new Uint32Array(_+1):null;S&&(y[_]=w);let l=S?new Uint32Array(w+1):null;S&&(l[w]=_);let x=new Uint8Array(w),E=0;for(let C=0;C<_;C++){let T=f.charCodeAt(C),D=T,F=!1;if(T>=55296&&T<=56319&&C+1<_){let z=f.charCodeAt(C+1);z>=56320&&z<=57343&&(D=65536+(T-55296<<10)|z-56320,F=!0)}S&&(y[C]=E,F&&(y[C+1]=E),D<=127?l[E+0]=C:D<=2047?(l[E+0]=C,l[E+1]=C):D<=65535?(l[E+0]=C,l[E+1]=C,l[E+2]=C):(l[E+0]=C,l[E+1]=C,l[E+2]=C,l[E+3]=C)),D<=127?x[E++]=D:D<=2047?(x[E++]=192|(1984&D)>>>6,x[E++]=128|(63&D)>>>0):D<=65535?(x[E++]=224|(61440&D)>>>12,x[E++]=128|(4032&D)>>>6,x[E++]=128|(63&D)>>>0):(x[E++]=240|(1835008&D)>>>18,x[E++]=128|(258048&D)>>>12,x[E++]=128|(4032&D)>>>6,x[E++]=128|(63&D)>>>0),F&&C++}this.utf16Length=_,this.utf8Length=w,this.utf16Value=f,this.utf8Value=x,this.utf16OffsetToUtf8=y,this.utf8OffsetToUtf16=l}createString(f){let _=f._omalloc(this.utf8Length);return f.HEAPU8.set(this.utf8Value,_),_}}class h{constructor(f){if(this.id=++h.LAST_ID,!a)throw new Error("Must invoke loadWASM first.");this._onigBinding=a,this.content=f;let _=new u(f);this.utf16Length=_.utf16Length,this.utf8Length=_.utf8Length,this.utf16OffsetToUtf8=_.utf16OffsetToUtf8,this.utf8OffsetToUtf16=_.utf8OffsetToUtf16,this.utf8Length<1e4&&!h._sharedPtrInUse?(h._sharedPtr||(h._sharedPtr=a._omalloc(1e4)),h._sharedPtrInUse=!0,a.HEAPU8.set(_.utf8Value,h._sharedPtr),this.ptr=h._sharedPtr):this.ptr=_.createString(a)}convertUtf8OffsetToUtf16(f){return this.utf8OffsetToUtf16?f<0?0:f>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[f]:f}convertUtf16OffsetToUtf8(f){return this.utf16OffsetToUtf8?f<0?0:f>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[f]:f}dispose(){this.ptr===h._sharedPtr?h._sharedPtrInUse=!1:this._onigBinding._ofree(this.ptr)}}n.OnigString=h,h.LAST_ID=0,h._sharedPtr=0,h._sharedPtrInUse=!1;class v{constructor(f,_){var w,S;if(!a)throw new Error("Must invoke loadWASM first.");let y=[],l=[];for(let F=0,z=f.length;F<z;F++){let H=new u(f[F]);y[F]=H.createString(a),l[F]=H.utf8Length}let x=a._omalloc(4*f.length);a.HEAPU32.set(y,x/4);let E=a._omalloc(4*f.length);a.HEAPU32.set(l,E/4),this._onigBinding=a,this._options=(w=_?.options)!==null&&w!==void 0?w:[10];let C=this.onigOptions(this._options),T=this.onigSyntax((S=_?.syntax)!==null&&S!==void 0?S:0),D=a._createOnigScanner(x,E,f.length,C,T);this._ptr=D;for(let F=0,z=f.length;F<z;F++)a._ofree(y[F]);a._ofree(E),a._ofree(x),D===0&&function(F){throw new Error(F.UTF8ToString(F._getLastOnigError()))}(a)}dispose(){this._onigBinding._freeOnigScanner(this._ptr)}findNextMatchSync(f,_,w){let S=c,y=this._options;if(Array.isArray(w)?(w.includes(25)&&(S=!0),y=y.concat(w)):typeof w=="boolean"&&(S=w),typeof f=="string"){f=new h(f);let l=this._findNextMatchSync(f,_,S,y);return f.dispose(),l}return this._findNextMatchSync(f,_,S,y)}_findNextMatchSync(f,_,w,S){let y=this._onigBinding,l=this.onigOptions(S),x;if(x=w?y._findNextOnigScannerMatchDbg(this._ptr,f.id,f.ptr,f.utf8Length,f.convertUtf16OffsetToUtf8(_),l):y._findNextOnigScannerMatch(this._ptr,f.id,f.ptr,f.utf8Length,f.convertUtf16OffsetToUtf8(_),l),x===0)return null;let E=y.HEAPU32,C=x/4,T=E[C++],D=E[C++],F=[];for(let z=0;z<D;z++){let H=f.convertUtf8OffsetToUtf16(E[C++]),Q=f.convertUtf8OffsetToUtf16(E[C++]);F[z]={start:H,end:Q,length:Q-H}}return{index:T,captureIndices:F}}onigOptions(f){return f.map(_=>this.onigOption(_)).reduce((_,w)=>_|w,this._onigBinding.ONIG_OPTION_NONE)}onigSyntax(f){switch(f){case 0:return this._onigBinding.ONIG_SYNTAX_DEFAULT;case 1:return this._onigBinding.ONIG_SYNTAX_ASIS;case 2:return this._onigBinding.ONIG_SYNTAX_POSIX_BASIC;case 3:return this._onigBinding.ONIG_SYNTAX_POSIX_EXTENDED;case 4:return this._onigBinding.ONIG_SYNTAX_EMACS;case 5:return this._onigBinding.ONIG_SYNTAX_GREP;case 6:return this._onigBinding.ONIG_SYNTAX_GNU_REGEX;case 7:return this._onigBinding.ONIG_SYNTAX_JAVA;case 8:return this._onigBinding.ONIG_SYNTAX_PERL;case 9:return this._onigBinding.ONIG_SYNTAX_PERL_NG;case 10:return this._onigBinding.ONIG_SYNTAX_RUBY;case 11:return this._onigBinding.ONIG_SYNTAX_PYTHON;case 12:return this._onigBinding.ONIG_SYNTAX_ONIGURUMA}}onigOption(f){switch(f){case 1:return this._onigBinding.ONIG_OPTION_NONE;case 0:case 25:return this._onigBinding.ONIG_OPTION_DEFAULT;case 2:return this._onigBinding.ONIG_OPTION_IGNORECASE;case 3:return this._onigBinding.ONIG_OPTION_EXTEND;case 4:return this._onigBinding.ONIG_OPTION_MULTILINE;case 5:return this._onigBinding.ONIG_OPTION_SINGLELINE;case 6:return this._onigBinding.ONIG_OPTION_FIND_LONGEST;case 7:return this._onigBinding.ONIG_OPTION_FIND_NOT_EMPTY;case 8:return this._onigBinding.ONIG_OPTION_NEGATE_SINGLELINE;case 9:return this._onigBinding.ONIG_OPTION_DONT_CAPTURE_GROUP;case 10:return this._onigBinding.ONIG_OPTION_CAPTURE_GROUP;case 11:return this._onigBinding.ONIG_OPTION_NOTBOL;case 12:return this._onigBinding.ONIG_OPTION_NOTEOL;case 13:return this._onigBinding.ONIG_OPTION_CHECK_VALIDITY_OF_STRING;case 14:return this._onigBinding.ONIG_OPTION_IGNORECASE_IS_ASCII;case 15:return this._onigBinding.ONIG_OPTION_WORD_IS_ASCII;case 16:return this._onigBinding.ONIG_OPTION_DIGIT_IS_ASCII;case 17:return this._onigBinding.ONIG_OPTION_SPACE_IS_ASCII;case 18:return this._onigBinding.ONIG_OPTION_POSIX_IS_ASCII;case 19:return this._onigBinding.ONIG_OPTION_TEXT_SEGMENT_EXTENDED_GRAPHEME_CLUSTER;case 20:return this._onigBinding.ONIG_OPTION_TEXT_SEGMENT_WORD;case 21:return this._onigBinding.ONIG_OPTION_NOT_BEGIN_STRING;case 22:return this._onigBinding.ONIG_OPTION_NOT_END_STRING;case 23:return this._onigBinding.ONIG_OPTION_NOT_BEGIN_POSITION;case 24:return this._onigBinding.ONIG_OPTION_CALLBACK_EACH_MATCH}}}n.OnigScanner=v;let m=!1,b=null;n.loadWASM=function(k){if(m)return b;let f,_,w,S;if(m=!0,function(y){return typeof y.instantiator=="function"}(k))f=k.instantiator,_=k.print;else{let y;(function(l){return l.data!==void 0})(k)?(y=k.data,_=k.print):y=k,f=function(l){return typeof Response<"u"&&l instanceof Response}(y)?typeof WebAssembly.instantiateStreaming=="function"?function(l){return x=>WebAssembly.instantiateStreaming(l,x)}(y):function(l){return async x=>{let E=await l.arrayBuffer();return WebAssembly.instantiate(E,x)}}(y):function(l){return x=>WebAssembly.instantiate(l,x)}(y)}return b=new Promise((y,l)=>{w=y,S=l}),function(y,l,x,E){(0,o.default)({print:l,instantiateWasm:(C,T)=>{if(typeof performance>"u"){let D=()=>Date.now();C.env.emscripten_get_now=D,C.wasi_snapshot_preview1.emscripten_get_now=D}return y(C).then(D=>T(D.instance),E),{}}}).then(C=>{a=C,x()})}(f,_,w,S),b},n.createOnigString=function(k){return new h(k)},n.createOnigScanner=function(k){return new v(k)},n.setDefaultDebugCall=function(k){c=k}},418:t=>{var n=(typeof document<"u"&&document.currentScript&&document.currentScript.src,function(i={}){var s,o,a=i;a.ready=new Promise((M,j)=>{s=M,o=j});var c,u=Object.assign({},a);typeof read<"u"&&read,c=M=>{if(typeof readbuffer=="function")return new Uint8Array(readbuffer(M));let j=read(M,"binary");return typeof j=="object"||J(G),j;var G},typeof clearTimeout>"u"&&(globalThis.clearTimeout=M=>{}),typeof setTimeout>"u"&&(globalThis.setTimeout=M=>typeof M=="function"?M():J()),typeof scriptArgs<"u"&&scriptArgs,typeof onig_print<"u"&&(typeof console>"u"&&(console={}),console.log=onig_print,console.warn=console.error=typeof printErr<"u"?printErr:onig_print);var h,v,m=a.print||console.log.bind(console),b=a.printErr||console.error.bind(console);Object.assign(a,u),u=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit,a.wasmBinary&&(h=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&J("no native wasm support detected");var k,f,_,w,S,y,l,x,E=!1;function C(){var M=v.buffer;a.HEAP8=k=new Int8Array(M),a.HEAP16=_=new Int16Array(M),a.HEAPU8=f=new Uint8Array(M),a.HEAPU16=w=new Uint16Array(M),a.HEAP32=S=new Int32Array(M),a.HEAPU32=y=new Uint32Array(M),a.HEAPF32=l=new Float32Array(M),a.HEAPF64=x=new Float64Array(M)}var T=[],D=[],F=[],z=0,H=null,Q=null;function J(M){a.onAbort&&a.onAbort(M),b(M="Aborted("+M+")"),E=!0,M+=". Build with -sASSERTIONS for more info.";var j=new WebAssembly.RuntimeError(M);throw o(j),j}var ie,be;function ee(M){return M.startsWith("data:application/octet-stream;base64,")}function Ae(M){if(M==ie&&h)return new Uint8Array(h);if(c)return c(M);throw"both async and sync fetching of the wasm failed"}function ae(M,j,G){return function(V){return Promise.resolve().then(()=>Ae(V))}(M).then(V=>WebAssembly.instantiate(V,j)).then(V=>V).then(G,V=>{b(`failed to asynchronously prepare wasm: ${V}`),J(V)})}ee(ie="onig.wasm")||(be=ie,ie=a.locateFile?a.locateFile(be,""):""+be);var Ee=M=>{for(;M.length>0;)M.shift()(a)},ge=void 0,me=M=>{for(var j="",G=M;f[G];)j+=ge[f[G++]];return j},De={},Je={},W={},je=void 0,ke=M=>{throw new je(M)},Qe=void 0,Et=(M,j,G)=>{function V(Ie){var Ce=G(Ie);Ce.length!==M.length&&(U=>{throw new Qe(U)})("Mismatched type converter count");for(var g=0;g<M.length;++g)rt(M[g],Ce[g])}M.forEach(function(Ie){W[Ie]=j});var X=new Array(j.length),te=[],fe=0;j.forEach((Ie,Ce)=>{Je.hasOwnProperty(Ie)?X[Ce]=Je[Ie]:(te.push(Ie),De.hasOwnProperty(Ie)||(De[Ie]=[]),De[Ie].push(()=>{X[Ce]=Je[Ie],++fe===te.length&&V(X)}))}),te.length===0&&V(X)};function rt(M,j,G={}){if(!("argPackAdvance"in j))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(V,X,te={}){var fe=X.name;if(V||ke(`type "${fe}" must have a positive integer typeid pointer`),Je.hasOwnProperty(V)){if(te.ignoreDuplicateRegistrations)return;ke(`Cannot register type '${fe}' twice`)}if(Je[V]=X,delete W[V],De.hasOwnProperty(V)){var Ie=De[V];delete De[V],Ie.forEach(Ce=>Ce())}}(M,j,G)}function Gt(){this.allocated=[void 0],this.freelist=[]}var Ge=new Gt,Qt=()=>{for(var M=0,j=Ge.reserved;j<Ge.allocated.length;++j)Ge.allocated[j]!==void 0&&++M;return M},wt=M=>(M||ke("Cannot use deleted val. handle = "+M),Ge.get(M).value),Zt=M=>{switch(M){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Ge.allocate({refcount:1,value:M})}};function He(M){return this.fromWireType(S[M>>2])}var ft=(M,j)=>{switch(j){case 4:return function(G){return this.fromWireType(l[G>>2])};case 8:return function(G){return this.fromWireType(x[G>>3])};default:throw new TypeError(`invalid float width (${j}): ${M}`)}},mt=(M,j,G)=>{switch(j){case 1:return G?V=>k[V>>0]:V=>f[V>>0];case 2:return G?V=>_[V>>1]:V=>w[V>>1];case 4:return G?V=>S[V>>2]:V=>y[V>>2];default:throw new TypeError(`invalid integer width (${j}): ${M}`)}};function un(M){return this.fromWireType(y[M>>2])}var kt,mn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,qt=(M,j,G)=>{for(var V=j+G,X=j;M[X]&&!(X>=V);)++X;if(X-j>16&&M.buffer&&mn)return mn.decode(M.subarray(j,X));for(var te="";j<X;){var fe=M[j++];if(128&fe){var Ie=63&M[j++];if((224&fe)!=192){var Ce=63&M[j++];if((fe=(240&fe)==224?(15&fe)<<12|Ie<<6|Ce:(7&fe)<<18|Ie<<12|Ce<<6|63&M[j++])<65536)te+=String.fromCharCode(fe);else{var g=fe-65536;te+=String.fromCharCode(55296|g>>10,56320|1023&g)}}else te+=String.fromCharCode((31&fe)<<6|Ie)}else te+=String.fromCharCode(fe)}return te},Ft=(M,j)=>M?qt(f,M,j):"",Jt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Vt=(M,j)=>{for(var G=M,V=G>>1,X=V+j/2;!(V>=X)&&w[V];)++V;if((G=V<<1)-M>32&&Jt)return Jt.decode(f.subarray(M,G));for(var te="",fe=0;!(fe>=j/2);++fe){var Ie=_[M+2*fe>>1];if(Ie==0)break;te+=String.fromCharCode(Ie)}return te},L=(M,j,G)=>{if(G===void 0&&(G=2147483647),G<2)return 0;for(var V=j,X=(G-=2)<2*M.length?G/2:M.length,te=0;te<X;++te){var fe=M.charCodeAt(te);_[j>>1]=fe,j+=2}return _[j>>1]=0,j-V},I=M=>2*M.length,R=(M,j)=>{for(var G=0,V="";!(G>=j/4);){var X=S[M+4*G>>2];if(X==0)break;if(++G,X>=65536){var te=X-65536;V+=String.fromCharCode(55296|te>>10,56320|1023&te)}else V+=String.fromCharCode(X)}return V},O=(M,j,G)=>{if(G===void 0&&(G=2147483647),G<4)return 0;for(var V=j,X=V+G-4,te=0;te<M.length;++te){var fe=M.charCodeAt(te);if(fe>=55296&&fe<=57343&&(fe=65536+((1023&fe)<<10)|1023&M.charCodeAt(++te)),S[j>>2]=fe,(j+=4)+4>X)break}return S[j>>2]=0,j-V},q=M=>{for(var j=0,G=0;G<M.length;++G){var V=M.charCodeAt(G);V>=55296&&V<=57343&&++G,j+=4}return j};kt=()=>performance.now();var d=M=>{var j=(M-v.buffer.byteLength+65535)/65536;try{return v.grow(j),C(),1}catch{}},p=[null,[],[]];(()=>{for(var M=new Array(256),j=0;j<256;++j)M[j]=String.fromCharCode(j);ge=M})(),je=a.BindingError=class extends Error{constructor(M){super(M),this.name="BindingError"}},Qe=a.InternalError=class extends Error{constructor(M){super(M),this.name="InternalError"}},Object.assign(Gt.prototype,{get(M){return this.allocated[M]},has(M){return this.allocated[M]!==void 0},allocate(M){var j=this.freelist.pop()||this.allocated.length;return this.allocated[j]=M,j},free(M){this.allocated[M]=void 0,this.freelist.push(M)}}),Ge.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),Ge.reserved=Ge.allocated.length,a.count_emval_handles=Qt;var A,$={_embind_register_bigint:(M,j,G,V,X)=>{},_embind_register_bool:(M,j,G,V)=>{rt(M,{name:j=me(j),fromWireType:function(X){return!!X},toWireType:function(X,te){return te?G:V},argPackAdvance:8,readValueFromPointer:function(X){return this.fromWireType(f[X])},destructorFunction:null})},_embind_register_constant:(M,j,G)=>{M=me(M),Et([],[j],function(V){return V=V[0],a[M]=V.fromWireType(G),[]})},_embind_register_emval:(M,j)=>{rt(M,{name:j=me(j),fromWireType:G=>{var V=wt(G);return(X=>{X>=Ge.reserved&&--Ge.get(X).refcount==0&&Ge.free(X)})(G),V},toWireType:(G,V)=>Zt(V),argPackAdvance:8,readValueFromPointer:He,destructorFunction:null})},_embind_register_float:(M,j,G)=>{rt(M,{name:j=me(j),fromWireType:V=>V,toWireType:(V,X)=>X,argPackAdvance:8,readValueFromPointer:ft(j,G),destructorFunction:null})},_embind_register_integer:(M,j,G,V,X)=>{j=me(j),X===-1&&(X=4294967295);var te=Ce=>Ce;if(V===0){var fe=32-8*G;te=Ce=>Ce<<fe>>>fe}var Ie=j.includes("unsigned");rt(M,{name:j,fromWireType:te,toWireType:Ie?function(Ce,g){return this.name,g>>>0}:function(Ce,g){return this.name,g},argPackAdvance:8,readValueFromPointer:mt(j,G,V!==0),destructorFunction:null})},_embind_register_memory_view:(M,j,G)=>{var V=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][j];function X(te){var fe=y[te>>2],Ie=y[te+4>>2];return new V(k.buffer,Ie,fe)}rt(M,{name:G=me(G),fromWireType:X,argPackAdvance:8,readValueFromPointer:X},{ignoreDuplicateRegistrations:!0})},_embind_register_std_string:(M,j)=>{var G=(j=me(j))==="std::string";rt(M,{name:j,fromWireType:V=>{var X,te=y[V>>2],fe=V+4;if(G)for(var Ie=fe,Ce=0;Ce<=te;++Ce){var g=fe+Ce;if(Ce==te||f[g]==0){var U=Ft(Ie,g-Ie);X===void 0?X=U:(X+=String.fromCharCode(0),X+=U),Ie=g+1}}else{var Z=new Array(te);for(Ce=0;Ce<te;++Ce)Z[Ce]=String.fromCharCode(f[fe+Ce]);X=Z.join("")}return Re(V),X},toWireType:(V,X)=>{var te;X instanceof ArrayBuffer&&(X=new Uint8Array(X));var fe=typeof X=="string";fe||X instanceof Uint8Array||X instanceof Uint8ClampedArray||X instanceof Int8Array||ke("Cannot pass non-string to std::string"),te=G&&fe?(Z=>{for(var ve=0,_e=0;_e<Z.length;++_e){var Tt=Z.charCodeAt(_e);Tt<=127?ve++:Tt<=2047?ve+=2:Tt>=55296&&Tt<=57343?(ve+=4,++_e):ve+=3}return ve})(X):X.length;var Ie=se(4+te+1),Ce=Ie+4;if(y[Ie>>2]=te,G&&fe)((Z,ve,_e,Tt)=>{if(!(Tt>0))return 0;for(var Wn=_e,Mo=_e+Tt-1,$o=0;$o<Z.length;++$o){var Mt=Z.charCodeAt($o);if(Mt>=55296&&Mt<=57343&&(Mt=65536+((1023&Mt)<<10)|1023&Z.charCodeAt(++$o)),Mt<=127){if(_e>=Mo)break;ve[_e++]=Mt}else if(Mt<=2047){if(_e+1>=Mo)break;ve[_e++]=192|Mt>>6,ve[_e++]=128|63&Mt}else if(Mt<=65535){if(_e+2>=Mo)break;ve[_e++]=224|Mt>>12,ve[_e++]=128|Mt>>6&63,ve[_e++]=128|63&Mt}else{if(_e+3>=Mo)break;ve[_e++]=240|Mt>>18,ve[_e++]=128|Mt>>12&63,ve[_e++]=128|Mt>>6&63,ve[_e++]=128|63&Mt}}ve[_e]=0})(X,f,Ce,te+1);else if(fe)for(var g=0;g<te;++g){var U=X.charCodeAt(g);U>255&&(Re(Ce),ke("String has UTF-16 code units that do not fit in 8 bits")),f[Ce+g]=U}else for(g=0;g<te;++g)f[Ce+g]=X[g];return V!==null&&V.push(Re,Ie),Ie},argPackAdvance:8,readValueFromPointer:un,destructorFunction:V=>Re(V)})},_embind_register_std_wstring:(M,j,G)=>{var V,X,te,fe,Ie;G=me(G),j===2?(V=Vt,X=L,fe=I,te=()=>w,Ie=1):j===4&&(V=R,X=O,fe=q,te=()=>y,Ie=2),rt(M,{name:G,fromWireType:Ce=>{for(var g,U=y[Ce>>2],Z=te(),ve=Ce+4,_e=0;_e<=U;++_e){var Tt=Ce+4+_e*j;if(_e==U||Z[Tt>>Ie]==0){var Wn=V(ve,Tt-ve);g===void 0?g=Wn:(g+=String.fromCharCode(0),g+=Wn),ve=Tt+j}}return Re(Ce),g},toWireType:(Ce,g)=>{typeof g!="string"&&ke(`Cannot pass non-string to C++ string type ${G}`);var U=fe(g),Z=se(4+U+j);return y[Z>>2]=U>>Ie,X(g,Z+4,U+j),Ce!==null&&Ce.push(Re,Z),Z},argPackAdvance:8,readValueFromPointer:He,destructorFunction:Ce=>Re(Ce)})},_embind_register_void:(M,j)=>{rt(M,{isVoid:!0,name:j=me(j),argPackAdvance:0,fromWireType:()=>{},toWireType:(G,V)=>{}})},emscripten_get_now:kt,emscripten_memcpy_big:(M,j,G)=>f.copyWithin(M,j,j+G),emscripten_resize_heap:M=>{var j=f.length,G=2147483648;if((M>>>=0)>G)return!1;for(var V,X=1;X<=4;X*=2){var te=j*(1+.2/X);te=Math.min(te,M+100663296);var fe=Math.min(G,(V=Math.max(M,te))+(65536-V%65536)%65536);if(d(fe))return!0}return!1},fd_write:(M,j,G,V)=>{for(var X=0,te=0;te<G;te++){var fe=y[j>>2],Ie=y[j+4>>2];j+=8;for(var Ce=0;Ce<Ie;Ce++)g=M,U=f[fe+Ce],Z=void 0,Z=p[g],U===0||U===10?((g===1?m:b)(qt(Z,0)),Z.length=0):Z.push(U);X+=Ie}var g,U,Z;return y[V>>2]=X,0}},Y=function(){var M,j,G,V,X={env:$,wasi_snapshot_preview1:$};function te(fe,Ie){var Ce,g=fe.exports;return v=(Y=g).memory,C(),Y.__indirect_function_table,Ce=Y.__wasm_call_ctors,D.unshift(Ce),function(U){if(z--,a.monitorRunDependencies&&a.monitorRunDependencies(z),z==0&&(H!==null&&(clearInterval(H),H=null),Q)){var Z=Q;Q=null,Z()}}(),g}if(z++,a.monitorRunDependencies&&a.monitorRunDependencies(z),a.instantiateWasm)try{return a.instantiateWasm(X,te)}catch(fe){b(`Module.instantiateWasm callback failed with error: ${fe}`),o(fe)}return(M=h,j=ie,G=X,V=function(fe){te(fe.instance)},M||typeof WebAssembly.instantiateStreaming!="function"||ee(j)||typeof fetch!="function"?ae(j,G,V):fetch(j,{credentials:"same-origin"}).then(fe=>WebAssembly.instantiateStreaming(fe,G).then(V,function(Ie){return b(`wasm streaming compile failed: ${Ie}`),b("falling back to ArrayBuffer instantiation"),ae(j,G,V)}))).catch(o),{}}(),se=M=>(se=Y.malloc)(M),Re=M=>(Re=Y.free)(M);function Ue(){function M(){A||(A=!0,a.calledRun=!0,E||(Ee(D),s(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),function(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)j=a.postRun.shift(),F.unshift(j);var j;Ee(F)}()))}z>0||(function(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)j=a.preRun.shift(),T.unshift(j);var j;Ee(T)}(),z>0||(a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),M()},1)):M()))}if(a._omalloc=M=>(a._omalloc=Y.omalloc)(M),a._ofree=M=>(a._ofree=Y.ofree)(M),a._getLastOnigError=()=>(a._getLastOnigError=Y.getLastOnigError)(),a._createOnigScanner=(M,j,G,V,X)=>(a._createOnigScanner=Y.createOnigScanner)(M,j,G,V,X),a._freeOnigScanner=M=>(a._freeOnigScanner=Y.freeOnigScanner)(M),a._findNextOnigScannerMatch=(M,j,G,V,X,te)=>(a._findNextOnigScannerMatch=Y.findNextOnigScannerMatch)(M,j,G,V,X,te),a._findNextOnigScannerMatchDbg=(M,j,G,V,X,te)=>(a._findNextOnigScannerMatchDbg=Y.findNextOnigScannerMatchDbg)(M,j,G,V,X,te),a.__embind_initialize_bindings=()=>(a.__embind_initialize_bindings=Y._embind_initialize_bindings)(),a.dynCall_jiji=(M,j,G,V,X)=>(a.dynCall_jiji=Y.dynCall_jiji)(M,j,G,V,X),a.UTF8ToString=Ft,Q=function M(){A||Ue(),A||(Q=M)},a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return Ue(),i.ready});t.exports=n}},e={},function t(n){var i=e[n];if(i!==void 0)return i.exports;var s=e[n]={exports:{}};return r[n].call(s.exports,s,s.exports,t),s.exports}(770);var r,e})});var SI={};Zy(SI,{activate:()=>gI,deactivate:()=>_I,globals:()=>it});module.exports=Jy(SI);var rr=Se(require("path")),Vn=Se(require("vscode"));var Ds=Se(require("vscode")),ap=Se(require("path")),cp=Se(require("fs")),up=require("net");var np=require("vscode");var ew=["SILENT","ERROR","WARN ","INFO ","DEBUG","TRACE"],tu="\x1B[0m",tp=[tu,"\x1B[1;31m","\x1B[1;33m","\x1B[1;36m","\x1B[1;32m","\x1B[1;35m"],nu=class{constructor(e,{level:t=4,time:n=!1,output:i=""}={}){this.tag=e;this.level=t,this.show_time=n,i&&(this.output=np.window.createOutputChannel(i,{log:!0}))}level=4;show_tag=!0;show_time;show_level=!1;output;log(e,...t){if(rp()){let n="";this.show_time&&(n+=`[${new Date().toISOString()}]`),this.show_level&&(n+="["+tp[e]+ew[e]+tu+"]"),this.show_tag&&(n+="["+tp[e]+this.tag+tu+"]"),console.log(n,...t)}if(this.output)switch(e){case 1:this.output.error(t[0]);break;case 2:this.output.warn(t[0]);break;case 3:this.output.info(t[0]);break;case 4:this.output.debug(t[0],...t.slice(1));break;case 5:this.output.trace(t[0]);break;default:break}}error(...e){1<=this.level&&this.log(1,...e)}warn(...e){2<=this.level&&this.log(2,...e)}info(...e){3<=this.level&&this.log(3,...e)}debug(...e){4<=this.level&&this.log(4,...e)}trace(...e){5<=this.level&&this.log(5,...e)}},tw=new Map;function Te(r,e){let t=new nu(r,e);return tw.set(r,t),t}var Vr=Se(require("vscode")),Is=Se(require("path")),Hn=Se(require("fs")),sp=require("child_process"),ru,jo;async function ki(){let r="";if(Vr.workspace.workspaceFolders!==void 0){let e=await Vr.workspace.findFiles("**/project.godot");if(e.length===0)return;if(e.length===1){if(r=e[0].fsPath,!Hn.existsSync(r)||!Hn.statSync(r).isFile())return}else if(e.length>1){let t=e.reduce((n,i)=>n.fsPath.length<=i.fsPath.length?n:i);if(t&&(r=t.fsPath,!Hn.existsSync(r)||!Hn.statSync(r).isFile()))return}}return jo=r,ru=Is.dirname(r),ru}var ip;async function en(){if((ru===void 0||jo===void 0)&&await ki(),jo===void 0)return;let r="3.x",n=(await Vr.workspace.openTextDocument(jo)).getText().match(/config\/features=PackedStringArray\((.*)\)/);if(n){let s=n[0].match(/\"(4.[0-9]+)\"/);s&&(r=s[1])}return ip=r,ip}function iu(r,e=20){if(r===".")return Hn.existsSync("project.godot")&&Hn.statSync("project.godot").isFile()?"project.godot":null;let t=Is.dirname(r);if(r===t)return null;let n=Is.join(t,"project.godot");return Hn.existsSync(n)&&Hn.statSync(n).isFile()?n:e===0?null:iu(t,e-1)}async function ir(r){let e=await ki();return Vr.Uri.joinPath(Vr.Uri.file(e),r.substring(6))}function Pn(r,e){try{let t=(0,sp.execSync)(`"${r}" --version`).toString().trim(),n=/^(([34])\.([0-9]+)(?:\.[0-9]+)?)/m,i=t.match(n);return i?i[2]!==e?{status:"WRONG_VERSION",version:i[1]}:{status:"SUCCESS",version:i[1]}:{status:"INVALID_EXE"}}catch{return{status:"INVALID_EXE"}}}var Ti=Se(require("vscode")),nw=[["godot_tools.editor_path","godotTools.editorPath.godot3"],["godot_tools.editor_path","godotTools.editorPath.godot4"],["godot_tools.gdscript_lsp_server_protocol","godotTools.lsp.serverProtocol"],["godot_tools.gdscript_lsp_server_host","godotTools.lsp.serverHost"],["godot_tools.gdscript_lsp_server_port","godotTools.lsp.serverPort"],["godot_tools.reconnect_automatically","godotTools.lsp.autoReconnect.enabled"],["godot_tools.reconnect_cooldown","godotTools.lsp.autoReconnect.cooldown"],["godot_tools.reconnect_attempts","godotTools.lsp.autoReconnect.attempts"],["godot_tools.scenePreview.previewRelatedScenes","godotTools.scenePreview.previewRelatedScenes"]];function rw(){let r=Ti.workspace.getConfiguration(),e=!1;for(let[t,n]of nw){let i=r.get(t);i!==void 0&&(r.update(n,i,!0),e=!0)}e&&Ti.window.showInformationMessage(`Settings from godot-tools version <2.0.0 have been updated to the new format.
			Please view the changelog for version 2.0.0 for more information.`,"Okay")}function iw(r){let e=Ti.extensions.getExtension(r.extension.id).packageJSON.version;r.globalState.update("previousVersion",e)}function sw(r){return r.globalState.get("previousVersion")===void 0}function op(r){sw(r)&&rw(),iw(r)}var Kn=Se(require("vscode")),Bo="godotTools";function Ve(r,e){let t=Kn.workspace.getConfiguration(Bo).get(r,null);return e&&t===null?e:t}function Uo(r,e){return Kn.workspace.getConfiguration(Bo).update(r,e)}var ow=`${Bo}.context.`;function ln(r,e){return Kn.commands.executeCommand("setContext",ow+r,e)}function Ke(r,e,t){return Kn.commands.registerCommand(`${Bo}.${r}`,e)}function tn(...r){return Kn.Uri.joinPath(Kn.extensions.getExtension("geequlim.godot-tools").extensionUri,...r??"")}function rp(){return process.env.VSCODE_DEBUG_MODE==="true"}async function zo(r){if(cp.existsSync(r))return Ds.Uri.file(r);{let e=ap.basename(r),t=await Ds.workspace.findFiles("**/"+e);if(t.length==1)return t[0]}return null}async function Pi(){return new Promise(r=>{let e=(0,up.createServer)();e.listen(0,()=>{let t=e.address().port;e.close(n=>r(t))})})}function sr(r,e){return Ds.Uri.from({scheme:"gddoc",path:r+".gddoc",fragment:e})}var aw=Se(require("vscode"));var MI=Te("providers.completions");var lp=Se(require("vscode")),Sr=require("vscode");var KI=Te("providers.definitions"),Go=class{constructor(e){this.context=e;let t=[{language:"gdresource",scheme:"file"},{language:"gdscene",scheme:"file"},{language:"gdscript",scheme:"file"}];e.subscriptions.push(lp.languages.registerDefinitionProvider(t,this))}async provideDefinition(e,t,n){if(["gdresource","gdscene"].includes(e.languageId)){let a=e.getWordRangeAtPosition(t,/(\w+)/);if(a){let c=e.getText(a);if(it.docsProvider.classInfo.has(c)){let u=sr(c);return new Sr.Location(u,new Sr.Position(0,0))}else{let u=0,h,v;do h=e.lineAt(t.line-u++),v=h.text.match(/(?<=type)="(\w+)"/);while(!v&&h.lineNumber>0);if(it.docsProvider.classInfo.has(v[1])){let m=sr(v[1],c);return new Sr.Location(m,new Sr.Position(0,0))}}}return null}let i=await it.lsp.client.get_symbol_at_position(e.uri,t);if(!i)return null;let s=i.split("."),o=sr(s[0],s[1]);return new Sr.Location(o,new Sr.Position(0,0))}};var gp=Se(require("vscode")),Yn=require("vscode");var lt=Se(require("vscode")),nn=require("vscode"),pp=Se(require("fs"));var fp=require("vscode"),Ko=require("path"),hp=Se(require("fs"));var Ho=require("vscode"),su=Se(require("path"));var dp=tn("resources","godot_icons").fsPath,Vo=class extends Ho.TreeItem{constructor(t,n,i){super(t,i);this.label=t;this.className=n;this.collapsibleState=i;let s=n+".svg";this.iconPath={light:su.join(dp,"light",s),dark:su.join(dp,"dark",s)}}path;relativePath;resourcePath;parent;text;position;body;unique=!1;hasScript=!1;scriptId="";children=[];parse_body(){let t=this.body.split(`
`),n=[];for(let s=0;s<t.length;s++){let o=t[s];o.startsWith("tile_data")&&(o="tile_data = PoolIntArray(...)"),o.startsWith("unique_name_in_owner = true")&&(this.unique=!0),o.startsWith("script = ExtResource")&&(this.hasScript=!0,this.scriptId=o.match(/script = ExtResource\(\s*"?([\w]+)"?\s*\)/)[1],this.contextValue+="hasScript"),o!=""&&n.push(o)}this.body=n.join(`
`);let i=new Ho.MarkdownString;i.appendCodeblock(this.body,"gdresource"),this.tooltip=i}},Wo=class{path;title;mtime;root;externalResources={};subResources={};nodes=new Map};var nD=Te("scenes.parser"),Os=class{scenes=new Map;constructor(){if(Os.instance)return Os.instance;Os.instance=this}parse_scene(e){let t=e.uri.fsPath,n=hp.statSync(t);if(this.scenes.has(t)){let m=this.scenes.get(t);if(m.mtime==n.mtimeMs)return m}let i=new Wo;i.path=t,i.mtime=n.mtimeMs,i.title=(0,Ko.basename)(t),this.scenes.set(t,i);let s=e.getText();for(let m of s.matchAll(/\[ext_resource.*/g)){let b=m[0],k=b.match(/type="([\w]+)"/)?.[1],f=b.match(/path="([\w.:/]+)"/)?.[1],_=b.match(/uid="([\w:/]+)"/)?.[1],w=b.match(/ id="?([\w]+)"?/)?.[1];i.externalResources[w]={body:b,path:f,type:k,uid:_,id:w,index:m.index,line:e.lineAt(e.positionAt(m.index)).lineNumber+1}}let o=null;for(let m of s.matchAll(/\[sub_resource.*/g)){let b=m[0],k=b.match(/type="([\w]+)"/)?.[1],f=b.match(/path="([\w.:/]+)"/)?.[1],_=b.match(/uid="([\w:/]+)"/)?.[1],w=b.match(/ id="?([\w]+)"?/)?.[1],S={path:f,type:k,uid:_,id:w,index:m.index,line:e.lineAt(e.positionAt(m.index)).lineNumber+1};o&&(o.body=s.slice(o.index,m.index).trimEnd()),i.subResources[w]=S,o=S}let a="",c={},u=null,h=/\[node name="([\w]*)"(?: type="([\w]*)")?(?: parent="([\w\/.]*)")?(?: instance=ExtResource\(\s*"?([\w]+)"?\s*\))?\]/g;for(let m of s.matchAll(h)){let b=m[1],k=m[2]?m[2]:"PackedScene",f=m[3],_=m[4]?m[4]:0,w="",S="";f==null?(a=b,w=b):f=="."?(f=a,S=b,w=f+"/"+b):(S=f+"/"+b,f=a+"/"+f,w=f+"/"+b),u&&(u.body=s.slice(u.position,m.index),u.parse_body()),o&&(o.body=s.slice(o.index,m.index).trimEnd(),o=null);let y=new Vo(b,k);y.path=w,y.description=k,y.relativePath=S,y.parent=f,y.text=m[0],y.position=m.index,y.resourceUri=fp.Uri.from({scheme:"godot",path:w}),i.nodes.set(w,y),_&&(_ in i.externalResources&&(y.tooltip=i.externalResources[_].path,y.resourcePath=i.externalResources[_].path,[".tscn"].includes((0,Ko.extname)(y.resourcePath))&&(y.contextValue+="openable")),y.contextValue+="hasResourcePath"),w==a&&(i.root=y),f in c&&c[f].children.push(y),c[w]=y,u=y}u&&(u.body=s.slice(u.position,s.length),u.parse_body());let v=/\[resource\]/g;for(let m of s.matchAll(v))o&&(o.body=s.slice(o.index,m.index).trimEnd(),o=null);return i}},In=Os;ep(In,"instance");var bD=Te("scenes.preview"),Yo=class{constructor(e){this.context=e;this.tree=lt.window.createTreeView("scenePreview",{treeDataProvider:this,dragAndDropController:this});let t=[{language:"csharp",scheme:"file"},{language:"gdscript",scheme:"file"}];e.subscriptions.push(Ke("scenePreview.pin",this.pin_preview.bind(this)),Ke("scenePreview.unpin",this.unpin_preview.bind(this)),Ke("scenePreview.copyNodePath",this.copy_node_path.bind(this)),Ke("scenePreview.copyResourcePath",this.copy_resource_path.bind(this)),Ke("scenePreview.openScene",this.open_scene.bind(this)),Ke("scenePreview.openScript",this.open_script.bind(this)),Ke("scenePreview.goToDefinition",this.go_to_definition.bind(this)),Ke("scenePreview.openDocumentation",this.open_documentation.bind(this)),Ke("scenePreview.refresh",this.refresh.bind(this)),nn.window.onDidChangeActiveTextEditor(this.refresh.bind(this)),nn.window.registerFileDecorationProvider(this.uniqueDecorator),nn.window.registerFileDecorationProvider(this.scriptDecorator),nn.languages.registerDocumentDropEditProvider(t,this),this.watcher.onDidChange(this.on_file_changed.bind(this)),this.watcher,this.tree.onDidChangeSelection(this.tree_selection_changed),this.tree),this.refresh()}dropMimeTypes=[];dragMimeTypes=[];tree;scenePreviewPinned=!1;currentScene="";parser=new In;scene;watcher=nn.workspace.createFileSystemWatcher("**/*.tscn");uniqueDecorator=new ou(this);scriptDecorator=new au(this);changeTreeEvent=new nn.EventEmitter;get onDidChangeTreeData(){return this.changeTreeEvent.event}handleDrag(e,t,n){t.set("godot/path",new lt.DataTransferItem(e[0].relativePath)),t.set("godot/class",new lt.DataTransferItem(e[0].className))}provideDocumentDropEdits(e,t,n,i){let s=n.get("godot/path").value,o=n.get("godot/class").value;if(s&&o){if(e.languageId==="gdscript")return new lt.DocumentDropEdit(`$${s}`);if(e.languageId==="csharp")return new lt.DocumentDropEdit(`GetNode<${o}>("${s}")`)}}async on_file_changed(e){e.fsPath.endsWith(".tscn")&&setTimeout(async()=>{if(e.fsPath==this.currentScene)this.refresh();else{let t=await lt.workspace.openTextDocument(e);this.parser.parse_scene(t)}},20)}async refresh(){if(this.scenePreviewPinned)return;let e=lt.window.activeTextEditor;if(e){let t=e.document.uri.fsPath,n=Ve("scenePreview.previewRelatedScenes");if(!t.endsWith(".tscn")){let s=t.replace(".gd",".tscn").replace(".cs",".tscn");if(n=="anyFolder"){let o=await zo(s);if(!o)return;t=o.fsPath}if(n=="sameFolder")if(pp.existsSync(s))t=s;else return;if(n=="off")return}if(!t.endsWith(".tscn"))return;let i=await lt.workspace.openTextDocument(t);this.scene=this.parser.parse_scene(i),this.tree.message=this.scene.title,this.currentScene=t,this.changeTreeEvent.fire()}}pin_preview(){this.scenePreviewPinned=!0,ln("scenePreview.pinned",!0)}unpin_preview(){this.scenePreviewPinned=!1,ln("scenePreview.pinned",!1),this.refresh()}copy_node_path(e){if(e.unique){lt.env.clipboard.writeText("%"+e.label);return}lt.env.clipboard.writeText(e.relativePath)}copy_resource_path(e){lt.env.clipboard.writeText(e.resourcePath)}async open_scene(e){let t=await ir(e.resourcePath);t&&lt.window.showTextDocument(t,{preview:!0})}async open_script(e){let t=this.scene.externalResources[e.scriptId].path,n=await ir(t);n&&lt.window.showTextDocument(n,{preview:!0})}async go_to_definition(e){let t=await lt.workspace.openTextDocument(this.currentScene),n=t.positionAt(e.position),i=t.positionAt(e.position+e.text.length),s=new lt.Range(n,i);lt.window.showTextDocument(t,{selection:s})}async open_documentation(e){lt.commands.executeCommand("vscode.open",sr(e.className))}tree_selection_changed(e){}getChildren(e){return e?Promise.resolve(e.children):this.scene?.root?Promise.resolve([this.scene?.root]):Promise.resolve([])}getTreeItem(e){return e.children.length>0?e.collapsibleState=nn.TreeItemCollapsibleState.Expanded:e.collapsibleState=nn.TreeItemCollapsibleState.None,this.uniqueDecorator.changeDecorationsEvent.fire(e.resourceUri),this.scriptDecorator.changeDecorationsEvent.fire(e.resourceUri),e}},ou=class{constructor(e){this.previewer=e}changeDecorationsEvent=new nn.EventEmitter;get onDidChangeFileDecorations(){return this.changeDecorationsEvent.event}provideFileDecoration(e,t){if(e.scheme!=="godot")return;let n=this.previewer.scene?.nodes.get(e.path);if(n&&n.unique)return{badge:"%"}}},au=class{constructor(e){this.previewer=e}changeDecorationsEvent=new nn.EventEmitter;get onDidChangeFileDecorations(){return this.changeDecorationsEvent.event}provideFileDecoration(e,t){if(e.scheme!=="godot")return;let n=this.previewer.scene?.nodes.get(e.path);if(n&&n.hasScript)return{badge:"S"}}};var ID=Te("providers.document_links"),Xo=class{constructor(e){this.context=e;let t=[{language:"gdresource",scheme:"file"},{language:"gdscene",scheme:"file"},{language:"gdscript",scheme:"file"}];e.subscriptions.push(gp.languages.registerDocumentLinkProvider(t,this))}parser=new In;async provideDocumentLinks(e,t){let n=this.parser.parse_scene(e),i=e.getText(),s=e.uri.fsPath,o=[];if(["gdresource","gdscene"].includes(e.languageId)){for(let a of i.matchAll(/ExtResource\(\s?"?(\w+)\s?"?\)/g)){let c=a[1],u=Yn.Uri.from({scheme:"file",path:s,fragment:`${n.externalResources[c].line},0`}),h=this.create_range(e,a),v=new Yn.DocumentLink(h,u);v.tooltip="Jump to resource definition",o.push(v)}for(let a of i.matchAll(/SubResource\(\s?"?(\w+)\s?"?\)/g)){let c=a[1],u=Yn.Uri.from({scheme:"file",path:s,fragment:`${n.subResources[c].line},0`}),h=this.create_range(e,a),v=new Yn.DocumentLink(h,u);o.push(v)}}for(let a of i.matchAll(/res:\/\/[^"^']*/g)){let c=this.create_range(e,a),u=await ir(a[0]);u instanceof Yn.Uri&&o.push(new Yn.DocumentLink(c,u))}return o}create_range(e,t){let n=e.positionAt(t.index),i=e.positionAt(t.index+t[0].length);return new Yn.Range(n,i)}};var As=Se(require("vscode")),Xn=require("vscode");var $D=Te("providers.hover"),Qo=class{constructor(e){this.context=e;let t=[{language:"gdresource",scheme:"file"},{language:"gdscene",scheme:"file"},{language:"gdscript",scheme:"file"}];e.subscriptions.push(As.languages.registerHoverProvider(t,this))}parser=new In;async get_links(e){let t="";for(let n of e.matchAll(/res:\/\/[^"^']*/g)){let i=await ir(n[0]);i instanceof Xn.Uri&&(t+=`* [${n[0]}](${i})
`)}return t}async provideHover(e,t,n){if(["gdresource","gdscene"].includes(e.languageId)){let s=this.parser.parse_scene(e),o=/(?:Ext|Sub)Resource\(\s?"?(\w+)\s?"?\)/,a=e.getText(e.getWordRangeAtPosition(t,o));if(a.startsWith("ExtResource")){let u=a.match(o)[1],h=s.externalResources[u],v=s.externalResources[u].body,m=await this.get_links(v),b=new Xn.MarkdownString;b.appendMarkdown(m);let k=await ir(h.path);if(b.appendMarkdown(`
---
`),b.appendCodeblock(v,"gdresource"),h.type==="Texture"&&(b.appendMarkdown(`
---
`),b.appendMarkdown(`<img src="${k}" min-width=100px max-width=500px/>
`),b.supportHtml=!0,b.isTrusted=!0),h.type==="Script"){b.appendMarkdown(`
---
`);let _=(await As.workspace.openTextDocument(k)).getText();b.appendCodeblock(_,"gdscript")}return new Xn.Hover(b)}if(a.startsWith("SubResource")){let u=a.match(o)[1],h=s.subResources[u].body;h=h?.replace(/Array\([0-9,\.\- ]*\)/,"Array(...)");let v=new Xn.MarkdownString;return v.appendCodeblock(h,"gdresource"),new Xn.Hover(v)}}let i=e.getText(e.getWordRangeAtPosition(t,/res:\/\/[^"^']*/));if(i.startsWith("res://")){let s="";if(i.endsWith(".gd"))s="gdscript";else if(i.endsWith(".cs"))s="csharp";else if(i.endsWith(".tscn"))s="gdscene";else if(i.endsWith(".tres"))s="gdresource";else if(i.endsWith(".png")||i.endsWith(".svg"))s="image";else return;let o=await ir(i),a=new Xn.MarkdownString;if(s==="image")a.appendMarkdown(`<img src="${o}" min-width=100px max-width=500px/>`),a.supportHtml=!0,a.isTrusted=!0;else{let u=(await As.workspace.openTextDocument(o)).getText();a.appendCodeblock(u,s)}return new Xn.Hover(a)}}};var _p=Se(require("vscode")),Qn=require("vscode");var XD=Te("providers.inlay_hints");function bp(r){let e=/: ([\w\d_]+)/,t=r.match(e);return` ${t?t[1]:"unknown"} `}async function mp(r,e,t){let n=await it.lsp.client.sendRequest("textDocument/hover",{textDocument:{uri:r.uri.toString()},position:{line:e.line,character:e.character}});if(!(Array.isArray(n.contents)&&n.contents.length===0))return new Qn.InlayHint(t,bp(n.contents.value),Qn.InlayHintKind.Type)}var Zo=class{constructor(e){this.context=e;let t=[{language:"gdresource",scheme:"file"},{language:"gdscene",scheme:"file"},{language:"gdscript",scheme:"file"}];e.subscriptions.push(_p.languages.registerInlayHintsProvider(t,this))}parser=new In;async provideInlayHints(e,t,n){let i=[],s=e.getText(t);if(e.fileName.endsWith(".gd")){if(!Ve("inlayHints.gdscript",!0))return i;await it.lsp.client.onReady();let a=await it.lsp.client.sendRequest("textDocument/documentSymbol",{textDocument:{uri:e.uri.toString()}});if(a.length===0)return i;let c=typeof a[0]=="object"&&"children"in a[0]?a[0].children:a,u=c.some(v=>v.detail),h=/((var|const)\s+)([\w\d_]+)\s*:=/g;for(let v of s.matchAll(h)){if(n.isCancellationRequested)break;let m=e.positionAt(v.index+v[0].length-1),b=e.positionAt(v.index+v[1].length);if(u){let k=c.find(f=>f.name===v[3]);if(k&&k.detail){let f=new Qn.InlayHint(m,bp(k.detail),Qn.InlayHintKind.Type);i.push(f)}else{let f=await mp(e,b,m);f&&i.push(f)}}else{let k=await mp(e,b,m);k&&i.push(k)}}return i}if(!Ve("inlayHints.gdresource",!0))return i;let o=this.parser.parse_scene(e);for(let a of s.matchAll(/ExtResource\(\s?"?(\w+)\s?"?\)/g)){let c=a[1],u=e.positionAt(a.index+a[0].length),h=o.externalResources[c],v=`${h.type}: "${h.path}"`,m=new Qn.InlayHint(u,v,Qn.InlayHintKind.Type);m.paddingLeft=!0,i.push(m)}for(let a of s.matchAll(/SubResource\(\s?"?(\w+)\s?"?\)/g)){let c=a[1],u=e.positionAt(a.index+a[0].length),v=`${o.subResources[c].type}`,m=new Qn.InlayHint(u,v,Qn.InlayHintKind.Type);m.paddingLeft=!0,i.push(m)}return i}};var cw=Se(require("vscode")),cu=require("vscode");var oO=Te("providers.tokens");var Ji=Se(require("vscode"));var go=Se(require("vscode")),Kt=Se(kf()),mo=Se(Lb()),I1=Se(qb());function zb(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var Qi=zb();function cT(r){Qi=r}var uT=/[&<>"']/,lT=/[&<>"']/g,dT=/[<>"']|&(?!#?\w+;)/,fT=/[<>"']|&(?!#?\w+;)/g,hT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Fb=r=>hT[r];function Nt(r,e){if(e){if(uT.test(r))return r.replace(lT,Fb)}else if(dT.test(r))return r.replace(fT,Fb);return r}var pT=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Gb(r){return r.replace(pT,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}var gT=/(^|[^\[])\^/g;function nt(r,e){r=r.source||r,e=e||"";let t={replace:(n,i)=>(i=i.source||i,i=i.replace(gT,"$1"),r=r.replace(n,i),t),getRegex:()=>new RegExp(r,e)};return t}var mT=/[^\w:]/g,_T=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Mb(r,e,t){if(r){let n;try{n=decodeURIComponent(Gb(t)).replace(mT,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}e&&!_T.test(t)&&(t=wT(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}var Ja={},bT=/^[^:]+:\/*[^/]*$/,vT=/^([^:]+:)[\s\S]*$/,yT=/^([^:]+:\/*[^/]*)[\s\S]*$/;function wT(r,e){Ja[" "+r]||(bT.test(r)?Ja[" "+r]=r+"/":Ja[" "+r]=ec(r,"/",!0)),r=Ja[" "+r];let t=r.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:r.replace(vT,"$1")+e:e.charAt(0)==="/"?t?e:r.replace(yT,"$1")+e:r+e}var tc={exec:function(){}};function Bn(r){let e=1,t,n;for(;e<arguments.length;e++){t=arguments[e];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}function $b(r,e){let t=r.replace(/\|/g,(s,o,a)=>{let c=!1,u=o;for(;--u>=0&&a[u]==="\\";)c=!c;return c?"|":" |"}),n=t.split(/ \|/),i=0;if(n[0].trim()||n.shift(),n[n.length-1].trim()||n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function ec(r,e,t){let n=r.length;if(n===0)return"";let i=0;for(;i<n;){let s=r.charAt(n-i-1);if(s===e&&!t)i++;else if(s!==e&&t)i++;else break}return r.substr(0,n-i)}function RT(r,e){if(r.indexOf(e[1])===-1)return-1;let t=r.length,n=0,i=0;for(;i<t;i++)if(r[i]==="\\")i++;else if(r[i]===e[0])n++;else if(r[i]===e[1]&&(n--,n<0))return i;return-1}function Vb(r){r&&r.sanitize&&!r.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function jb(r,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=r),e>>=1,r+=r;return t+r}function Bb(r,e,t,n){let i=e.href,s=e.title?Nt(e.title):null,o=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;let a={type:"link",raw:t,href:i,title:s,text:o,tokens:n.inlineTokens(o,[])};return n.state.inLink=!1,a}else return{type:"image",raw:t,href:i,title:s,text:Nt(o)}}function ST(r,e){let t=r.match(/^(\s+)(?:```)/);if(t===null)return e;let n=t[1];return e.split(`
`).map(i=>{let s=i.match(/^\s+/);if(s===null)return i;let[o]=s;return o.length>=n.length?i.slice(n.length):i}).join(`
`)}var fo=class{constructor(e){this.options=e||Qi}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:ec(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],i=ST(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim():t[2],text:i}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){let s=ec(n,"#");(this.options.pedantic||!s||/ $/.test(s))&&(n=s.trim())}let i={type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(n,[]),text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,i,s,o,a,c,u,h,v,m,b,k,f=t[1].trim(),_=f.length>1,w={type:"list",raw:"",ordered:_,start:_?+f.slice(0,-1):"",loose:!1,items:[]};f=_?`\\d{1,9}\\${f.slice(-1)}`:`\\${f}`,this.options.pedantic&&(f=_?f:"[*+-]");let S=new RegExp(`^( {0,3}${f})((?: [^\\n]*)?(?:\\n|$))`);for(;e&&(k=!1,!(!(t=S.exec(e))||this.rules.block.hr.test(e)));){if(n=t[0],e=e.substring(n.length),h=t[2].split(`
`,1)[0],v=e.split(`
`,1)[0],this.options.pedantic?(o=2,b=h.trimLeft()):(o=t[2].search(/[^ ]/),o=o>4?1:o,b=h.slice(o),o+=t[1].length),c=!1,!h&&/^ *$/.test(v)&&(n+=v+`
`,e=e.substring(v.length+1),k=!0),!k){let l=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;e&&(m=e.split(`
`,1)[0],h=m,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!l.test(h));){if(h.search(/[^ ]/)>=o||!h.trim())b+=`
`+h.slice(o);else if(!c)b+=`
`+h;else break;!c&&!h.trim()&&(c=!0),n+=m+`
`,e=e.substring(m.length+1)}}w.loose||(u?w.loose=!0:/\n *\n *$/.test(n)&&(u=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(b),i&&(s=i[0]!=="[ ] ",b=b.replace(/^\[[ xX]\] +/,""))),w.items.push({type:"list_item",raw:n,task:!!i,checked:s,loose:!1,text:b}),w.raw+=n}w.items[w.items.length-1].raw=n.trimRight(),w.items[w.items.length-1].text=b.trimRight(),w.raw=w.raw.trimRight();let y=w.items.length;for(a=0;a<y;a++){this.lexer.state.top=!1,w.items[a].tokens=this.lexer.blockTokens(w.items[a].text,[]);let l=w.items[a].tokens.filter(E=>E.type==="space"),x=l.every(E=>{let C=E.raw.split(""),T=0;for(let D of C)if(D===`
`&&(T+=1),T>1)return!0;return!1});!w.loose&&l.length&&x&&(w.loose=!0,w.items[a].loose=!0)}return w}}html(e){let t=this.rules.block.html.exec(e);if(t){let n={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(n.type="paragraph",n.text=this.options.sanitizer?this.options.sanitizer(t[0]):Nt(t[0]),n.tokens=[],this.lexer.inline(n.text,n.tokens)),n}}def(e){let t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){let t=this.rules.block.table.exec(e);if(t){let n={type:"table",header:$b(t[1]).map(i=>({text:i})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=t[0];let i=n.align.length,s,o,a,c;for(s=0;s<i;s++)/^ *-+: *$/.test(n.align[s])?n.align[s]="right":/^ *:-+: *$/.test(n.align[s])?n.align[s]="center":/^ *:-+ *$/.test(n.align[s])?n.align[s]="left":n.align[s]=null;for(i=n.rows.length,s=0;s<i;s++)n.rows[s]=$b(n.rows[s],n.header.length).map(u=>({text:u}));for(i=n.header.length,o=0;o<i;o++)n.header[o].tokens=[],this.lexer.inlineTokens(n.header[o].text,n.header[o].tokens);for(i=n.rows.length,o=0;o<i;o++)for(c=n.rows[o],a=0;a<c.length;a++)c[a].tokens=[],this.lexer.inlineTokens(c[a].text,c[a].tokens);return n}}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t){let n={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}text(e){let t=this.rules.block.text.exec(e);if(t){let n={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Nt(t[1])}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Nt(t[0]):t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;let o=ec(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{let o=RT(t[2],"()");if(o>-1){let c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){let o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(n)?i=i.slice(1):i=i.slice(1,-1)),Bb(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i||!i.href){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return Bb(n,i,n[0],this.lexer)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&n.match(/[\p{L}\p{N}]/u))return;let s=i[1]||i[2]||"";if(!s||s&&(n===""||this.rules.inline.punctuation.exec(n))){let o=i[0].length-1,a,c,u=o,h=0,v=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(v.lastIndex=0,t=t.slice(-1*e.length+o);(i=v.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(c=a.length,i[3]||i[4]){u+=c;continue}else if((i[5]||i[6])&&o%3&&!((o+c)%3)){h+=c;continue}if(u-=c,u>0)continue;if(c=Math.min(c,c+u+h),Math.min(o,c)%2){let b=e.slice(1,o+i.index+c);return{type:"em",raw:e.slice(0,o+i.index+c+1),text:b,tokens:this.lexer.inlineTokens(b,[])}}let m=e.slice(2,o+i.index+c-1);return{type:"strong",raw:e.slice(0,o+i.index+c+1),text:m,tokens:this.lexer.inlineTokens(m,[])}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," "),i=/[^ ]/.test(n),s=/^ /.test(n)&&/ $/.test(n);return i&&s&&(n=n.substring(1,n.length-1)),n=Nt(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){let n=this.rules.inline.autolink.exec(e);if(n){let i,s;return n[2]==="@"?(i=Nt(this.options.mangle?t(n[1]):n[1]),s="mailto:"+i):(i=Nt(n[1]),s=i),{type:"link",raw:n[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let i,s;if(n[2]==="@")i=Nt(this.options.mangle?t(n[0]):n[0]),s="mailto:"+i;else{let o;do o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(o!==n[0]);i=Nt(n[0]),n[1]==="www."?s="http://"+i:s=i}return{type:"link",raw:n[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e,t){let n=this.rules.inline.text.exec(e);if(n){let i;return this.lexer.state.inRawBlock?i=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):Nt(n[0]):n[0]:i=Nt(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:i}}}},we={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:tc,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};we._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;we._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;we.def=nt(we.def).replace("label",we._label).replace("title",we._title).getRegex();we.bullet=/(?:[*+-]|\d{1,9}[.)])/;we.listItemStart=nt(/^( *)(bull) */).replace("bull",we.bullet).getRegex();we.list=nt(we.list).replace(/bull/g,we.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+we.def.source+")").getRegex();we._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";we._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;we.html=nt(we.html,"i").replace("comment",we._comment).replace("tag",we._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();we.paragraph=nt(we._paragraph).replace("hr",we.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",we._tag).getRegex();we.blockquote=nt(we.blockquote).replace("paragraph",we.paragraph).getRegex();we.normal=Bn({},we);we.gfm=Bn({},we.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});we.gfm.table=nt(we.gfm.table).replace("hr",we.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",we._tag).getRegex();we.gfm.paragraph=nt(we._paragraph).replace("hr",we.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",we.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",we._tag).getRegex();we.pedantic=Bn({},we.normal,{html:nt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",we._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tc,paragraph:nt(we.normal._paragraph).replace("hr",we.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",we.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var ne={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:tc,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:tc,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};ne._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";ne.punctuation=nt(ne.punctuation).replace(/punctuation/g,ne._punctuation).getRegex();ne.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;ne.escapedEmSt=/\\\*|\\_/g;ne._comment=nt(we._comment).replace("(?:-->|$)","-->").getRegex();ne.emStrong.lDelim=nt(ne.emStrong.lDelim).replace(/punct/g,ne._punctuation).getRegex();ne.emStrong.rDelimAst=nt(ne.emStrong.rDelimAst,"g").replace(/punct/g,ne._punctuation).getRegex();ne.emStrong.rDelimUnd=nt(ne.emStrong.rDelimUnd,"g").replace(/punct/g,ne._punctuation).getRegex();ne._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;ne._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;ne._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;ne.autolink=nt(ne.autolink).replace("scheme",ne._scheme).replace("email",ne._email).getRegex();ne._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;ne.tag=nt(ne.tag).replace("comment",ne._comment).replace("attribute",ne._attribute).getRegex();ne._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;ne._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;ne._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;ne.link=nt(ne.link).replace("label",ne._label).replace("href",ne._href).replace("title",ne._title).getRegex();ne.reflink=nt(ne.reflink).replace("label",ne._label).replace("ref",we._label).getRegex();ne.nolink=nt(ne.nolink).replace("ref",we._label).getRegex();ne.reflinkSearch=nt(ne.reflinkSearch,"g").replace("reflink",ne.reflink).replace("nolink",ne.nolink).getRegex();ne.normal=Bn({},ne);ne.pedantic=Bn({},ne.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:nt(/^!?\[(label)\]\((.*?)\)/).replace("label",ne._label).getRegex(),reflink:nt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ne._label).getRegex()});ne.gfm=Bn({},ne.normal,{escape:nt(ne.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});ne.gfm.url=nt(ne.gfm.url,"i").replace("email",ne.gfm._extended_email).getRegex();ne.breaks=Bn({},ne.gfm,{br:nt(ne.br).replace("{2,}","*").getRegex(),text:nt(ne.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function CT(r){return r.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function Ub(r){let e="",t,n,i=r.length;for(t=0;t<i;t++)n=r.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}var $n=class{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Qi,this.options.tokenizer=this.options.tokenizer||new fo,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={block:we.normal,inline:ne.normal};this.options.pedantic?(t.block=we.pedantic,t.inline=ne.pedantic):this.options.gfm&&(t.block=we.gfm,this.options.breaks?t.inline=ne.breaks:t.inline=ne.gfm),this.tokenizer.rules=t}static get rules(){return{block:we,inline:ne}}static lex(e,t){return new $n(t).lex(e)}static lexInline(e,t){return new $n(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let n,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0,c=e.slice(1),u;this.options.extensions.startBlock.forEach(function(h){u=h.call({lexer:this},c),typeof u=="number"&&u>=0&&(a=Math.min(a,u))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(s))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),o=s.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(e){let a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let n,i,s,o=e,a,c,u;if(this.tokens.links){let h=Object.keys(this.tokens.links);if(h.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)h.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+jb("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+jb("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(c||(u=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(h=>(n=h.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,o,u)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,Ub)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,Ub))){e=e.substring(n.raw.length),t.push(n);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let h=1/0,v=e.slice(1),m;this.options.extensions.startInline.forEach(function(b){m=b.call({lexer:this},v),typeof m=="number"&&m>=0&&(h=Math.min(h,m))}),h<1/0&&h>=0&&(s=e.substring(0,h+1))}if(n=this.tokenizer.inlineText(s,CT)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(u=n.raw.slice(-1)),c=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return t}},ho=class{constructor(e){this.options=e||Qi}code(e,t,n){let i=(t||"").match(/\S*/)[0];if(this.options.highlight){let s=this.options.highlight(e,i);s!=null&&s!==e&&(n=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="'+this.options.langPrefix+Nt(i,!0)+'">'+(n?e:Nt(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:Nt(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,n,i){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+i.slug(n)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,n){let i=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+i+s+`>
`+e+"</"+i+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){let n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,n){if(e=Mb(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let i='<a href="'+Nt(e)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>",i}image(e,t,n){if(e=Mb(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">",i}text(e){return e}},nc=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}},rc=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do i++,n=e+"-"+i;while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n}slug(e,t={}){let n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}},jn=class{constructor(e){this.options=e||Qi,this.options.renderer=this.options.renderer||new ho,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new nc,this.slugger=new rc}static parse(e,t){return new jn(t).parse(e)}static parseInline(e,t){return new jn(t).parseInline(e)}parse(e,t=!0){let n="",i,s,o,a,c,u,h,v,m,b,k,f,_,w,S,y,l,x,E,C=e.length;for(i=0;i<C;i++){if(b=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]&&(E=this.options.extensions.renderers[b.type].call({parser:this},b),E!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(b.type))){n+=E||"";continue}switch(b.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(b.tokens),b.depth,Gb(this.parseInline(b.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(b.text,b.lang,b.escaped);continue}case"table":{for(v="",h="",a=b.header.length,s=0;s<a;s++)h+=this.renderer.tablecell(this.parseInline(b.header[s].tokens),{header:!0,align:b.align[s]});for(v+=this.renderer.tablerow(h),m="",a=b.rows.length,s=0;s<a;s++){for(u=b.rows[s],h="",c=u.length,o=0;o<c;o++)h+=this.renderer.tablecell(this.parseInline(u[o].tokens),{header:!1,align:b.align[o]});m+=this.renderer.tablerow(h)}n+=this.renderer.table(v,m);continue}case"blockquote":{m=this.parse(b.tokens),n+=this.renderer.blockquote(m);continue}case"list":{for(k=b.ordered,f=b.start,_=b.loose,a=b.items.length,m="",s=0;s<a;s++)S=b.items[s],y=S.checked,l=S.task,w="",S.task&&(x=this.renderer.checkbox(y),_?S.tokens.length>0&&S.tokens[0].type==="paragraph"?(S.tokens[0].text=x+" "+S.tokens[0].text,S.tokens[0].tokens&&S.tokens[0].tokens.length>0&&S.tokens[0].tokens[0].type==="text"&&(S.tokens[0].tokens[0].text=x+" "+S.tokens[0].tokens[0].text)):S.tokens.unshift({type:"text",text:x}):w+=x),w+=this.parse(S.tokens,_),m+=this.renderer.listitem(w,l,y);n+=this.renderer.list(m,k,f);continue}case"html":{n+=this.renderer.html(b.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(b.tokens));continue}case"text":{for(m=b.tokens?this.parseInline(b.tokens):b.text;i+1<C&&e[i+1].type==="text";)b=e[++i],m+=`
`+(b.tokens?this.parseInline(b.tokens):b.text);n+=t?this.renderer.paragraph(m):m;continue}default:{let T='Token with "'+b.type+'" type was not found.';if(this.options.silent){console.error(T);return}else throw new Error(T)}}}return n}parseInline(e,t){t=t||this.renderer;let n="",i,s,o,a=e.length;for(i=0;i<a;i++){if(s=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){n+=o||"";continue}switch(s.type){case"escape":{n+=t.text(s.text);break}case"html":{n+=t.html(s.text);break}case"link":{n+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{n+=t.image(s.href,s.title,s.text);break}case"strong":{n+=t.strong(this.parseInline(s.tokens,t));break}case"em":{n+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{n+=t.codespan(s.text);break}case"br":{n+=t.br();break}case"del":{n+=t.del(this.parseInline(s.tokens,t));break}case"text":{n+=t.text(s.text);break}default:{let c='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(c);return}else throw new Error(c)}}}return n}};function xe(r,e,t){if(typeof r>"u"||r===null)throw new Error("marked(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=Bn({},xe.defaults,e||{}),Vb(e),t){let n=e.highlight,i;try{i=$n.lex(r,e)}catch(a){return t(a)}let s=function(a){let c;if(!a)try{e.walkTokens&&xe.walkTokens(i,e.walkTokens),c=jn.parse(i,e)}catch(u){a=u}return e.highlight=n,a?t(a):t(null,c)};if(!n||n.length<3||(delete e.highlight,!i.length))return s();let o=0;xe.walkTokens(i,function(a){a.type==="code"&&(o++,setTimeout(()=>{n(a.text,a.lang,function(c,u){if(c)return s(c);u!=null&&u!==a.text&&(a.text=u,a.escaped=!0),o--,o===0&&s()})},0))}),o===0&&s();return}try{let n=$n.lex(r,e);return e.walkTokens&&xe.walkTokens(n,e.walkTokens),jn.parse(n,e)}catch(n){if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+Nt(n.message+"",!0)+"</pre>";throw n}}xe.options=xe.setOptions=function(r){return Bn(xe.defaults,r),cT(xe.defaults),xe};xe.getDefaults=zb;xe.defaults=Qi;xe.use=function(...r){let e=Bn({},...r),t=xe.defaults.extensions||{renderers:{},childTokens:{}},n;r.forEach(i=>{if(i.extensions&&(n=!0,i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){let o=t.renderers?t.renderers[s.name]:null;o?t.renderers[s.name]=function(...a){let c=s.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:t.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[s.level]?t[s.level].unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}s.childTokens&&(t.childTokens[s.name]=s.childTokens)})),i.renderer){let s=xe.defaults.renderer||new ho;for(let o in i.renderer){let a=s[o];s[o]=(...c)=>{let u=i.renderer[o].apply(s,c);return u===!1&&(u=a.apply(s,c)),u}}e.renderer=s}if(i.tokenizer){let s=xe.defaults.tokenizer||new fo;for(let o in i.tokenizer){let a=s[o];s[o]=(...c)=>{let u=i.tokenizer[o].apply(s,c);return u===!1&&(u=a.apply(s,c)),u}}e.tokenizer=s}if(i.walkTokens){let s=xe.defaults.walkTokens;e.walkTokens=function(o){i.walkTokens.call(this,o),s&&s.call(this,o)}}n&&(e.extensions=t),xe.setOptions(e)})};xe.walkTokens=function(r,e){for(let t of r)switch(e.call(xe,t),t.type){case"table":{for(let n of t.header)xe.walkTokens(n.tokens,e);for(let n of t.rows)for(let i of n)xe.walkTokens(i.tokens,e);break}case"list":{xe.walkTokens(t.items,e);break}default:xe.defaults.extensions&&xe.defaults.extensions.childTokens&&xe.defaults.extensions.childTokens[t.type]?xe.defaults.extensions.childTokens[t.type].forEach(function(n){xe.walkTokens(t[n],e)}):t.tokens&&xe.walkTokens(t.tokens,e)}};xe.parseInline=function(r,e){if(typeof r>"u"||r===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");e=Bn({},xe.defaults,e||{}),Vb(e);try{let t=$n.lexInline(r,e);return e.walkTokens&&xe.walkTokens(t,e.walkTokens),jn.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+Nt(t.message+"",!0)+"</pre>";throw t}};xe.Parser=jn;xe.parser=jn.parse;xe.Renderer=ho;xe.TextRenderer=nc;xe.Lexer=$n;xe.lexer=$n.lex;xe.Tokenizer=fo;xe.Slugger=rc;xe.parse=xe;var w1=xe.options,R1=xe.setOptions,S1=xe.use,C1=xe.walkTokens,x1=xe.parseInline;var E1=jn.parse,k1=$n.lex;var xT=Hb(),ET=new xT;xe.setOptions({highlight:function(r,e){if(e==="gdscript")return mo.highlight(r,TT,e);if(e==="csharp")return mo.highlight(r,mo.languages.csharp,e)}});var If="",Kb=go.window.activeColorTheme.kind;Kb===go.ColorThemeKind.Dark?If=`{
		viewport: null,
		styles: {
			'header,footer,section,article': '#d4d4d480',
			'h1,a': '#d4d4d480',
			'h2,h3,h4': '#d4d4d480'
		},
		back: 'rgba(1,1,1,0.08)',
		view: '#79797933',
		drag: '#bfbfbf33',
		interval: 50
	}`:Kb===go.ColorThemeKind.Light&&(If=`{
		viewport: null,
		styles: {
			'header,footer,section,article': 'rgba(0,0,0,0.08)',
			'h1,a': 'rgba(0,0,0,0.10)',
			'h2,h3,h4': 'rgba(0,0,0,0.08)'
		},
		back: 'rgba(0,0,0,0.08)',
		view: 'rgba(0,0,0,0.08)',
		drag: 'rgba(0,0,0,0.08)',
		interval: 50
	}`);function Yb(r,e,t){let n=r.asWebviewUri(tn("media","pagemap.js")),i=r.asWebviewUri(tn("media","prism.css")),s=r.asWebviewUri(tn("media","docs.css")),o="";return t&&(o=`
			window.addEventListener('load', event => {
				document.getElementById('${t}').scrollIntoView();
			});
		`),`<!DOCTYPE html>
		<html>
		<head>
			<meta name="viewport" content="width=device-width, initial-scale=1.0">
			<link href="${s}" rel="stylesheet">
			<link href="${i}" rel="stylesheet">

			<title>${e.name}</title>
		</head>
		<body style="line-height: 16pt;">
			<main>
				${kT(e)}
			</main>

			<canvas id='map'></canvas>
			
			<script src="${n}"></script>
			<script>
				pagemap(document.querySelector('#map'), ${If});			
				${o};

				var vscode = acquireVsCodeApi();
				function inspect(native_class, symbol_name) {
					if (typeof (godot_class) != 'undefined' && godot_class == native_class) {
						document.getElementById(symbol_name).scrollIntoView();
					} else {
						vscode.postMessage({
							type: 'INSPECT_NATIVE_SYMBOL',
							data: {
								native_class: native_class,
								symbol_name: symbol_name
							}
						});
					}
				};
				window.addEventListener('message', event => {
					const message = event.data;
					switch (message.command) {
						case 'focus':
							document.getElementById(message.target).scrollIntoView();
							break;
					}
				});
			</script>
		</body>
		</html>`}function kT(r){let e=Zi(r.native_class,void 0);function t(i,s=!1){let o=/\((.*)?\)\s*\-\>\s*(([A-z0-9]+)?)$/.exec(i.detail);if(!o)return"";let a=Zi(o[2]||"void",void 0),c=(o[1]||"").replace(/\:\s([A-z0-9_]+)(\,\s*)?/g,`: <a href="" onclick="inspect('$1')">$1</a>$2`);return c=c.replace(/\s=\s(.*?)[\,\)]/g,""),`${a} ${s?`${e}.`:""}${Be("a",i.name,{href:`#${i.name}`})}( ${c} )`}function n(i,s=!1){switch(i.kind){case Kt.SymbolKind.Property:case Kt.SymbolKind.Variable:{let o=/\.([A-z_0-9]+)\:\s(.*)$/.exec(i.detail);if(!o)return;let a=Zi(o[2],void 0),c=Be("a",i.name,{href:`#${i.name}`}),u=Be("h4",`${a} ${s?`${e}.`:""}${i.name}`),h=Be("p",po(i.documentation,r.native_class)),v=Be("div",u+h);return{index:a+" "+c,body:v}}break;case Kt.SymbolKind.Constant:{let o=/\.([A-Za-z_0-9]+)(\:\s*)?([A-z0-9_\.]+)?\s*=\s*(.*)$/.exec(i.detail);if(!o)return;let a=Zi(o[3]||"int",void 0),c=o[1],u=Be("code",o[4]),h=Be("p",`${a} ${s?`${e}.`:""}${c} = ${u}`),v=Be("p",po(i.documentation,r.native_class));return{body:Be("div",h+v)}}break;case Kt.SymbolKind.Event:{let o=/\.([A-z0-9]+)\((.*)?\)/.exec(i.detail);if(!o)return;let a=(o[2]||"").replace(/\:\s([A-z0-9_]+)(\,\s*)?/g,`: <a href="" onclick="inspect('$1')">$1</a>$2`),c=Be("p",`${s?`signal ${s?`${e}.`:""}`:""}${i.name}( ${a} )`),u=Be("p",po(i.documentation,r.native_class));return{body:Be("div",c+u)}}break;case Kt.SymbolKind.Method:case Kt.SymbolKind.Function:{let o=t(i,s),a=Be("h4",o),c=Be("p",po(i.documentation,r.native_class)),u=Be("div",a+c);return{index:o,body:u}}break;default:break}}if(r.kind==Kt.SymbolKind.Class){let i=Be("h2",`Native class ${r.name}`),s=/extends\s+([A-z0-9]+)/.exec(r.detail),o=s&&s.length>1?s[1]:"";if(o){let f="",_=r.class_info[o];for(;_;)f+=`${f?" >":""} ${Zi(_.name,void 0)}`,_=r.class_info[_.inherits];o=`Inherits: ${f}`,i+=Be("p",o)}if(r.class_info&&r.class_info.extended_classes){let f="";for(let _ of r.class_info.extended_classes)f+=(f?", ":" ")+Zi(_,_);i+=Be("p",`Inherited by:${f}`)}let a="",c="",u="",h="",v="",m="",b="";for(let f of r.children){let _=n(f);switch(f.kind){case Kt.SymbolKind.Property:case Kt.SymbolKind.Variable:v+=Be("li",_.index),m+=Be("li",_.body,{id:f.name});break;case Kt.SymbolKind.Constant:a+=Be("li",_.body,{id:f.name});break;case Kt.SymbolKind.Event:c+=Be("li",_.body,{id:f.name});break;case Kt.SymbolKind.Method:case Kt.SymbolKind.Function:u+=Be("li",_.index),h+=Be("li",_.body,{id:f.name});break;default:b+=Be("li",_.body,{id:f.name});break}}let k=(f,_)=>{_&&(i+=Be("h3",f),i+=Be("ul",_))};return i+=Be("p",po(r.documentation,r.native_class)),k("Properties",v),k("Constants",a),k("Signals",c),k("Methods",u),k("Property Descriptions",m),k("Method Descriptions",h),k("Other Members",b),i+=Be("script",`var godot_class = "${r.native_class}";`),i}else{let i="",s=n(r,!0);return s.index&&([Kt.SymbolKind.Function,Kt.SymbolKind.Method].includes(r.kind)||(i+=Be("h2",s.index))),i+=Be("div",s.body),i}}function Be(r,e,t={},n,i){let s="";for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s+=` ${o}="${t[o]}"`);return`${i||""}<${r} ${s}>${e}</${r}>${n?`
`:""}`}function Zi(r,e){return!e||e==r?Be("a",r,{onclick:`inspect('${r}')`,href:""}):Be("a",`${r}.${e}`,{onclick:`inspect('${r}', '${e}')`,href:""})}function Pf(r,e){let t=r.split(`
`),n=t[0].match(/^\s*/)[0].length;return r=t.map(i=>i.slice(n)).join(`
`),xe.parse(`\`\`\`${e}
${r}
\`\`\``)}function po(r,e){let t=ET.parse(r.trim());t=t.replaceAll(/\[\/?codeblocks\](<br\/>)?/g,""),t=t.replaceAll("&quot;",'"');for(let n of t.matchAll(/\[codeblock].*?\[\/codeblock]/gs)){let i=n[0];i=i.replaceAll(/\[\/?codeblock\](<br\/>)?/g,""),i=i.replaceAll("<br/>",`
`),t=t.replace(n[0],Pf(i,"gdscript"))}for(let n of t.matchAll(/\[gdscript].*?\[\/gdscript]/gs)){let i=n[0];i=i.replaceAll(/\[\/?gdscript\](<br\/>)?/g,""),i=i.replaceAll("<br/>",`
`),t=t.replace(n[0],Pf(i,"gdscript"))}for(let n of t.matchAll(/\[csharp].*?\[\/csharp]/gs)){let i=n[0];i=i.replaceAll(/\[\/?csharp\](<br\/>)?/g,""),i=i.replaceAll("<br/>",`
`),t=t.replace(n[0],Pf(i,"csharp"))}return t=t.replaceAll("<br/>		",""),t=t.replaceAll(/\[param\s+(@?[A-Z_a-z][A-Z_a-z0-9]*?)\]/g,"<code>$1</code>"),t=t.replaceAll(/\[method\s+(@?[A-Z_a-z][A-Z_a-z0-9]*?)\]/g,`<a href="" onclick="inspect('${e}', '$1')">$1</a>`),t=t.replaceAll(/\[(\w+)\]/g,`<a href="" onclick="inspect('$1')">$1</a>`),t=t.replaceAll(/\[\w+\s+(@?[A-Z_a-z][A-Z_a-z0-9]*?)\.(\w+)\]/g,`<a href="" onclick="inspect('$1', '$2')">$1.$2</a>`),t}var TT={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},"string-interpolation":{pattern:/(?:f|rf|fr)(?:("""|''')[\s\S]+?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:{{)*){(?!{)(?:[^{}]|{(?!{)(?:[^{}]|{(?!{)(?:[^{}])+})+})+}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|rb|br)?("""|''')[\s\S]+?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|rb|br)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)func[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^\s*)@\w+(?:\.\w+)*/im,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:if|elif|else|for|while|break|continue|pass|return|match|func|class|class_name|extends|is|onready|tool|static|export|setget|const|var|as|void|enum|preload|assert|yield|signal|breakpoint|rpc|sync|master|puppet|slave|remotesync|mastersync|puppetsync)\b/,builtin:/\b(?:PI|TAU|NAN|INF|_|sin|cos|tan|sinh|cosh|tanh|asin|acos|atan|atan2|sqrt|fmod|fposmod|floor|ceil|round|abs|sign|pow|log|exp|is_nan|is_inf|ease|decimals|stepify|lerp|dectime|randomize|randi|randf|rand_range|seed|rand_seed|deg2rad|rad2deg|linear2db|db2linear|max|min|clamp|nearest_po2|weakref|funcref|convert|typeof|type_exists|char|str|print|printt|prints|printerr|printraw|var2str|str2var|var2bytes|bytes2var|range|load|inst2dict|dict2inst|hash|Color8|print_stack|instance_from_id|preload|yield|assert|Vector2|Vector3|Color|Rect2|Array|Basis|Dictionary|Plane|Quat|RID|Rect3|Transform|Transform2D|AABB|String|Color|NodePath|RID|Object|Dictionary|Array|PoolByteArray|PoolIntArray|PoolRealArray|PoolStringArray|PoolVector2Array|PoolVector3Array|PoolColorArray)\b/,boolean:/\b(?:true|false)\b/,number:/(?:\b(?=\d)|\B(?=\.))(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};var F1=Te("providers.docs"),ic=class{constructor(e){this.context=e;let t={webviewOptions:{enableScripts:!0,retainContextWhenHidden:!0,enableFindWidget:!0},supportsMultipleEditorsPerDocument:!0};e.subscriptions.push(Ji.window.registerCustomEditorProvider("gddoc",this,t))}classInfo=new Map;symbolDb=new Map;htmlDb=new Map;ready=!1;register_capabilities(e){for(let t of e.params.native_classes)this.classInfo.set(t.name,t);for(let t of this.classInfo.values())if(t.inherits){this.classInfo.has(t.inherits)||this.classInfo.set(t.inherits,{name:t.inherits,inherits:""});let n=this.classInfo.get(t.inherits).extended_classes||[];n.push(t.name),this.classInfo.get(t.inherits).extended_classes=n}this.ready=!0}async list_native_classes(){let e=await Ji.window.showQuickPick([...this.classInfo.keys()].sort(),{placeHolder:"Type godot class name here",canPickMany:!1});e&&Ji.commands.executeCommand("vscode.open",sr(e))}openCustomDocument(e,t,n){return{uri:e,dispose:()=>{}}}async resolveCustomEditor(e,t,n){let i=e.uri.path.split(".")[0],s=e.uri.fragment,o=null;for(t.webview.options={enableScripts:!0};!this.ready;)await new Promise(a=>setTimeout(a,100));if(o=this.symbolDb.get(i),!o&&this.classInfo.has(i)){let a={native_class:i,symbol_name:i};o=await it.lsp.client.sendRequest("textDocument/nativeSymbol",a),o.class_info=this.classInfo.get(o.name),this.symbolDb.set(o.name,o)}this.htmlDb.has(i)||this.htmlDb.set(i,Yb(t.webview,o,s)),t.webview.html=this.htmlDb.get(i),t.iconPath=tn("resources/godot_icon.svg"),t.webview.onDidReceiveMessage(a=>{if(a.type==="INSPECT_NATIVE_SYMBOL"){let c=sr(a.data.native_class,a.data.symbol_name);Ji.commands.executeCommand("vscode.open",c)}}),s&&t.webview.postMessage({command:"focus",target:s})}};var Df=Se(require("vscode"));var j1=Te("providers.tasks");var zn=Se(require("vscode"));var ay=Se(require("vscode")),cy=Se(Qb()),uy=require("events");var wc=Se(ri()),ry=require("events");var zP=Se(tv(),1),GP=Se(Uf(),1),VP=Se(zf(),1),Zf=Se(Xf(),1),WP=Se(Jv(),1);var iy=require("net");var ey=Buffer.from("\r","ascii")[0],ty=Buffer.from(`
`,"ascii")[0],HP=`\r
`,ko=class{encoding;index;buffer;constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(8192)}append(e){var t=e;if(typeof e=="string"){var n=e,i=Buffer.byteLength(n,this.encoding);t=Buffer.allocUnsafe(i),t.write(n,0,i,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var s=(Math.ceil((this.index+t.length)/8192)+1)*8192;this.index===0?(this.buffer=Buffer.allocUnsafe(s),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],s)}this.index+=t.length}tryReadHeaders(){let e,t=0;for(;t+3<this.index&&(this.buffer[t]!==ey||this.buffer[t+1]!==ty||this.buffer[t+2]!==ey||this.buffer[t+3]!==ty);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split(HP).forEach(s=>{let o=s.indexOf(":");if(o===-1)throw new Error("Message header must separate key and value using :");let a=s.substr(0,o),c=s.substr(o+1).trim();e[a]=c});let i=t+4;return this.buffer=this.buffer.slice(i),this.index=this.index-i,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),n=e;return this.buffer.copy(this.buffer,0,n),this.index=this.index-n,t}get numberOfBytes(){return this.index}};var sy=Te("lsp.io",{output:"Godot LSP"}),mc=class extends ry.EventEmitter{reader=null;writer=null;send_message(e){}on_message(e){let t=e.toString();this.emit("data",t)}on_send_message(e){this.emit("send_message",e)}on_message_callback(e){this.emit("message",e)}async connect_to_language_server(e,t){}},_c=class extends mc{socket=null;send_message(e){this.socket&&this.socket.send(e)}async connect_to_language_server(e,t){return new Promise((n,i)=>{this.socket=null;let s=new Zf.default(`ws://${e}:${t}`);s.on("open",()=>{this.on_connected(s),n()}),s.on("message",this.on_message.bind(this)),s.on("error",this.on_disconnected.bind(this)),s.on("close",this.on_disconnected.bind(this))})}on_connected(e){this.socket=e,this.emit("connected")}on_disconnected(){this.socket=null,this.emit("disconnected")}},bc=class extends mc{socket=null;send_message(e){this.socket&&this.socket.write(e)}async connect_to_language_server(e,t){return new Promise((n,i)=>{this.socket=null;let s=new iy.Socket;s.connect(t,e),s.on("connect",()=>{this.on_connected(s),n()}),s.on("data",this.on_message.bind(this)),s.on("end",this.on_disconnected.bind(this)),s.on("close",this.on_disconnected.bind(this)),s.on("error",this.on_error.bind(this))})}on_connected(e){this.socket=e,this.emit("connected")}on_disconnected(){this.socket=null,this.emit("disconnected")}on_error(e){}},vc=class extends wc.AbstractMessageReader{io;callback;buffer;nextMessageLength;messageToken;partialMessageTimer;_partialMessageTimeout;constructor(e,t="utf8"){super(),this.io=e,this.io.reader=this,this.buffer=new ko(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.io.on("data",this.onData.bind(this)),this.io.on("error",this.fireError.bind(this)),this.io.on("close",this.fireClose.bind(this))}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders();if(!i)return;let s=i["Content-Length"];if(!s)throw new Error("Header must provide a Content-Length property.");let o=parseInt(s);if(isNaN(o))throw new Error("Content-Length value must be a number.");this.nextMessageLength=o}var t=this.buffer.tryReadContent(this.nextMessageLength);if(t===null){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var n=JSON.parse(t);sy.debug("rx:",n),this.callback(n),this.io.on_message_callback(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}},KP="Content-Length: ",ny=`\r
`,yc=class extends wc.AbstractMessageWriter{io;encoding;errorCount;constructor(e,t="utf8"){super(),this.io=e,this.io.writer=this,this.encoding=t,this.errorCount=0,this.io.on("error",n=>this.fireError(n)),this.io.on("close",()=>this.fireClose())}end(){}write(e){if(e.method==="didChangeWatchedFiles")return;let t=JSON.stringify(e),n=Buffer.byteLength(t,this.encoding),i=[KP,n.toString(),ny,ny];try{this.io.on_send_message(e),this.io.send_message(i.join("")),sy.debug("tx:",e),this.io.send_message(t),this.errorCount=0}catch(s){this.errorCount++,this.fireError(s,e,this.errorCount)}}};var Jf=Te("lsp.client",{output:"Godot LSP"});var oy="gdscript_client/",To=class extends cy.LanguageClient{constructor(t){super("GDScriptLanguageClient",()=>new Promise((n,i)=>{n({reader:new vc(this.io),writer:new yc(this.io)})}),{documentSelector:[{scheme:"file",language:"gdscript"},{scheme:"untitled",language:"gdscript"}],synchronize:{fileEvents:ay.workspace.createFileSystemWatcher("**/*.gd")}});this.context=t;this.status=0,this.io.on("disconnected",this.on_disconnected.bind(this)),this.io.on("connected",this.on_connected.bind(this)),this.io.on("message",this.on_message.bind(this)),this.io.on("send_message",this.on_send_message.bind(this)),this.messageHandler=new eh(this.io)}io=Ve("lsp.serverProtocol")=="ws"?new _c:new bc;_status_changed_callbacks=[];_initialize_request=null;messageHandler=null;target=1;port=-1;lastPortTried=-1;sentMessages=new Map;lastSymbolHovered="";_started=!1;get started(){return this._started}_status;get status(){return this._status}set status(t){if(this._status!=t){this._status=t;for(let n of this._status_changed_callbacks)n(t)}}watch_status(t){this._status_changed_callbacks.indexOf(t)==-1&&this._status_changed_callbacks.push(t)}async list_classes(){await it.docsProvider.list_native_classes()}connect_to_server(t=1){this.target=t,this.status=0;let n=Ve("lsp.serverPort");this.port!==-1&&(n=this.port),this.target==1&&(n===6005||n===6008)&&(n=6005),this.lastPortTried=n;let i=Ve("lsp.serverHost");Jf.info(`attempting to connect to LSP at ${i}:${n}`),this.io.connect_to_language_server(i,n)}start(){return this._started=!0,super.start()}on_send_message(t){this.sentMessages.set(t.id,t),t.method=="initialize"&&(this._initialize_request=t)}on_message(t){if(JSON.stringify(t).match(/"target":"file:\/\/[^\/][^"]*"/)){let s=t.result.length;for(let o=0;o<s;o++){let a=t.result[o].target;t.result[o].target=a.replace("file://","file:///")}}if("method"in t&&t.method==="gdscript/capabilities"&&it.docsProvider.register_capabilities(t),"id"in t){let s=this.sentMessages.get(t.id);if(s&&s.method==="textDocument/hover"){let o=t.result.contents?.value;o&&(o=o.replace(/\n[#]+/g,`
`),o=o.replaceAll("`br`",`

`),o=o.replace("`codeblocks`",""),o=o.replace("`/codeblocks`",""),o=o.replace("`gdscript`","\nGDScript:\n```gdscript"),o=o.replace("`/gdscript`","```"),o=o.replace("`csharp`","\nC#:\n```csharp"),o=o.replace("`/csharp`","```"),t.result.contents.value=o)}}this.messageHandler.on_message(t)}async get_symbol_at_position(t,n){let i={textDocument:{uri:t.toString()},position:{line:n.line,character:n.character}},s=await this.sendRequest("textDocument/hover",i);return this.parse_hover_response(s)}parse_hover_response(t){let n=t.contents,i;if(n instanceof Array?i=n[0]:i=n.value,!i)return"";i=i.split(`
`)[0].trim();let s,o;return s=i.match(/(?:func|const) (@?\w+)\.(\w+)/),s&&(o=`${s[1]}.${s[2]}`),s=i.match(/<Native> class (\w+)/),s&&(o=`${s[1]}`),o}on_connected(){this._initialize_request&&this.io.writer.write(this._initialize_request),this.status=2;let t=Ve("lsp.serverHost");Jf.info(`connected to LSP at ${t}:${this.lastPortTried}`)}on_disconnected(){if(this.target==1){let t=Ve("lsp.serverHost"),n=Ve("lsp.serverPort");if((n===6005||n===6008)&&this.lastPortTried===6005){n=6008,Jf.info(`attempting to connect to LSP at ${t}:${n}`),this.lastPortTried=n,this.io.connect_to_language_server(t,n);return}}this.status=1}},eh=class extends uy.EventEmitter{io=null;constructor(e){super(),this.io=e}on_message(e){if(e&&e.result&&e.result.range&&e.result.contents&&(e.result.range=void 0),e&&e.method&&e.method.startsWith(oy)){let t=e.method.substring(oy.length,e.method.length);if(this[t]){let n=this[t](e.params);n&&this.io.writer.write(n)}}}};var pi=Se(require("vscode"));function th(){let r="Reload VSCode to apply settings";pi.window.showErrorMessage(r,"Reload").then(e=>{e=="Reload"&&pi.commands.executeCommand("workbench.action.reloadWindow")})}function nh(r){pi.window.showOpenDialog({openLabel:"Select Godot executable",filters:process.platform==="win32"?{"Godot Editor Binary":["exe","EXE"]}:void 0}).then(async e=>{if(!e)return;let t=e[0].fsPath;Uo(r,t),th()})}function pn(r,e){pi.window.showErrorMessage(r,"Select Godot executable","Open Settings","Ignore").then(t=>{t=="Select Godot executable"&&nh(e),t=="Open Settings"&&pi.commands.executeCommand("workbench.action.openSettings",e)})}var Po=require("child_process");var YP=Te("subspawn"),gi={};function vr(r){r in gi&&(gi[r].forEach(e=>{try{e.pid&&(process.platform==="win32"?(0,Po.execSync)(`taskkill /pid ${e.pid} /T /F`):process.platform==="darwin"?(0,Po.execSync)(`kill -9 ${e.pid}`):process.kill(e.pid))}catch{YP.error(`couldn't kill task ${r}`)}}),gi[r]=[])}process.on("exit",()=>{Object.keys(gi).forEach(r=>vr(r))});function rh(){process.exit()}process.on("SIGINT",rh);process.on("SIGTERM",rh);process.on("SIGQUIT",rh);function qr(r,e,t){let n=(0,Po.spawn)(e,t);return gi[r]=gi[r]||[],gi[r].push(n),n}var ly=Te("lsp.manager",{output:"Godot LSP"});var Io=class{constructor(e){this.context=e;this.context=e,this.client=new To(e),this.client.watch_status(this.on_client_status_changed.bind(this)),setInterval(()=>{this.retry_callback()},Ve("lsp.autoReconnect.cooldown")),ln("connectedToLSP",!1),this.statusWidget=zn.window.createStatusBarItem(zn.StatusBarAlignment.Right),this.statusWidget.command="godotTools.checkStatus",this.statusWidget.show(),this.update_status_widget(),e.subscriptions.push(Ke("startLanguageServer",()=>{this.start_language_server(),this.reconnectionAttempts=0,this.target=0,this.client.connect_to_server(this.target)}),Ke("stopLanguageServer",this.stop_language_server.bind(this)),Ke("checkStatus",this.on_status_item_click.bind(this)),this.statusWidget),this.connect_to_language_server()}client=null;reconnectionAttempts=0;target=1;status=0;statusWidget=null;connectedVersion="";async connect_to_language_server(){this.client.port=-1,this.target=1,this.connectedVersion=void 0,Ve("lsp.headless")&&(this.target=0,await this.start_language_server()),this.reconnectionAttempts=0,this.client.connect_to_server(this.target)}stop_language_server(){vr("LSP")}async start_language_server(){this.stop_language_server();let e=await ki();if(!e){zn.window.showErrorMessage("Current workspace is not a Godot project");return}let t=await en(),n="6",i="3.6";t.startsWith("4")&&(n="2",i="4.2");let s=`editorPath.godot${t[0]}`,o=Ve(s).replace(/^"/,"").replace(/"$/,""),a=Pn(o,t[0]);switch(a.status){case"WRONG_VERSION":{let m=`Cannot launch headless LSP: The current project uses Godot v${t}, but the specified Godot executable is v${a.version}`;pn(m,s);return}case"INVALID_EXE":{let m=`Cannot launch headless LSP: '${o}' is not a valid Godot executable`;pn(m,s);return}}if(this.connectedVersion=a.version,a.version[2]<n){let m=`Cannot launch headless LSP: Headless LSP mode is only available on v${i} or newer, but the specified Godot executable is v${a.version}.`;zn.window.showErrorMessage(m,"Select Godot executable","Open Settings","Disable Headless LSP","Ignore").then(b=>{b=="Select Godot executable"?nh(s):b=="Open Settings"?zn.commands.executeCommand("workbench.action.openSettings",s):b=="Disable Headless LSP"&&(Uo("lsp.headless",!1),th())});return}this.client.port=await Pi(),ly.info(`starting headless LSP on port ${this.client.port}`);let u=`"${o}" --path "${e}" --editor --headless --no-window --lsp-port ${this.client.port}`,h=qr("LSP",u,{shell:!0,detached:!0}),v=Te("lsp.stdout");h.stdout.on("data",m=>{let b=m.toString().trim();b&&v.debug(b)}),h.stderr.on("data",m=>{}),h.on("close",m=>{ly.info(`LSP process exited with code ${m}`)})}get_lsp_connection_string(){let e=Ve("lsp.serverHost"),t=Ve("lsp.serverPort");return this.client.port!==-1&&(t=this.client.port),`${e}:${t}`}on_status_item_click(){let e=this.get_lsp_connection_string();switch(this.status){case 0:break;case 1:break;case 2:break;case 5:{let t=`Connected to the GDScript language server at ${e}.`,n=["Ok"];this.target==0&&(n=["Restart LSP",...n]),zn.window.showInformationMessage(t,...n).then(i=>{i==="Restart LSP"&&this.connect_to_language_server()});break}case 4:this.retry_connect_client();break;case 6:this.show_retrying_prompt();break}}update_status_widget(){let e=this.get_lsp_connection_string(),t=Ve("lsp.autoReconnect.attempts"),n="",i="";switch(this.status){case 0:n="$(sync~spin) Initializing",i="Initializing extension...";break;case 1:n=`$(sync~spin) Initializing LSP ${this.reconnectionAttempts}/${t}`,i=`Connecting to headless GDScript language server.
${e}`,this.connectedVersion&&(i+=`
${this.connectedVersion}`);break;case 2:n="$(sync~spin) Connecting",i=`Connecting to the GDScript language server at ${e}`;break;case 5:n="$(check) Connected",i=`Connected to the GDScript language server.
${e}`,this.connectedVersion&&(i+=`
${this.connectedVersion}`);break;case 4:n="$(x) Disconnected",i="Disconnected from the GDScript language server.";break;case 6:n=`$(sync~spin) Connecting ${this.reconnectionAttempts}/${t}`,i=`Connecting to the GDScript language server.
${e}`,this.connectedVersion&&(i+=`
${this.connectedVersion}`);break}this.statusWidget.text=n,this.statusWidget.tooltip=i}on_client_status_changed(e){switch(e){case 0:this.status=2;break;case 2:this.retry=!1,ln("connectedToLSP",!0),this.status=5,this.client.started||this.context.subscriptions.push(this.client.start());break;case 1:ln("connectedToLSP",!1),this.retry?this.client.port!=-1?this.status=1:this.status=6:this.status=4,this.retry=!0;break;default:break}this.update_status_widget()}retry=!1;retry_callback(){this.retry&&this.retry_connect_client()}retry_connect_client(){let e=Ve("lsp.autoReconnect.enabled"),t=Ve("lsp.autoReconnect.attempts");if(e&&this.reconnectionAttempts<=t-1){this.reconnectionAttempts++,this.client.connect_to_server(this.target),this.retry=!0;return}this.retry=!1,this.status=4,this.update_status_widget(),this.show_retrying_prompt()}show_retrying_prompt(){let t=`Couldn't connect to the GDScript language server at ${this.get_lsp_connection_string()}. Is the Godot editor or language server running?`,n=["Retry","Ignore"];this.target==1&&(n=["Open workspace with Godot Editor",...n]),zn.window.showErrorMessage(t,...n).then(i=>{i=="Retry"&&this.connect_to_language_server(),i=="Open workspace with Godot Editor"&&(zn.commands.executeCommand("godotTools.openEditor"),this.connect_to_language_server())})}};var Kh=Se(require("fs")),Ze=require("vscode");var Dy=Se(require("fs")),Sn=Se(Ao()),Oy=require("vscode"),Bh=Se(Lh());var qh=require("path"),lL=Te("debugger.runtime"),ss=class{constructor(e=[],t=[],n=[]){this.locals=e;this.members=t;this.globals=n}remaining=0;reset(e=0){this.locals=[],this.members=[],this.globals=[],this.remaining=e}forEach(e,t){this.locals.forEach(e),this.members.forEach(e),this.globals.forEach(e)}},No=class extends Map{constructor(t){super();this.class_name=t}},Lo=class{constructor(e){this.id=e}stringify_value(){return`<${this.id}>`}sub_values(){return[{name:"id",value:this.id}]}type_name(){return"Object"}},os=class{breakpoint_id=0;breakpoints=new Map;last_frame;last_frames=[];projectPath;scene_tree;stack_count=0;stack_files=[];session;constructor(e){this.session=e}set_breakpoint(e,t){let n={file:e.replace(/\\/g,"/"),line:t,id:this.breakpoint_id++},i=this.breakpoints.get(n.file);if(i||(i=[],this.breakpoints.set(n.file,i)),i.push(n),this.projectPath){let s=`res://${qh.relative(this.projectPath,n.file)}`;this.session?.controller.set_breakpoint(s.replace(/\\/g,"/"),t)}}remove_breakpoint(e,t){let n=this.breakpoints.get(e);if(n){let i=n.findIndex(s=>s.line===t);if(i!==-1){let s=n[i];n.splice(i,1),this.breakpoints.set(e,n);let o=`res://${qh.relative(this.projectPath,s.file)}`;this.session?.controller.remove_breakpoint(o.replace(/\\/g,"/"),s.line)}}}get_all_breakpoints(){let e=[];return Array.from(this.breakpoints.values()).forEach(t=>{e.push(...t)}),e}get_breakpoints(e){return this.breakpoints.get(e)||[]}get_breakpoint_string(){let e=this.get_all_breakpoints(),t="";return e.length>0&&(t+=' --breakpoints "',e.forEach((n,i)=>{t+=`${this.get_breakpoint_path(n.file)}:${n.line}`,i<e.length-1&&(t+=",")}),t+='"'),t}get_breakpoint_path(e){let t=qh.relative(this.projectPath,e).replace(/\\/g,"/");if(t.length!==0)return`res://${t}`}};function zt(r){return+Number.parseFloat(String(r)).toFixed(1)}var as=class{constructor(e=0,t=0,n=0){this.x=e;this.y=t;this.z=n}stringify_value(){return`(${zt(this.x)}, ${zt(this.y)}, ${zt(this.z)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z}]}type_name(){return"Vector3"}},cs=class{constructor(e=0,t=0){this.x=e;this.y=t}stringify_value(){return`(${zt(this.x)}, ${zt(this.y)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y}]}type_name(){return"Vector2"}},us=class{constructor(e,t,n){this.x=e;this.y=t;this.z=n}stringify_value(){return`(${this.x.stringify_value()}, ${this.y.stringify_value()}, ${this.z.stringify_value()})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z}]}type_name(){return"Basis"}},ls=class{constructor(e,t){this.position=e;this.size=t}stringify_value(){return`(${this.position.stringify_value()}, ${this.size.stringify_value()})`}sub_values(){return[{name:"position",value:this.position},{name:"size",value:this.size}]}type_name(){return"AABB"}},ds=class{constructor(e,t,n,i=1){this.r=e;this.g=t;this.b=n;this.a=i}stringify_value(){return`(${zt(this.r)}, ${zt(this.g)}, ${zt(this.b)}, ${zt(this.a)})`}sub_values(){return[{name:"r",value:this.r},{name:"g",value:this.g},{name:"b",value:this.b},{name:"a",value:this.a}]}type_name(){return"Color"}},Ac=class{constructor(e,t,n){this.names=e;this.sub_names=t;this.absolute=n}stringify_value(){return`(/${this.names.join("/")}${this.sub_names.length>0?":":""}${this.sub_names.join(":")})`}sub_values(){return[{name:"names",value:this.names},{name:"sub_names",value:this.sub_names},{name:"absolute",value:this.absolute}]}type_name(){return"NodePath"}},fs=class extends Map{constructor(t){super();this.class_name=t}},bi=class{constructor(e){this.id=e}stringify_value(){return`<${this.id}>`}sub_values(){return[{name:"id",value:this.id}]}type_name(){return"Object"}},hs=class{constructor(e,t,n,i){this.x=e;this.y=t;this.z=n;this.d=i}stringify_value(){return`(${zt(this.x)}, ${zt(this.y)}, ${zt(this.z)}, ${zt(this.d)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z},{name:"d",value:this.d}]}type_name(){return"Plane"}},ps=class{constructor(e,t,n,i){this.x=e;this.y=t;this.z=n;this.w=i}stringify_value(){return`(${zt(this.x)}, ${zt(this.y)}, ${zt(this.z)}, ${zt(this.w)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z},{name:"w",value:this.w}]}type_name(){return"Quat"}},gs=class{constructor(e,t){this.position=e;this.size=t}stringify_value(){return`(${this.position.stringify_value()} - ${this.size.stringify_value()})`}sub_values(){return[{name:"position",value:this.position},{name:"size",value:this.size}]}type_name(){return"Rect2"}},ms=class{constructor(e,t){this.basis=e;this.origin=t}stringify_value(){return`(${this.basis.stringify_value()} - ${this.origin.stringify_value()})`}sub_values(){return[{name:"basis",value:this.basis},{name:"origin",value:this.origin}]}type_name(){return"Transform"}},_s=class{constructor(e,t,n){this.origin=e;this.x=t;this.y=n}stringify_value(){return`(${this.origin.stringify_value()} - (${this.x.stringify_value()}, ${this.y.stringify_value()})`}sub_values(){return[{name:"origin",value:this.origin},{name:"x",value:this.x},{name:"y",value:this.y}]}type_name(){return"Transform2D"}};var yr=require("vscode");var xy=require("path"),Ey=tn("resources","godot_icons").fsPath,Nc=class{_on_did_change_tree_data=new yr.EventEmitter;tree;onDidChangeTreeData=this._on_did_change_tree_data.event;constructor(){}fill_tree(e){this.tree=e,this._on_did_change_tree_data.fire(void 0)}getChildren(e){return this.tree?e?Promise.resolve(e.children):Promise.resolve([this.tree]):Promise.resolve([])}getTreeItem(e){let t=e.children.length>0,n=new yr.TreeItem(e.label,t?e===this.tree?yr.TreeItemCollapsibleState.Expanded:yr.TreeItemCollapsibleState.Collapsed:yr.TreeItemCollapsibleState.None);if(n.description=e.class_name,n.iconPath=e.iconPath,e.scene_file_path){let i="";i+=`${e.label}`,i+=`
${e.class_name}`,i+=`
${e.object_id}`,e.scene_file_path&&(i+=`
${e.scene_file_path}`),n.tooltip=i}return n}},bs=class extends yr.TreeItem{constructor(t,n,i,s,o,a){super(t);this.label=t;this.class_name=n;this.object_id=i;this.children=s;this.scene_file_path=o;this.view_flags=a;let c=n+".svg";this.iconPath={light:xy.join(Ey,"light",c),dark:xy.join(Ey,"dark",c)}}};function Fh(r,e={offset:0}){let t=r[e.offset++],n=r[e.offset++],i=r[e.offset++],s=r[e.offset++],o=[];for(let a=0;a<t;++a)o.push(Fh(r,e));return new bs(n,i,s,o)}function ky(r){let e=r.byteLength,t=0,n=[];for(;e>0;){let i=r.readUInt32LE(t)+4;n.push(r.subarray(t,t+i)),t+=i,e-=i}return n}function Ty(r){var e=typeof r.value;return["number","bigint","boolean","string"].some(t=>t==e)}function Lc(r){let e=r.value,t;e&&Array.isArray(e)?t=e.map((n,i)=>({name:`${i}`,value:n})):e instanceof Map?t=Array.from(e.keys()).map(n=>typeof n.stringify_value=="function"?{name:`${n.type_name()}${n.stringify_value()}`,value:e.get(n)}:{name:`${n}`,value:e.get(n)}):e&&typeof e.sub_values=="function"&&(t=e.sub_values().map(n=>({name:n.name,value:n.value}))),r.sub_values=t,t?.forEach(Lc)}function Mh(r,e){let t=r.value,n="",i=0,s=0,o;return typeof t=="number"?Number.isInteger(t)?n=`${t}`:n=`${parseFloat(t.toFixed(5))}`:typeof t=="bigint"||typeof t=="boolean"||typeof t=="string"?n=`${t}`:typeof t>"u"?n="null":Array.isArray(t)?(n=`Array[${t.length}]`,s=t.length,o="indexed",i=e||0):t instanceof Map?(n=t.class_name??`Dictionary[${t.size}]`,s=t.size,o="named",i=e||0):(n=`${t.type_name()}${t.stringify_value()}`,i=e||0),{name:r.name,value:n,variablesReference:i,array_size:s>0?s:void 0,filter:o}}var $h=Se(require("fs")),wr=require("vscode"),vs=Se(Ao());var qc=class{encode_variant(e,t){if(typeof e=="number"&&Number.isInteger(e)&&(e>2147483647||e<-2147483648)&&(e=BigInt(e)),!t){let n=this.size_variant(e);t={buffer:Buffer.alloc(n+4),offset:0,len:0},this.encode_UInt32(n,t)}switch(typeof e){case"number":Number.isInteger(e)?(this.encode_UInt32(2,t),this.encode_UInt32(e,t)):(this.encode_UInt32(65539,t),this.encode_Float(e,t));break;case"bigint":this.encode_UInt32(65538,t),this.encode_UInt64(e,t);break;case"boolean":this.encode_UInt32(1,t),this.encode_Bool(e,t);break;case"string":this.encode_UInt32(4,t),this.encode_String(e,t);break;case"undefined":break;default:Array.isArray(e)?(this.encode_UInt32(19,t),this.encode_Array(e,t)):e instanceof Map?(this.encode_UInt32(18,t),this.encode_Dictionary(e,t)):e instanceof cs?(this.encode_UInt32(5,t),this.encode_Vector2(e,t)):e instanceof gs?(this.encode_UInt32(6,t),this.encode_Rect2(e,t)):e instanceof as?(this.encode_UInt32(7,t),this.encode_Vector3(e,t)):e instanceof _s?(this.encode_UInt32(8,t),this.encode_Transform2D(e,t)):e instanceof hs?(this.encode_UInt32(9,t),this.encode_Plane(e,t)):e instanceof ps?(this.encode_UInt32(10,t),this.encode_Quat(e,t)):e instanceof ls?(this.encode_UInt32(11,t),this.encode_AABB(e,t)):e instanceof us?(this.encode_UInt32(12,t),this.encode_Basis(e,t)):e instanceof ms?(this.encode_UInt32(13,t),this.encode_Transform(e,t)):e instanceof ds&&(this.encode_UInt32(14,t),this.encode_Color(e,t))}return t.buffer}encode_AABB(e,t){this.encode_Vector3(e.position,t),this.encode_Vector3(e.size,t)}encode_Array(e,t){let n=e.length;this.encode_UInt32(n,t),e.forEach(i=>{this.encode_variant(i,t)})}encode_Basis(e,t){this.encode_Vector3(e.x,t),this.encode_Vector3(e.y,t),this.encode_Vector3(e.z,t)}encode_Bool(e,t){this.encode_UInt32(e?1:0,t)}encode_Color(e,t){this.encode_Float(e.r,t),this.encode_Float(e.g,t),this.encode_Float(e.b,t),this.encode_Float(e.a,t)}encode_Dictionary(e,t){let n=e.size;this.encode_UInt32(n,t),Array.from(e.keys()).forEach(s=>{let o=e.get(s);this.encode_variant(s,t),this.encode_variant(o,t)})}encode_Double(e,t){t.buffer.writeDoubleLE(e,t.offset),t.offset+=8}encode_Float(e,t){t.buffer.writeFloatLE(e,t.offset),t.offset+=4}encode_Plane(e,t){this.encode_Float(e.x,t),this.encode_Float(e.y,t),this.encode_Float(e.z,t),this.encode_Float(e.d,t)}encode_Quat(e,t){this.encode_Float(e.x,t),this.encode_Float(e.y,t),this.encode_Float(e.z,t),this.encode_Float(e.w,t)}encode_Rect2(e,t){this.encode_Vector2(e.position,t),this.encode_Vector2(e.size,t)}encode_String(e,t){let n=e.length;for(this.encode_UInt32(n,t),t.buffer.write(e,t.offset,n,"utf8"),t.offset+=n,n+=4;n%4;)n++,t.buffer.writeUInt8(0,t.offset),t.offset++}encode_Transform(e,t){this.encode_Basis(e.basis,t),this.encode_Vector3(e.origin,t)}encode_Transform2D(e,t){this.encode_Vector2(e.origin,t),this.encode_Vector2(e.x,t),this.encode_Vector2(e.y,t)}encode_UInt32(e,t){t.buffer.writeUInt32LE(e,t.offset),t.offset+=4}encode_UInt64(e,t){t.buffer.writeBigUInt64LE(e,t.offset),t.offset+=8}encode_Vector2(e,t){this.encode_Float(e.x,t),this.encode_Float(e.y,t)}encode_Vector3(e,t){this.encode_Float(e.x,t),this.encode_Float(e.y,t),this.encode_Float(e.z,t)}size_Bool(){return this.size_UInt32()}size_Dictionary(e){let t=this.size_UInt32();return Array.from(e.keys()).forEach(i=>{let s=e.get(i);t+=this.size_variant(i),t+=this.size_variant(s)}),t}size_String(e){let t=this.size_UInt32()+e.length;for(;t%4;)t++;return t}size_UInt32(){return 4}size_UInt64(){return 8}size_array(e){let t=this.size_UInt32();return e.forEach(n=>{t+=this.size_variant(n)}),t}size_variant(e){let t=4;switch(typeof e=="number"&&(e>2147483647||e<-2147483648)&&(e=BigInt(e)),typeof e){case"number":t+=this.size_UInt32();break;case"bigint":t+=this.size_UInt64();break;case"boolean":t+=this.size_Bool();break;case"string":t+=this.size_String(e);break;case"undefined":break;default:if(Array.isArray(e)){t+=this.size_array(e);break}else if(e instanceof Map){t+=this.size_Dictionary(e);break}else switch(e.__type__){case"Vector2":t+=this.size_UInt32()*2;break;case"Rect2":t+=this.size_UInt32()*4;break;case"Vector3":t+=this.size_UInt32()*3;break;case"Transform2D":t+=this.size_UInt32()*6;break;case"Plane":t+=this.size_UInt32()*4;break;case"Quat":t+=this.size_UInt32()*4;break;case"AABB":t+=this.size_UInt32()*6;break;case"Basis":t+=this.size_UInt32()*9;break;case"Transform":t+=this.size_UInt32()*12;break;case"Color":t+=this.size_UInt32()*4;break}}return t}};var Fc=class{decode_variant(e){let t=this.decode_UInt32(e);switch(t&255){case 1:return this.decode_UInt32(e)!==0;case 2:return t&65536?this.decode_Int64(e):this.decode_Int32(e);case 3:return t&65536?this.decode_Double(e):this.decode_Float(e);case 4:return this.decode_String(e);case 5:return this.decode_Vector2(e);case 6:return this.decode_Rect2(e);case 7:return this.decode_Vector3(e);case 8:return this.decode_Transform2D(e);case 9:return this.decode_Plane(e);case 10:return this.decode_Quat(e);case 11:return this.decode_AABB(e);case 12:return this.decode_Basis(e);case 13:return this.decode_Transform(e);case 14:return this.decode_Color(e);case 15:return this.decode_NodePath(e);case 17:return t&65536?this.decode_Object_id(e):this.decode_Object(e);case 18:return this.decode_Dictionary(e);case 19:return this.decode_Array(e);case 20:return this.decode_PoolByteArray(e);case 21:return this.decode_PoolIntArray(e);case 22:return this.decode_PoolFloatArray(e);case 23:return this.decode_PoolStringArray(e);case 24:return this.decode_PoolVector2Array(e);case 25:return this.decode_PoolVector3Array(e);case 26:return this.decode_PoolColorArray(e);default:return}}get_dataset(e){let t=e.readUInt32LE(0);if(e.length!=t+4)return;let n={buffer:e,offset:4,len:t},i=[];i.push(t+4);do{let s=this.decode_variant(n);i.push(s)}while(n.len>0);return i}decode_AABB(e){return new ls(this.decode_Vector3(e),this.decode_Vector3(e))}decode_Array(e){let t=[],n=this.decode_UInt32(e);for(let i=0;i<n;i++){let s=this.decode_variant(e);t.push(s)}return t}decode_Basis(e){return new us(this.decode_Vector3(e),this.decode_Vector3(e),this.decode_Vector3(e))}decode_Color(e){let t=this.decode_Vector3(e),n=this.decode_Float(e);return new ds(t.x,t.y,t.z,n)}decode_Dictionary(e){let t=new Map,n=this.decode_UInt32(e);for(let i=0;i<n;i++){let s=this.decode_variant(e),o=this.decode_variant(e);t.set(s,o)}return t}decode_Double(e){let t=e.buffer.readDoubleLE(e.offset);return e.offset+=8,e.len-=8,t}decode_Float(e){let t=e.buffer.readFloatLE(e.offset);return e.offset+=4,e.len-=4,t}decode_Int32(e){let t=e.buffer.readInt32LE(e.offset);return e.len-=4,e.offset+=4,t}decode_UInt32(e){let t=e.buffer.readUInt32LE(e.offset);return e.len-=4,e.offset+=4,t}decode_Int64(e){let t=e.buffer.readBigInt64LE(e.offset);return e.len-=8,e.offset+=8,t}decode_UInt64(e){let t=e.buffer.readBigUInt64LE(e.offset);return e.len-=8,e.offset+=8,t}decode_NodePath(e){let t=this.decode_UInt32(e)&2147483647,n=this.decode_UInt32(e),i=this.decode_UInt32(e),s=(i&1)===1;i&2&&n++;let o=t+n,a=[],c=[];for(let u=0;u<o;u++){let h=this.decode_String(e);u<t?a.push(h):c.push(h)}return new Ac(a,c,s)}decode_Object(e){let t=this.decode_String(e),n=this.decode_UInt32(e),i=new fs(t);for(let s=0;s<n;s++){let o=this.decode_String(e),a=this.decode_variant(e);i.set(o,a)}return i}decode_Object_id(e){let t=this.decode_UInt64(e);return new bi(t)}decode_Plane(e){let t=this.decode_Float(e),n=this.decode_Float(e),i=this.decode_Float(e),s=this.decode_Float(e);return new hs(t,n,i,s)}decode_PoolByteArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(e.buffer.readUInt8(e.offset)),e.offset++,e.len--;return n}decode_PoolColorArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Color(e));return n}decode_PoolFloatArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Float(e));return n}decode_PoolIntArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Int32(e));return n}decode_PoolStringArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_String(e));return n}decode_PoolVector2Array(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Vector2(e));return n}decode_PoolVector3Array(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Vector3(e));return n}decode_Quat(e){let t=this.decode_Float(e),n=this.decode_Float(e),i=this.decode_Float(e),s=this.decode_Float(e);return new ps(t,n,i,s)}decode_Rect2(e){return new gs(this.decode_Vector2(e),this.decode_Vector2(e))}decode_String(e){let t=this.decode_UInt32(e),n=0;t%4!==0&&(n=4-t%4);let i=e.buffer.toString("utf8",e.offset,e.offset+t);return t+=n,e.offset+=t,e.len-=t,i}decode_Transform(e){return new ms(this.decode_Basis(e),this.decode_Vector3(e))}decode_Transform2D(e){return new _s(this.decode_Vector2(e),this.decode_Vector2(e),this.decode_Vector2(e))}decode_Vector2(e){let t=this.decode_Float(e),n=this.decode_Float(e);return new cs(t,n)}decode_Vector3(e){let t=this.decode_Float(e),n=this.decode_Float(e),i=this.decode_Float(e);return new as(t,n,i)}};var Py=require("net"),bt=Te("debugger.controller",{output:"Godot Debugger"}),Iy=Te("debugger.socket"),jh=class{command="";paramCount=-1;parameters=[];complete=!1;threadId=0},Mc=class{constructor(e){this.session=e}commandBuffer=[];encoder=new qc;decoder=new Fc;draining=!1;exception="";server;socket;steppingOut=!1;currentCommand=void 0;didFirstOutput=!1;connectedVersion="";break(){this.send_command("break")}continue(){this.send_command("continue")}next(){this.send_command("next")}step(){this.send_command("step")}step_out(){this.steppingOut=!0,this.send_command("next")}set_breakpoint(e,t){this.send_command("breakpoint",[e,t,!0])}remove_breakpoint(e,t){this.session.debug_data.remove_breakpoint(e,t),this.send_command("breakpoint",[e,t,!1])}request_inspect_object(e){this.send_command("inspect_object",[e])}request_scene_tree(){this.send_command("request_scene_tree")}request_stack_dump(){this.send_command("get_stack_dump")}request_stack_frame_vars(e){this.send_command("get_stack_frame_vars",[e])}set_object_property(e,t,n){this.send_command("set_object_property",[e,t,n])}set_exception(e){this.exception=e}async start_game(e){bt.info("Starting game process");let t,n;if(e.editor_path)switch(bt.info("Using 'editor_path' variable from launch.json"),t=e.editor_path.replace(/^"/,"").replace(/"$/,""),bt.info(`Verifying version of '${t}'`),n=Pn(t,"3"),bt.info(`Verification result: ${n.status}, version: "${n.version}"`),n.status){case"WRONG_VERSION":{let c=`Cannot launch debug session: The current project uses Godot v${await en()}, but the specified Godot executable is v${n.version}`;bt.warn(c),wr.window.showErrorMessage(c,"Ok"),this.abort();return}case"INVALID_EXE":{let a=`Cannot launch debug session: '${t}' is not a valid Godot executable`;bt.warn(a),wr.window.showErrorMessage(a,"Ok"),this.abort();return}}else{bt.info("Using 'editorPath.godot3' from settings");let a="editorPath.godot3";switch(t=Ve(a).replace(/^"/,"").replace(/"$/,""),bt.info(`Verifying version of '${t}'`),n=Pn(t,"3"),bt.info(`Verification result: ${n.status}, version: "${n.version}"`),n.status){case"WRONG_VERSION":{let u=`Cannot launch debug session: The current project uses Godot v${await en()}, but the specified Godot executable is v${n.version}`;bt.warn(u),pn(u,a),this.abort();return}case"INVALID_EXE":{let c=`Cannot launch debug session: '${t}' is not a valid Godot executable`;bt.warn(c),pn(c,a),this.abort();return}}}this.connectedVersion=n.version;let i=`"${t}" --path "${e.project}"`,s=e.address.replace("tcp://","");if(i+=` --remote-debug "${s}:${e.port}"`,e.profiling&&(i+=" --profiling"),e.debug_collisions&&(i+=" --debug-collisions"),e.debug_paths&&(i+=" --debug-paths"),e.frame_delay&&(i+=` --frame-delay ${e.frame_delay}`),e.time_scale&&(i+=` --time-scale ${e.time_scale}`),e.fixed_fps&&(i+=` --fixed-fps ${e.fixed_fps}`),e.scene&&e.scene!=="main"){bt.info(`Custom scene argument provided: ${e.scene}`);let a=e.scene;if(e.scene==="current"){let c=wr.window.activeTextEditor.document.fileName;if(c.endsWith(".gd")&&(c=c.replace(".gd",".tscn"),!$h.existsSync(c))){let u=`Can't find associated scene file for ${c}`;bt.warn(u),wr.window.showErrorMessage(u,"Ok"),this.abort();return}a=c}if(e.scene==="pinned"){if(!ot){let u="No pinned scene found";bt.warn(u),wr.window.showErrorMessage(u,"Ok"),this.abort();return}let c=ot.fsPath;if(c.endsWith(".gd")&&(c=c.replace(".gd",".tscn"),!$h.existsSync(c))){let u=`Can't find associated scene file for ${c}`;bt.warn(u),wr.window.showErrorMessage(u,"Ok"),this.abort();return}a=c}i+=` "${a}"`}i+=this.session.debug_data.get_breakpoint_string(),e.additional_options&&(i+=" "+e.additional_options),bt.info(`Launching game process using command: '${i}'`);let o=qr("debug",i,{shell:!0});o.stdout.on("data",a=>{}),o.stderr.on("data",a=>{}),o.on("close",a=>{})}stash;on_data(e){this.stash&&(e=Buffer.concat([this.stash,e]),this.stash=void 0);let t=ky(e);for(;t.length>0;){let n=t.shift(),i=this.decoder.get_dataset(n)?.slice(1);if(i===void 0){this.stash=Buffer.alloc(n.length),n.copy(this.stash);return}this.parse_message(i)}}async launch(e){bt.info("Starting debug controller in 'launch' mode"),this.server=Py.createServer(t=>{this.socket=t,t.on("data",this.on_data.bind(this)),t.on("close",n=>{this.abort()}),t.on("end",()=>{this.abort()}),t.on("error",n=>{}),t.on("drain",()=>{t.resume(),this.draining=!1,this.send_buffer()})}),e.port===-1&&(e.port=await Pi()),this.server.listen(e.port,e.address),this.start_game(e)}async attach(e){bt.info("Starting debug controller in 'attach' mode"),this.server=Py.createServer(t=>{this.socket=t,t.on("data",this.on_data.bind(this)),t.on("close",n=>{}),t.on("end",()=>{}),t.on("error",n=>{}),t.on("drain",()=>{t.resume(),this.draining=!1,this.send_buffer()})}),this.server.listen(e.port,e.address)}parse_message(e){for((!this.currentCommand||this.currentCommand.complete)&&(this.currentCommand=new jh,this.currentCommand.command=e.shift());e&&e.length>0;)this.currentCommand.paramCount===-1?this.currentCommand.paramCount=e.shift():this.currentCommand.parameters.push(e.shift()),this.currentCommand.paramCount===this.currentCommand.parameters.length&&(this.currentCommand.complete=!0);this.currentCommand.complete&&(Iy.debug("rx:",[this.currentCommand.command,...this.currentCommand.parameters]),this.handle_command(this.currentCommand))}handle_command(e){switch(e.command){case"debug_enter":{let t=e.parameters[1];t!=="Breakpoint"?this.set_exception(t):this.set_exception(""),this.request_stack_dump();break}case"debug_exit":break;case"message:click_ctrl":break;case"performance":break;case"message:scene_tree":{let t=Fh(e.parameters);this.session.sceneTree.fill_tree(t);break}case"message:inspect_object":{let t=BigInt(e.parameters[0]),n=e.parameters[1],i=e.parameters[2],s=new fs(n);i.forEach(a=>{s.set(a[0],a[5])});let o={name:"",value:s};Lc(o),this.session.inspect_callbacks.has(BigInt(t))&&(this.session.inspect_callbacks.get(BigInt(t))(o.name,o),this.session.inspect_callbacks.delete(BigInt(t))),this.session.set_inspection(t,o);break}case"stack_dump":{let t=e.parameters.map((n,i)=>({id:i,file:n.get("file"),function:n.get("function"),line:n.get("line")}));this.trigger_breakpoint(t),this.request_scene_tree();break}case"stack_frame_vars":{this.do_stack_frame_vars(e.parameters);break}case"output":{this.didFirstOutput||(this.didFirstOutput=!0),e.parameters.forEach(t=>{wr.debug.activeDebugConsole.appendLine(t[0])});break}}}abort(){bt.info("Aborting debug controller"),this.session.sendEvent(new vs.TerminatedEvent),this.stop()}stop(){bt.info("Stopping debug controller"),vr("debug"),this.socket?.destroy(),this.server?.close(e=>{e&&bt.error(e),this.server.unref(),this.server=void 0})}trigger_breakpoint(e){let t=!1,n=e.length;if(n===0){this.session.debug_data.last_frames=[],this.session.sendEvent(new vs.StoppedEvent("breakpoint",0));return}let i=e[0].file.replace("res://",`${this.session.debug_data.projectPath}/`),s=e[0].line;if(this.steppingOut&&!this.session.debug_data.get_breakpoints(i).find(a=>a.line===s))if(this.session.debug_data.stack_count>1)t=this.session.debug_data.stack_count===n;else{let a=e[0].file===this.session.debug_data.last_frame.file,c=e[0].function===this.session.debug_data.last_frame.function,u=e[0].line>=this.session.debug_data.last_frame.line;t=a&&c&&u}if(this.session.debug_data.stack_count=n,this.session.debug_data.last_frame=e[0],this.session.debug_data.last_frames=e,t){this.next();return}this.steppingOut=!1,this.session.debug_data.stack_files=e.map(o=>o.file),this.exception.length===0?this.session.sendEvent(new vs.StoppedEvent("breakpoint",0)):(this.session.set_exception(!0),this.session.sendEvent(new vs.StoppedEvent("exception",0,this.exception)))}send_command(e,t=[]){let n=[e,...t];Iy.debug("tx:",n);let i=this.encoder.encode_variant(n);this.commandBuffer.push(i),this.send_buffer()}send_buffer(){if(this.socket)for(;!this.draining&&this.commandBuffer.length>0;){let e=this.commandBuffer.shift();this.draining=!this.socket.write(e)}}do_stack_frame_vars(e){let t=new ss,n=e[0],i=e[1+n*2],s=e[2+(n+i)*2],o=1;for(;n--;)t.locals.push({name:e[o++],value:e[o++]});for(o++;i--;)t.members.push({name:e[o++],value:e[o++]});for(o++;s--;)t.globals.push({name:e[o++],value:e[o++]});t.forEach(a=>Lc(a)),this.session.set_scopes(t)}};var HL=Te("debugger.session",{output:"Godot Debugger"}),$c=class extends Sn.LoggingDebugSession{all_scopes;controller=new Mc(this);debug_data=new os(this);sceneTree;exception=!1;got_scope=new Bh.Subject;ongoing_inspections=[];previous_inspections=[];configuration_done=new Bh.Subject;mode="";inspect_callbacks=new Map;constructor(){super(),this.setDebuggerLinesStartAt1(!1),this.setDebuggerColumnsStartAt1(!1)}dispose(){this.controller.stop()}initializeRequest(e,t){e.body=e.body||{},e.body.supportsConfigurationDoneRequest=!0,e.body.supportsTerminateRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsLogPoints=!1,e.body.supportsModulesRequest=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsRestartFrame=!1,e.body.supportsRestartRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsTerminateThreadsRequest=!1,this.sendResponse(e),this.sendEvent(new Sn.InitializedEvent)}async launchRequest(e,t){await this.configuration_done.wait(1e3),this.mode="launch",this.debug_data.projectPath=t.project,this.exception=!1,await this.controller.launch(t),this.sendResponse(e)}async attachRequest(e,t){await this.configuration_done.wait(1e3),this.mode="attach",this.exception=!1,await this.controller.attach(t),this.sendResponse(e)}configurationDoneRequest(e,t){this.configuration_done.notify(),this.sendResponse(e)}continueRequest(e,t){this.exception||(e.body={allThreadsContinued:!0},this.controller.continue(),this.sendResponse(e))}async evaluateRequest(e,t){if(await Oy.debug.activeDebugSession.customRequest("scopes",{frameId:0}),this.all_scopes){var n=this.get_variable(t.expression,null,null,null);if(n.error==null){var i=Mh(n.variable);e.body={result:i.value,variablesReference:Ty(n.variable)?0:n.index}}else e.success=!1,e.message=n.error}e.body||(e.body={result:"null",variablesReference:0}),this.sendResponse(e)}nextRequest(e,t){this.exception||(this.controller.next(),this.sendResponse(e))}pauseRequest(e,t){this.exception||(this.controller.break(),this.sendResponse(e))}async scopesRequest(e,t){this.controller.request_stack_frame_vars(t.frameId),await this.got_scope.wait(2e3),e.body={scopes:[{name:"Locals",variablesReference:1,expensive:!1},{name:"Members",variablesReference:2,expensive:!1},{name:"Globals",variablesReference:3,expensive:!1}]},this.sendResponse(e)}setBreakPointsRequest(e,t){let n=t.source.path.replace(/\\/g,"/"),i=t.lines||[];if(Dy.existsSync(n)){let s=this.debug_data.get_breakpoints(n),o=s.map(a=>a.line);s.forEach(a=>{i.indexOf(a.line)===-1&&this.debug_data.remove_breakpoint(n,a.line)}),i.forEach(a=>{o.indexOf(a)===-1&&(t.breakpoints.find(u=>u.line==a).condition||this.debug_data.set_breakpoint(n,a))}),s=this.debug_data.get_breakpoints(n),s.sort((a,c)=>a.line<c.line?-1:1),e.body={breakpoints:s.map(a=>new Sn.Breakpoint(!0,a.line,1,new Sn.Source(a.file.split("/").reverse()[0],a.file)))},this.sendResponse(e)}}stackTraceRequest(e,t){this.debug_data.last_frame&&(e.body={totalFrames:this.debug_data.last_frames.length,stackFrames:this.debug_data.last_frames.map(n=>({id:n.id,name:n.function,line:n.line,column:1,source:new Sn.Source(n.file,`${this.debug_data.projectPath}/${n.file.replace("res://","")}`)}))}),this.sendResponse(e)}stepInRequest(e,t){this.exception||(this.controller.step(),this.sendResponse(e))}stepOutRequest(e,t){this.exception||(this.controller.step_out(),this.sendResponse(e))}terminateRequest(e,t){this.mode==="launch"&&(this.controller.stop(),this.sendEvent(new Sn.TerminatedEvent)),this.sendResponse(e)}threadsRequest(e){e.body={threads:[new Sn.Thread(0,"thread_1")]},this.sendResponse(e)}async variablesRequest(e,t){if(!this.all_scopes){e.body={variables:[]},this.sendResponse(e);return}let n=this.all_scopes[t.variablesReference],i;n.sub_values?i=n.sub_values.map(s=>{let o=this.all_scopes.find(a=>a&&a.scope_path===s.scope_path&&a.name===s.name);if(o)return Mh(o,this.all_scopes.findIndex(a=>a&&a.scope_path===`${n.scope_path}.${n.name}`&&a.name===s.name))}):i=[],e.body={variables:i},this.sendResponse(e)}set_exception(e){this.exception=!0}set_scopes(e){this.all_scopes=[void 0,{name:"local",value:void 0,sub_values:e.locals,scope_path:"@"},{name:"member",value:void 0,sub_values:e.members,scope_path:"@"},{name:"global",value:void 0,sub_values:e.globals,scope_path:"@"}],e.locals.forEach(t=>{t.scope_path="@.local",this.append_variable(t)}),e.members.forEach(t=>{t.scope_path="@.member",this.append_variable(t)}),e.globals.forEach(t=>{t.scope_path="@.global",this.append_variable(t)}),this.add_to_inspections(),this.ongoing_inspections.length===0&&(this.previous_inspections=[],this.got_scope.notify())}set_inspection(e,t){this.all_scopes.filter(i=>i&&i.value instanceof bi&&i.value.id===e).forEach(i=>{let s=this.all_scopes.findIndex(a=>a===i),o=this.all_scopes.splice(s,1);t.name=o[0].name,t.scope_path=o[0].scope_path,this.append_variable(t,s)}),this.ongoing_inspections.splice(this.ongoing_inspections.findIndex(i=>i===e),1),this.previous_inspections.push(e),this.ongoing_inspections.length===0&&(this.previous_inspections=[],this.got_scope.notify())}add_to_inspections(){this.all_scopes.forEach(e=>{e&&e.value instanceof bi&&!this.ongoing_inspections.includes(e.value.id)&&!this.previous_inspections.includes(e.value.id)&&(this.controller.request_inspect_object(e.value.id),this.ongoing_inspections.push(e.value.id))})}get_variable(e,t=null,n=0,i=null){var s={variable:null,index:null,object_id:null,error:null};t||(e.includes("self")||(e="self."+e),t=this.all_scopes.find(f=>f&&f.name=="self"),i=this.all_scopes.find(f=>f&&f.name=="id"&&f.scope_path=="@.member.self").value);var o=e.split("."),a=o[n+1],c=o.slice(0,n+1).join(".").split("self.").join("").split("self").join("").split("[").join(".").split("]").join("");o.length==1&&o[0]=="self"&&(a="self");var u=(a.match(/(?<=\[).*(?=\])/)||[null])[0];u&&(u=u.replace(/['"]+/g,""),a=a.split(/(?<=\[).*(?=\])/).join("").split("[]").join(""),c&&(c+="."),c+=a,a=u);function h(f){return f.split("Members/").join("").split("Locals/").join("")}function v(f){return f.split("@.member.self.").join("").split("@.member.self").join("").split("@.member.").join("").split("@.member").join("").split("@.local.").join("").split("@.local").join("").split("Locals/").join("").split("Members/").join("").split("@").join("")}var m=this.all_scopes.filter(f=>f).map(function(f){return{sanitized:{name:h(f.name),scope_path:v(f.scope_path)},real:f}});if(s.variable=m.find(f=>f.sanitized.name==a&&f.sanitized.scope_path==c)?.real,!s.variable)return s.error=`Could not find: ${a}`,s;if(t.value.entries)if(s.variable.name=="self")s.object_id=this.all_scopes.find(f=>f&&f.name=="id"&&f.scope_path=="@.member.self").value;else if(u){var b=c.split(".")[c.split(".").length-1],k=Array.from(t.value.entries()).find(f=>f&&f[0].split("Members/").join("").split("Locals/").join("")==b)[1];s.object_id=k.get?k.get(u)?.id:k[u]?.id}else s.object_id=Array.from(t.value.entries()).find(f=>f&&f[0].split("Members/").join("").split("Locals/").join("")==a)[1].id;return s.object_id||(s.object_id=i),s.index=this.all_scopes.findIndex(f=>f&&f.name==s.variable.name&&f.scope_path==s.variable.scope_path),o.length>2&&n<o.length-2&&(s=this.get_variable(o.join("."),s.variable,n+1,s.object_id)),s}append_variable(e,t){t?this.all_scopes.splice(t,0,e):this.all_scopes.push(e);let n=`${e.scope_path}.${e.name}`;e.sub_values&&e.sub_values.forEach((i,s)=>{i.scope_path=n,this.append_variable(i,t?t+s+1:void 0)})}};var Fy=Se(require("fs")),Cn=Se(Ao()),My=require("vscode"),Wh=Se(Lh());var Xt=65536,Gc=65536;function vt(r){return+Number.parseFloat(String(r)).toFixed(1)}var $r=class{constructor(e=0,t=0,n=0){this.x=e;this.y=t;this.z=n}stringify_value(){return`(${vt(this.x)}, ${vt(this.y)}, ${vt(this.z)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z}]}type_name(){return"Vector3"}},ys=class extends $r{type_name(){return"Vector3i"}},jr=class{constructor(e=0,t=0,n=0,i=0){this.x=e;this.y=t;this.z=n;this.w=i}stringify_value(){return`(${vt(this.x)}, ${vt(this.y)}, ${vt(this.z)}, ${vt(this.w)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z},{name:"w",value:this.w}]}type_name(){return"Vector4"}},ws=class extends jr{type_name(){return"Vector4i"}},Br=class{constructor(e=0,t=0){this.x=e;this.y=t}stringify_value(){return`(${vt(this.x)}, ${vt(this.y)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y}]}type_name(){return"Vector2"}},Rs=class extends Br{type_name(){return"Vector2i"}},vi=class{constructor(e,t,n){this.x=e;this.y=t;this.z=n}stringify_value(){return`(${this.x.stringify_value()}, ${this.y.stringify_value()}, ${this.z.stringify_value()})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z}]}type_name(){return"Basis"}},yi=class{constructor(e,t){this.position=e;this.size=t}stringify_value(){return`(${this.position.stringify_value()}, ${this.size.stringify_value()})`}sub_values(){return[{name:"position",value:this.position},{name:"size",value:this.size}]}type_name(){return"AABB"}},Ss=class{constructor(e,t,n,i=1){this.r=e;this.g=t;this.b=n;this.a=i}stringify_value(){return`(${vt(this.r)}, ${vt(this.g)}, ${vt(this.b)}, ${vt(this.a)})`}sub_values(){return[{name:"r",value:this.r},{name:"g",value:this.g},{name:"b",value:this.b},{name:"a",value:this.a}]}type_name(){return"Color"}},jc=class{constructor(e,t,n){this.names=e;this.sub_names=t;this.absolute=n}stringify_value(){return`(/${this.names.join("/")}${this.sub_names.length>0?":":""}${this.sub_names.join(":")})`}sub_values(){return[{name:"names",value:this.names},{name:"sub_names",value:this.sub_names},{name:"absolute",value:this.absolute}]}type_name(){return"NodePath"}},Cs=class extends Map{constructor(t){super();this.class_name=t}},Ur=class{constructor(e){this.id=e}stringify_value(){return`<${this.id}>`}sub_values(){return[{name:"id",value:this.id}]}type_name(){return"Object"}},Bc=class extends Ur{type_name(){return"RID"}},wi=class{constructor(e,t,n,i){this.x=e;this.y=t;this.z=n;this.d=i}stringify_value(){return`(${vt(this.x)}, ${vt(this.y)}, ${vt(this.z)}, ${vt(this.d)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z},{name:"d",value:this.d}]}type_name(){return"Plane"}},Ri=class{constructor(e,t,n,i){this.x=e;this.y=t;this.z=n;this.w=i}stringify_value(){return`(${vt(this.x)}, ${vt(this.y)}, ${vt(this.z)}, ${vt(this.w)})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z},{name:"w",value:this.w}]}type_name(){return"Quat"}},zr=class{constructor(e,t){this.position=e;this.size=t}stringify_value(){return`(${this.position.stringify_value()} - ${this.size.stringify_value()})`}sub_values(){return[{name:"position",value:this.position},{name:"size",value:this.size}]}type_name(){return"Rect2"}},xs=class extends zr{type_name(){return"Rect2i"}},Si=class{constructor(e,t,n,i){this.x=e;this.y=t;this.z=n;this.w=i}stringify_value(){return`(${this.x.stringify_value()}, ${this.y.stringify_value()}, ${this.z.stringify_value()}, ${this.w.stringify_value()})`}sub_values(){return[{name:"x",value:this.x},{name:"y",value:this.y},{name:"z",value:this.z},{name:"w",value:this.w}]}type_name(){return"Projection"}},Ci=class{constructor(e,t){this.basis=e;this.origin=t}stringify_value(){return`(${this.basis.stringify_value()} - ${this.origin.stringify_value()})`}sub_values(){return[{name:"basis",value:this.basis},{name:"origin",value:this.origin}]}type_name(){return"Transform"}},xi=class{constructor(e,t,n){this.origin=e;this.x=t;this.y=n}stringify_value(){return`(${this.origin.stringify_value()} - (${this.x.stringify_value()}, ${this.y.stringify_value()})`}sub_values(){return[{name:"origin",value:this.origin},{name:"x",value:this.x},{name:"y",value:this.y}]}type_name(){return"Transform2D"}},Ei=class{constructor(e){this.value=e}stringify_value(){return this.value}sub_values(){return[{name:"value",value:this.value}]}type_name(){return"StringName"}},Uc=class{stringify_value(){return"()"}sub_values(){return[]}type_name(){return"Callable"}},zc=class{constructor(e,t){this.name=e;this.oid=t}stringify_value(){return`${this.name}() ${this.oid.stringify_value()}`}sub_values(){}type_name(){return"Signal"}};function Uh(r,e={offset:0}){let t=r[e.offset++],n=r[e.offset++],i=r[e.offset++],s=r[e.offset++],o=r[e.offset++],a=r[e.offset++],c=[];for(let u=0;u<t;++u)c.push(Uh(r,e));return new bs(n,i,s,c,o,a)}function Ay(r){let e=r.byteLength,t=0,n=[];for(;e>0;){let i=r.readUInt32LE(t)+4;n.push(r.subarray(t,t+i)),t+=i,e-=i}return n}function Ny(r){var e=typeof r.value;return["number","bigint","boolean","string"].some(t=>t==e)}function Vc(r){let e=r.value,t;e&&Array.isArray(e)?t=e.map((n,i)=>({name:`${i}`,value:n})):e instanceof Map?t=Array.from(e.keys()).map(n=>typeof n.stringify_value=="function"?{name:`${n.type_name()}${n.stringify_value()}`,value:e.get(n)}:{name:`${n}`,value:e.get(n)}):e&&typeof e.sub_values=="function"&&(t=e.sub_values().map(n=>({name:n.name,value:n.value}))),r.sub_values=t,t?.forEach(Vc)}function zh(r,e){let t=r.value,n="",i=0,s=0,o;return typeof t=="number"?Number.isInteger(t)?n=`${t}`:n=`${parseFloat(t.toFixed(5))}`:typeof t=="bigint"||typeof t=="boolean"||typeof t=="string"?n=`${t}`:typeof t>"u"?n="null":Array.isArray(t)?(n=`Array[${t.length}]`,s=t.length,o="indexed",i=e||0):t instanceof Map?(n=t.class_name??`Dictionary[${t.size}]`,s=t.size,o="named",i=e||0):(n=`${t.type_name()}${t.stringify_value()}`,i=e||0),{name:r.name,value:n,variablesReference:i,array_size:s>0?s:void 0,filter:o}}var Gh=Se(require("fs")),Rr=require("vscode"),Es=Se(Ao());var Wc=class{encode_variant(e,t){if(typeof e=="number"&&Number.isInteger(e)&&(e>2147483647||e<-2147483648)&&(e=BigInt(e)),!t){let n=this.size_variant(e);t={buffer:Buffer.alloc(n+4),offset:0,len:0},this.encode_UInt32(n,t)}switch(typeof e){case"number":Number.isInteger(e)?(this.encode_UInt32(2,t),this.encode_UInt32(e,t)):(this.encode_UInt32(3,t),this.encode_Float32(e,t));break;case"bigint":this.encode_UInt32(2|Xt,t),this.encode_UInt64(e,t);break;case"boolean":this.encode_UInt32(1,t),this.encode_Bool(e,t);break;case"string":this.encode_UInt32(4,t),this.encode_String(e,t);break;case"undefined":break;default:Array.isArray(e)?(this.encode_UInt32(28,t),this.encode_Array(e,t)):e instanceof Map?(this.encode_UInt32(27,t),this.encode_Dictionary(e,t)):e instanceof Rs?(this.encode_UInt32(6,t),this.encode_Vector2i(e,t)):e instanceof Br?(this.encode_UInt32(5,t),this.encode_Vector2(e,t)):e instanceof xs?(this.encode_UInt32(8,t),this.encode_Rect2i(e,t)):e instanceof zr?(this.encode_UInt32(7,t),this.encode_Rect2(e,t)):e instanceof ys?(this.encode_UInt32(10,t),this.encode_Vector3i(e,t)):e instanceof $r?(this.encode_UInt32(9,t),this.encode_Vector3(e,t)):e instanceof ws?(this.encode_UInt32(13,t),this.encode_Vector4i(e,t)):e instanceof jr?(this.encode_UInt32(12,t),this.encode_Vector4(e,t)):e instanceof xi?(this.encode_UInt32(11,t),this.encode_Transform2D(e,t)):e instanceof Ei?(this.encode_UInt32(21,t),this.encode_StringName(e,t)):e instanceof wi?(this.encode_UInt32(14,t),this.encode_Plane(e,t)):e instanceof Si?(this.encode_UInt32(19,t),this.encode_Projection(e,t)):e instanceof Ri?(this.encode_UInt32(15,t),this.encode_Quaternion(e,t)):e instanceof yi?(this.encode_UInt32(16,t),this.encode_AABB(e,t)):e instanceof vi?(this.encode_UInt32(17,t),this.encode_Basis(e,t)):e instanceof Ci?(this.encode_UInt32(18,t),this.encode_Transform3D(e,t)):e instanceof Ss&&(this.encode_UInt32(20,t),this.encode_Color(e,t))}return t.buffer}encode_AABB(e,t){this.encode_Vector3(e.position,t),this.encode_Vector3(e.size,t)}encode_Array(e,t){let n=e.length;this.encode_UInt32(n,t),e.forEach(i=>{this.encode_variant(i,t)})}encode_Basis(e,t){this.encode_Vector3(e.x,t),this.encode_Vector3(e.y,t),this.encode_Vector3(e.z,t)}encode_Bool(e,t){this.encode_UInt32(e?1:0,t)}encode_Color(e,t){this.encode_Float32(e.r,t),this.encode_Float32(e.g,t),this.encode_Float32(e.b,t),this.encode_Float32(e.a,t)}encode_Dictionary(e,t){let n=e.size;this.encode_UInt32(n,t),Array.from(e.keys()).forEach(s=>{let o=e.get(s);this.encode_variant(s,t),this.encode_variant(o,t)})}encode_Float64(e,t){t.buffer.writeDoubleLE(e,t.offset),t.offset+=8}encode_Float32(e,t){t.buffer.writeFloatLE(e,t.offset),t.offset+=4}encode_Plane(e,t){this.encode_Float32(e.x,t),this.encode_Float32(e.y,t),this.encode_Float32(e.z,t),this.encode_Float32(e.d,t)}encode_Quaternion(e,t){this.encode_Float32(e.x,t),this.encode_Float32(e.y,t),this.encode_Float32(e.z,t),this.encode_Float32(e.w,t)}encode_Rect2(e,t){this.encode_Vector2(e.position,t),this.encode_Vector2(e.size,t)}encode_Rect2i(e,t){this.encode_Vector2i(e.position,t),this.encode_Vector2i(e.size,t)}encode_String(e,t){let n=e.length;for(this.encode_UInt32(n,t),t.buffer.write(e,t.offset,n,"utf8"),t.offset+=n,n+=4;n%4;)n++,t.buffer.writeUInt8(0,t.offset),t.offset++}encode_Transform3D(e,t){this.encode_Basis(e.basis,t),this.encode_Vector3(e.origin,t)}encode_Transform2D(e,t){this.encode_Vector2(e.origin,t),this.encode_Vector2(e.x,t),this.encode_Vector2(e.y,t)}encode_Projection(e,t){this.encode_Vector4(e.x,t),this.encode_Vector4(e.y,t),this.encode_Vector4(e.z,t),this.encode_Vector4(e.w,t)}encode_UInt32(e,t){t.buffer.writeUInt32LE(e,t.offset),t.offset+=4}encode_Int32(e,t){t.buffer.writeInt32LE(e,t.offset),t.offset+=4}encode_UInt64(e,t){t.buffer.writeBigUInt64LE(e,t.offset),t.offset+=8}encode_Vector2(e,t){this.encode_Float32(e.x,t),this.encode_Float32(e.y,t)}encode_Vector3(e,t){this.encode_Float32(e.x,t),this.encode_Float32(e.y,t),this.encode_Float32(e.z,t)}encode_Vector4(e,t){this.encode_Float32(e.x,t),this.encode_Float32(e.y,t),this.encode_Float32(e.z,t),this.encode_Float32(e.w,t)}encode_Vector2i(e,t){this.encode_Int32(e.x,t),this.encode_Int32(e.y,t)}encode_Vector3i(e,t){this.encode_Int32(e.x,t),this.encode_Int32(e.y,t),this.encode_Int32(e.z,t)}encode_Vector4i(e,t){this.encode_Int32(e.x,t),this.encode_Int32(e.y,t),this.encode_Int32(e.z,t),this.encode_Int32(e.w,t)}encode_StringName(e,t){this.encode_String(e.value,t)}size_Bool(){return this.size_UInt32()}size_Dictionary(e){let t=this.size_UInt32();return Array.from(e.keys()).forEach(i=>{let s=e.get(i);t+=this.size_variant(i),t+=this.size_variant(s)}),t}size_String(e){let t=this.size_UInt32()+e.length;for(;t%4;)t++;return t}size_UInt32(){return 4}size_UInt64(){return 8}size_array(e){let t=this.size_UInt32();return e.forEach(n=>{t+=this.size_variant(n)}),t}size_variant(e){let t=4;switch(typeof e=="number"&&(e>2147483647||e<-2147483648)&&(e=BigInt(e)),typeof e){case"number":t+=this.size_UInt32();break;case"bigint":t+=this.size_UInt64();break;case"boolean":t+=this.size_Bool();break;case"string":t+=this.size_String(e);break;case"undefined":break;default:if(Array.isArray(e)){t+=this.size_array(e);break}else if(e instanceof Map){t+=this.size_Dictionary(e);break}else if(e instanceof Ei){t+=this.size_String(e.value);break}else switch(e.__type__){case"Vector2":case"Vector2i":t+=this.size_UInt32()*2;break;case"Rect2":case"Rect2i":t+=this.size_UInt32()*4;break;case"Vector3":case"Vector3i":t+=this.size_UInt32()*3;break;case"Vector4":case"Vector4i":t+=this.size_UInt32()*4;break;case"Transform2D":t+=this.size_UInt32()*6;break;case"Projection":t+=this.size_UInt32()*16;break;case"Plane":t+=this.size_UInt32()*4;break;case"Quaternion":t+=this.size_UInt32()*4;break;case"AABB":t+=this.size_UInt32()*6;break;case"Basis":t+=this.size_UInt32()*9;break;case"Transform3D":t+=this.size_UInt32()*12;break;case"Color":t+=this.size_UInt32()*4;break}break}return t}};var Hc=class{decode_variant(e){let t=this.decode_UInt32(e);switch(t&255){case 1:return this.decode_UInt32(e)!==0;case 2:return t&Xt?this.decode_Int64(e):this.decode_Int32(e);case 3:return t&Xt?this.decode_Float64(e):this.decode_Float32(e);case 4:return this.decode_String(e);case 5:return t&Xt?this.decode_Vector2d(e):this.decode_Vector2f(e);case 6:return this.decode_Vector2i(e);case 7:return t&Xt?this.decode_Rect2d(e):this.decode_Rect2f(e);case 8:return this.decode_Rect2i(e);case 9:return t&Xt?this.decode_Vector3d(e):this.decode_Vector3f(e);case 10:return this.decode_Vector3i(e);case 11:return t&Xt?this.decode_Transform2Dd(e):this.decode_Transform2Df(e);case 14:return t&Xt?this.decode_Planed(e):this.decode_Planef(e);case 12:return t&Xt?this.decode_Vector4d(e):this.decode_Vector4f(e);case 13:return this.decode_Vector4i(e);case 15:return t&Xt?this.decode_Quaterniond(e):this.decode_Quaternionf(e);case 16:return t&Xt?this.decode_AABBd(e):this.decode_AABBf(e);case 17:return t&Xt?this.decode_Basisd(e):this.decode_Basisf(e);case 18:return t&Xt?this.decode_Transform3Dd(e):this.decode_Transform3Df(e);case 19:return t&Xt?this.decode_Projectiond(e):this.decode_Projectionf(e);case 20:return this.decode_Color(e);case 21:return this.decode_StringName(e);case 22:return this.decode_NodePath(e);case 23:return this.decode_RID(e);case 24:return t&Gc?this.decode_Object_id(e):this.decode_Object(e);case 25:return this.decode_Callable(e);case 26:return this.decode_Signal(e);case 27:return this.decode_Dictionary(e);case 28:return this.decode_Array(e);case 29:return this.decode_PackedByteArray(e);case 30:return this.decode_PackedInt32Array(e);case 31:return this.decode_PackedInt64Array(e);case 32:return this.decode_PackedFloat32Array(e);case 33:return this.decode_PackedFloat32Array(e);case 34:return this.decode_PackedStringArray(e);case 35:return t&Gc?this.decode_PackedVector2dArray(e):this.decode_PackedVector2fArray(e);case 36:return t&Gc?this.decode_PackedVector3dArray(e):this.decode_PackedVector3fArray(e);case 37:return this.decode_PackedColorArray(e);default:return}}get_dataset(e){let t=e.readUInt32LE(0);if(e.length!=t+4)return;let n={buffer:e,offset:4,len:t},i=[];i.push(t+4);do{let s=this.decode_variant(n);if(s===void 0)throw new Error("Unable to decode variant.");i.push(s)}while(n.len>0);return i}decode_AABBf(e){return new yi(this.decode_Vector3f(e),this.decode_Vector3f(e))}decode_AABBd(e){return new yi(this.decode_Vector3d(e),this.decode_Vector3d(e))}decode_Array(e){let t=[],n=this.decode_UInt32(e);for(let i=0;i<n;i++){let s=this.decode_variant(e);t.push(s)}return t}decode_Basisf(e){return new vi(this.decode_Vector3f(e),this.decode_Vector3f(e),this.decode_Vector3f(e))}decode_Basisd(e){return new vi(this.decode_Vector3d(e),this.decode_Vector3d(e),this.decode_Vector3d(e))}decode_Color(e){let t=this.decode_Vector3f(e),n=this.decode_Float32(e);return new Ss(t.x,t.y,t.z,n)}decode_Dictionary(e){let t=new Map,n=this.decode_UInt32(e);for(let i=0;i<n;i++){let s=this.decode_variant(e),o=this.decode_variant(e);t.set(s,o)}return t}decode_Float32(e){let t=e.buffer.readFloatLE(e.offset);return e.offset+=4,e.len-=4,t}decode_Float64(e){let t=e.buffer.readDoubleLE(e.offset);return e.offset+=8,e.len-=8,t}decode_Int32(e){let t=e.buffer.readInt32LE(e.offset);return e.len-=4,e.offset+=4,t}decode_UInt32(e){let t=e.buffer.readUInt32LE(e.offset);return e.len-=4,e.offset+=4,t}decode_Int64(e){let t=e.buffer.readBigInt64LE(e.offset);return e.len-=8,e.offset+=8,t}decode_UInt64(e){let t=e.buffer.readBigUInt64LE(e.offset);return e.len-=8,e.offset+=8,t}decode_NodePath(e){let t=this.decode_UInt32(e)&2147483647,n=this.decode_UInt32(e),i=this.decode_UInt32(e),s=(i&1)===1;i&2&&n++;let o=t+n,a=[],c=[];for(let u=0;u<o;u++){let h=this.decode_String(e);u<t?a.push(h):c.push(h)}return new jc(a,c,s)}decode_Object(e){let t=this.decode_String(e),n=this.decode_UInt32(e),i=new Cs(t);for(let s=0;s<n;s++){let o=this.decode_String(e),a=this.decode_variant(e);i.set(o,a)}return i}decode_Object_id(e){let t=this.decode_UInt64(e);return new Ur(t)}decode_RID(e){let t=this.decode_UInt64(e);return new Bc(t)}decode_Callable(e){return new Uc}decode_Signal(e){return new zc(this.decode_String(e),this.decode_Object_id(e))}decode_Planef(e){let t=this.decode_Float32(e),n=this.decode_Float32(e),i=this.decode_Float32(e),s=this.decode_Float32(e);return new wi(t,n,i,s)}decode_Planed(e){let t=this.decode_Float64(e),n=this.decode_Float64(e),i=this.decode_Float64(e),s=this.decode_Float64(e);return new wi(t,n,i,s)}decode_PackedByteArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(e.buffer.readUInt8(e.offset)),e.offset++,e.len--;return n}decode_PackedColorArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Color(e));return n}decode_PackedFloat32Array(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Float32(e));return n}decode_PackedFloat64Array(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Float64(e));return n}decode_PackedInt32Array(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Int32(e));return n}decode_PackedInt64Array(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Int64(e));return n}decode_PackedStringArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_String(e));return n}decode_PackedVector2fArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Vector2f(e));return n}decode_PackedVector3fArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Vector3f(e));return n}decode_PackedVector2dArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Vector2d(e));return n}decode_PackedVector3dArray(e){let t=this.decode_UInt32(e),n=[];for(let i=0;i<t;i++)n.push(this.decode_Vector3d(e));return n}decode_Quaternionf(e){let t=this.decode_Float32(e),n=this.decode_Float32(e),i=this.decode_Float32(e),s=this.decode_Float32(e);return new Ri(t,n,i,s)}decode_Quaterniond(e){let t=this.decode_Float64(e),n=this.decode_Float64(e),i=this.decode_Float64(e),s=this.decode_Float64(e);return new Ri(t,n,i,s)}decode_Rect2f(e){return new zr(this.decode_Vector2f(e),this.decode_Vector2f(e))}decode_Rect2d(e){return new zr(this.decode_Vector2d(e),this.decode_Vector2d(e))}decode_Rect2i(e){return new xs(this.decode_Vector2f(e),this.decode_Vector2f(e))}decode_String(e){let t=this.decode_UInt32(e),n=0;t%4!==0&&(n=4-t%4);let i=e.buffer.toString("utf8",e.offset,e.offset+t);return t+=n,e.offset+=t,e.len-=t,i}decode_StringName(e){return new Ei(this.decode_String(e))}decode_Transform3Df(e){return new Ci(this.decode_Basisf(e),this.decode_Vector3f(e))}decode_Transform3Dd(e){return new Ci(this.decode_Basisd(e),this.decode_Vector3d(e))}decode_Projectionf(e){return new Si(this.decode_Vector4f(e),this.decode_Vector4f(e),this.decode_Vector4f(e),this.decode_Vector4f(e))}decode_Projectiond(e){return new Si(this.decode_Vector4d(e),this.decode_Vector4d(e),this.decode_Vector4d(e),this.decode_Vector4d(e))}decode_Transform2Df(e){return new xi(this.decode_Vector2f(e),this.decode_Vector2f(e),this.decode_Vector2f(e))}decode_Transform2Dd(e){return new xi(this.decode_Vector2d(e),this.decode_Vector2d(e),this.decode_Vector2d(e))}decode_Vector2f(e){let t=this.decode_Float32(e),n=this.decode_Float32(e);return new Br(t,n)}decode_Vector2d(e){let t=this.decode_Float64(e),n=this.decode_Float64(e);return new Br(t,n)}decode_Vector2i(e){let t=this.decode_Int32(e),n=this.decode_Int32(e);return new Rs(t,n)}decode_Vector3f(e){let t=this.decode_Float32(e),n=this.decode_Float32(e),i=this.decode_Float32(e);return new $r(t,n,i)}decode_Vector3d(e){let t=this.decode_Float64(e),n=this.decode_Float64(e),i=this.decode_Float64(e);return new $r(t,n,i)}decode_Vector3i(e){let t=this.decode_Int32(e),n=this.decode_Int32(e),i=this.decode_Int32(e);return new ys(t,n,i)}decode_Vector4f(e){let t=this.decode_Float32(e),n=this.decode_Float32(e),i=this.decode_Float32(e),s=this.decode_Float32(e);return new jr(t,n,i,s)}decode_Vector4d(e){let t=this.decode_Float64(e),n=this.decode_Float64(e),i=this.decode_Float64(e),s=this.decode_Float64(e);return new jr(t,n,i,s)}decode_Vector4i(e){let t=this.decode_Int32(e),n=this.decode_Int32(e),i=this.decode_Int32(e),s=this.decode_Int32(e);return new ws(t,n,i,s)}};var Ly=require("net"),yt=Te("debugger.controller",{output:"Godot Debugger"}),qy=Te("debugger.socket"),Vh=class{command="";paramCount=-1;parameters=[];complete=!1;threadId=0},Kc=class{constructor(e){this.session=e}commandBuffer=[];encoder=new Wc;decoder=new Hc;draining=!1;exception="";threadId;server;socket;steppingOut=!1;didFirstOutput=!1;partialStackVars=new ss;connectedVersion="";break(){this.send_command("break")}continue(){this.send_command("continue")}next(){this.send_command("next")}step(){this.send_command("step")}step_out(){this.steppingOut=!0,this.send_command("next")}set_breakpoint(e,t){this.send_command("breakpoint",[e,t,!0])}remove_breakpoint(e,t){this.session.debug_data.remove_breakpoint(e,t),this.send_command("breakpoint",[e,t,!1])}request_inspect_object(e){this.send_command("scene:inspect_object",[e])}request_scene_tree(){this.send_command("scene:request_scene_tree")}request_stack_dump(){this.send_command("get_stack_dump")}request_stack_frame_vars(e){this.send_command("get_stack_frame_vars",[e])}set_object_property(e,t,n){this.send_command("scene:set_object_property",[e,t,n])}set_exception(e){this.exception=e}async start_game(e){yt.info("Starting game process");let t,n;if(e.editor_path)switch(yt.info("Using 'editor_path' variable from launch.json"),t=e.editor_path.replace(/^"/,"").replace(/"$/,""),yt.info(`Verifying version of '${t}'`),n=Pn(t,"4"),yt.info(`Verification result: ${n.status}, version: "${n.version}"`),n.status){case"WRONG_VERSION":{let c=`Cannot launch debug session: The current project uses Godot v${await en()}, but the specified Godot executable is v${n.version}`;yt.warn(c),Rr.window.showErrorMessage(c,"Ok"),this.abort();return}case"INVALID_EXE":{let a=`Cannot launch debug session: '${t}' is not a valid Godot executable`;yt.warn(a),Rr.window.showErrorMessage(a,"Ok"),this.abort();return}}else{yt.info("Using 'editorPath.godot4' from settings");let a="editorPath.godot4";switch(t=Ve(a).replace(/^"/,"").replace(/"$/,""),yt.info(`Verifying version of '${t}'`),n=Pn(t,"4"),yt.info(`Verification result: ${n.status}, version: "${n.version}"`),n.status){case"WRONG_VERSION":{let u=`Cannot launch debug session: The current project uses Godot v${await en()}, but the specified Godot executable is v${n.version}`;yt.warn(u),pn(u,a),this.abort();return}case"INVALID_EXE":{let c=`Cannot launch debug session: '${t}' is not a valid Godot executable`;yt.warn(c),pn(c,a),this.abort();return}}}this.connectedVersion=n.version;let i=`"${t}" --path "${e.project}"`,s=e.address.replace("tcp://","");if(i+=` --remote-debug "tcp://${s}:${e.port}"`,e.profiling&&(i+=" --profiling"),e.single_threaded_scene&&(i+=" --single-threaded-scene"),e.debug_collisions&&(i+=" --debug-collisions"),e.debug_paths&&(i+=" --debug-paths"),e.debug_navigation&&(i+=" --debug-navigation"),e.debug_avoidance&&(i+=" --debug-avoidance"),e.debug_stringnames&&(i+=" --debug-stringnames"),e.frame_delay&&(i+=` --frame-delay ${e.frame_delay}`),e.time_scale&&(i+=` --time-scale ${e.time_scale}`),e.disable_vsync&&(i+=" --disable-vsync"),e.fixed_fps&&(i+=` --fixed-fps ${e.fixed_fps}`),e.scene&&e.scene!=="main"){yt.info(`Custom scene argument provided: ${e.scene}`);let a=e.scene;if(e.scene==="current"){let c=Rr.window.activeTextEditor.document.fileName;if(c.endsWith(".gd")&&(c=c.replace(".gd",".tscn"),!Gh.existsSync(c))){let u=`Can't find associated scene file for ${c}`;yt.warn(u),Rr.window.showErrorMessage(u,"Ok"),this.abort();return}a=c}if(e.scene==="pinned"){if(!ot){let u="No pinned scene found";yt.warn(u),Rr.window.showErrorMessage(u,"Ok"),this.abort();return}let c=ot.fsPath;if(c.endsWith(".gd")&&(c=c.replace(".gd",".tscn"),!Gh.existsSync(c))){let u=`Can't find associated scene file for ${c}`;yt.warn(u),Rr.window.showErrorMessage(u,"Ok"),this.abort();return}a=c}i+=` "${a}"`}i+=this.session.debug_data.get_breakpoint_string(),e.additional_options&&(i+=" "+e.additional_options),yt.info(`Launching game process using command: '${i}'`);let o=qr("debug",i,{shell:!0});o.stdout.on("data",a=>{}),o.stderr.on("data",a=>{}),o.on("close",a=>{})}stash;on_data(e){this.stash&&(e=Buffer.concat([this.stash,e]),this.stash=void 0);let t=Ay(e);for(;t.length>0;){let n=t.shift(),i=this.decoder.get_dataset(n)?.slice(1);if(i===void 0){this.stash=Buffer.alloc(n.length),n.copy(this.stash);return}qy.debug("rx:",i[0]);let s=this.parse_message(i[0]);this.handle_command(s)}}async launch(e){yt.info("Starting debug controller in 'launch' mode"),this.server=Ly.createServer(t=>{this.socket=t,t.on("data",this.on_data.bind(this)),t.on("close",n=>{this.abort()}),t.on("end",()=>{this.abort()}),t.on("error",n=>{}),t.on("drain",()=>{t.resume(),this.draining=!1,this.send_buffer()})}),e.port===-1&&(e.port=await Pi()),this.server.listen(e.port,e.address),this.start_game(e)}async attach(e){yt.info("Starting debug controller in 'attach' mode"),this.server=Ly.createServer(t=>{this.socket=t,t.on("data",this.on_data.bind(this)),t.on("close",n=>{}),t.on("end",()=>{}),t.on("error",n=>{}),t.on("drain",()=>{t.resume(),this.draining=!1,this.send_buffer()})}),this.server.listen(e.port,e.address)}parse_message(e){let t=new Vh,n=0;return t.command=e[n++],this.connectedVersion[2]>="2"&&(t.threadId=e[n++]),t.parameters=e[n++],t}handle_command(e){switch(e.command){case"debug_enter":{let t=e.parameters[1];t!=="Breakpoint"?this.set_exception(t):this.set_exception(""),this.request_stack_dump();break}case"debug_exit":break;case"message:click_ctrl":break;case"performance:profile_frame":break;case"set_pid":this.threadId=e.threadId;break;case"scene:scene_tree":{let t=Uh(e.parameters);this.session.sceneTree.fill_tree(t);break}case"scene:inspect_object":{let t=BigInt(e.parameters[0]),n=e.parameters[1],i=e.parameters[2],s=new Cs(n);i.forEach(a=>{s.set(a[0],a[5])});let o={name:"",value:s};Vc(o),this.session.inspect_callbacks.has(BigInt(t))&&(this.session.inspect_callbacks.get(BigInt(t))(o.name,o),this.session.inspect_callbacks.delete(BigInt(t))),this.session.set_inspection(t,o);break}case"stack_dump":{let t=[];for(let n=1;n<e.parameters.length;n+=3)t.push({id:t.length,file:e.parameters[n+0],line:e.parameters[n+1],function:e.parameters[n+2]});this.trigger_breakpoint(t),this.request_scene_tree();break}case"stack_frame_vars":{this.partialStackVars.reset(e.parameters[0]),this.session.set_scopes(this.partialStackVars);break}case"stack_frame_var":{this.do_stack_frame_var(e.parameters[0],e.parameters[1],e.parameters[2],e.parameters[3]);break}case"output":{this.didFirstOutput||(this.didFirstOutput=!0);let t=e.parameters[0];for(let n of t)Rr.debug.activeDebugConsole.appendLine(n);break}}}abort(){yt.info("Aborting debug controller"),this.session.sendEvent(new Es.TerminatedEvent),this.stop()}stop(){yt.info("Stopping debug controller"),vr("debug"),this.socket?.destroy(),this.server?.close(e=>{e&&yt.error(e),this.server.unref(),this.server=void 0})}trigger_breakpoint(e){let t=!1,n=e.length;if(n===0){this.session.debug_data.last_frames=[],this.session.sendEvent(new Es.StoppedEvent("breakpoint",0));return}let i=e[0].file.replace("res://",`${this.session.debug_data.projectPath}/`),s=e[0].line;if(this.steppingOut&&!this.session.debug_data.get_breakpoints(i).find(a=>a.line===s))if(this.session.debug_data.stack_count>1)t=this.session.debug_data.stack_count===n;else{let a=e[0].file===this.session.debug_data.last_frame.file,c=e[0].function===this.session.debug_data.last_frame.function,u=e[0].line>=this.session.debug_data.last_frame.line;t=a&&c&&u}if(this.session.debug_data.stack_count=n,this.session.debug_data.last_frame=e[0],this.session.debug_data.last_frames=e,t){this.next();return}this.steppingOut=!1,this.session.debug_data.stack_files=e.map(o=>o.file),this.exception.length===0?this.session.sendEvent(new Es.StoppedEvent("breakpoint",0)):(this.session.set_exception(!0),this.session.sendEvent(new Es.StoppedEvent("exception",0,this.exception)))}send_command(e,t){let n=[e];this.connectedVersion[2]>="2"&&n.push(this.threadId),n.push(t??[]),qy.debug("tx:",n);let i=this.encoder.encode_variant(n);this.commandBuffer.push(i),this.send_buffer()}send_buffer(){if(this.socket)for(;!this.draining&&this.commandBuffer.length>0;){let e=this.commandBuffer.shift();this.draining=!this.socket.write(e)}}do_stack_frame_var(e,t,n,i){if(this.partialStackVars.remaining===0)throw new Error("More stack frame variables were sent than expected.");let s={name:e,value:i,type:n};Vc(s);let o=["locals","members","globals"][t];this.partialStackVars[o].push(s),this.partialStackVars.remaining--,this.partialStackVars.remaining===0&&this.session.set_scopes(this.partialStackVars)}};var Eq=Te("debugger.session",{output:"Godot Debugger"}),Yc=class extends Cn.LoggingDebugSession{all_scopes;controller=new Kc(this);debug_data=new os(this);sceneTree;exception=!1;got_scope=new Wh.Subject;ongoing_inspections=[];previous_inspections=[];configuration_done=new Wh.Subject;mode="";inspect_callbacks=new Map;constructor(){super(),this.setDebuggerLinesStartAt1(!1),this.setDebuggerColumnsStartAt1(!1)}dispose(){this.controller.stop()}initializeRequest(e,t){e.body=e.body||{},e.body.supportsConfigurationDoneRequest=!0,e.body.supportsTerminateRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsLogPoints=!1,e.body.supportsModulesRequest=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsRestartFrame=!1,e.body.supportsRestartRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsTerminateThreadsRequest=!1,this.sendResponse(e),this.sendEvent(new Cn.InitializedEvent)}async launchRequest(e,t){await this.configuration_done.wait(1e3),this.mode="launch",this.debug_data.projectPath=t.project,this.exception=!1,await this.controller.launch(t),this.sendResponse(e)}async attachRequest(e,t){await this.configuration_done.wait(1e3),this.mode="attach",this.exception=!1,await this.controller.attach(t),this.sendResponse(e)}configurationDoneRequest(e,t){this.configuration_done.notify(),this.sendResponse(e)}continueRequest(e,t){this.exception||(e.body={allThreadsContinued:!0},this.controller.continue(),this.sendResponse(e))}async evaluateRequest(e,t){if(await My.debug.activeDebugSession.customRequest("scopes",{frameId:0}),this.all_scopes){var n=this.get_variable(t.expression,null,null,null);if(n.error==null){var i=zh(n.variable);e.body={result:i.value,variablesReference:Ny(n.variable)?0:n.index}}else e.success=!1,e.message=n.error}e.body||(e.body={result:"null",variablesReference:0}),this.sendResponse(e)}nextRequest(e,t){this.exception||(this.controller.next(),this.sendResponse(e))}pauseRequest(e,t){this.exception||(this.controller.break(),this.sendResponse(e))}async scopesRequest(e,t){this.controller.request_stack_frame_vars(t.frameId),await this.got_scope.wait(2e3),e.body={scopes:[{name:"Locals",variablesReference:1,expensive:!1},{name:"Members",variablesReference:2,expensive:!1},{name:"Globals",variablesReference:3,expensive:!1}]},this.sendResponse(e)}setBreakPointsRequest(e,t){let n=t.source.path.replace(/\\/g,"/"),i=t.lines||[];if(Fy.existsSync(n)){let s=this.debug_data.get_breakpoints(n),o=s.map(a=>a.line);s.forEach(a=>{i.indexOf(a.line)===-1&&this.debug_data.remove_breakpoint(n,a.line)}),i.forEach(a=>{o.indexOf(a)===-1&&(t.breakpoints.find(u=>u.line==a).condition||this.debug_data.set_breakpoint(n,a))}),s=this.debug_data.get_breakpoints(n),s.sort((a,c)=>a.line<c.line?-1:1),e.body={breakpoints:s.map(a=>new Cn.Breakpoint(!0,a.line,1,new Cn.Source(a.file.split("/").reverse()[0],a.file)))},this.sendResponse(e)}}stackTraceRequest(e,t){this.debug_data.last_frame&&(e.body={totalFrames:this.debug_data.last_frames.length,stackFrames:this.debug_data.last_frames.map(n=>({id:n.id,name:n.function,line:n.line,column:1,source:new Cn.Source(n.file,`${this.debug_data.projectPath}/${n.file.replace("res://","")}`)}))}),this.sendResponse(e)}stepInRequest(e,t){this.exception||(this.controller.step(),this.sendResponse(e))}stepOutRequest(e,t){this.exception||(this.controller.step_out(),this.sendResponse(e))}terminateRequest(e,t){this.mode==="launch"&&(this.controller.stop(),this.sendEvent(new Cn.TerminatedEvent)),this.sendResponse(e)}threadsRequest(e){e.body={threads:[new Cn.Thread(0,"thread_1")]},this.sendResponse(e)}async variablesRequest(e,t){if(!this.all_scopes){e.body={variables:[]},this.sendResponse(e);return}let n=this.all_scopes[t.variablesReference],i;n.sub_values?i=n.sub_values.map(s=>{let o=this.all_scopes.find(a=>a&&a.scope_path===s.scope_path&&a.name===s.name);if(o)return zh(o,this.all_scopes.findIndex(a=>a&&a.scope_path===`${n.scope_path}.${n.name}`&&a.name===s.name))}):i=[],e.body={variables:i},this.sendResponse(e)}set_exception(e){this.exception=!0}set_scopes(e){this.all_scopes=[void 0,{name:"local",value:void 0,sub_values:e.locals,scope_path:"@"},{name:"member",value:void 0,sub_values:e.members,scope_path:"@"},{name:"global",value:void 0,sub_values:e.globals,scope_path:"@"}],e.locals.forEach(t=>{t.scope_path="@.local",this.append_variable(t)}),e.members.forEach(t=>{t.scope_path="@.member",this.append_variable(t)}),e.globals.forEach(t=>{t.scope_path="@.global",this.append_variable(t)}),this.add_to_inspections(),this.ongoing_inspections.length===0&&(this.previous_inspections=[],this.got_scope.notify())}set_inspection(e,t){this.all_scopes.filter(i=>i&&i.value instanceof Ur&&i.value.id===e).forEach(i=>{let s=this.all_scopes.findIndex(a=>a===i),o=this.all_scopes.splice(s,1);t.name=o[0].name,t.scope_path=o[0].scope_path,this.append_variable(t,s)}),this.ongoing_inspections.splice(this.ongoing_inspections.findIndex(i=>i===e),1),this.previous_inspections.push(e),this.ongoing_inspections.length===0&&(this.previous_inspections=[],this.got_scope.notify())}add_to_inspections(){this.all_scopes.forEach(e=>{e&&e.value instanceof Ur&&!this.ongoing_inspections.includes(e.value.id)&&!this.previous_inspections.includes(e.value.id)&&(this.controller.request_inspect_object(e.value.id),this.ongoing_inspections.push(e.value.id))})}get_variable(e,t=null,n=0,i=null){var s={variable:null,index:null,object_id:null,error:null};t||(e.includes("self")||(e="self."+e),t=this.all_scopes.find(f=>f&&f.name=="self"),i=this.all_scopes.find(f=>f&&f.name=="id"&&f.scope_path=="@.member.self").value);var o=e.split("."),a=o[n+1],c=o.slice(0,n+1).join(".").split("self.").join("").split("self").join("").split("[").join(".").split("]").join("");o.length==1&&o[0]=="self"&&(a="self");var u=(a.match(/(?<=\[).*(?=\])/)||[null])[0];u&&(u=u.replace(/['"]+/g,""),a=a.split(/(?<=\[).*(?=\])/).join("").split("[]").join(""),c&&(c+="."),c+=a,a=u);function h(f){return f.split("Members/").join("").split("Locals/").join("")}function v(f){return f.split("@.member.self.").join("").split("@.member.self").join("").split("@.member.").join("").split("@.member").join("").split("@.local.").join("").split("@.local").join("").split("Locals/").join("").split("Members/").join("").split("@").join("")}var m=this.all_scopes.filter(f=>f).map(function(f){return{sanitized:{name:h(f.name),scope_path:v(f.scope_path)},real:f}});if(s.variable=m.find(f=>f.sanitized.name==a&&f.sanitized.scope_path==c)?.real,!s.variable)return s.error=`Could not find: ${a}`,s;if(t.value.entries)if(s.variable.name=="self")s.object_id=this.all_scopes.find(f=>f&&f.name=="id"&&f.scope_path=="@.member.self").value;else if(u){var b=c.split(".")[c.split(".").length-1],k=Array.from(t.value.entries()).find(f=>f&&f[0].split("Members/").join("").split("Locals/").join("")==b)[1];s.object_id=k.get?k.get(u)?.id:k[u]?.id}else{let _=Array.from(t.value.entries()).find(w=>w&&w[0].split("Members/").join("").split("Locals/").join("")==a);s.object_id=_?.[1].id}return s.object_id||(s.object_id=i),s.index=this.all_scopes.findIndex(f=>f&&f.name==s.variable.name&&f.scope_path==s.variable.scope_path),o.length>2&&n<o.length-2&&(s=this.get_variable(o.join("."),s.variable,n+1,s.object_id)),s}append_variable(e,t){t?this.all_scopes.splice(t,0,e):this.all_scopes.push(e);let n=`${e.scope_path}.${e.name}`;e.sub_values&&e.sub_values.forEach((i,s)=>{i.scope_path=n,this.append_variable(i,t?t+s+1:void 0)})}};var Gr=require("vscode");var Xc=class{_on_did_change_tree_data=new Gr.EventEmitter;tree;onDidChangeTreeData=this._on_did_change_tree_data.event;constructor(){}clean_up(){this.tree&&(this.tree=void 0,this._on_did_change_tree_data.fire(void 0))}fill_tree(e,t,n,i){this.tree=this.parse_variable(i,n),this.tree.label=e,this.tree.collapsibleState=Gr.TreeItemCollapsibleState.Expanded,this.tree.description=t,this._on_did_change_tree_data.fire(void 0)}getChildren(e){return this.tree?e?Promise.resolve(e.properties):Promise.resolve([this.tree]):Promise.resolve([])}getTreeItem(e){return e}get_changed_value(e,t,n){let i=e.length-1,s=e[i].value;if(Array.isArray(s)){let o=parseInt(t.label);o<s.length&&(s[o]=n)}else s instanceof Map?s.set(t.parent.value.key,n):s[t.label]&&(s[t.label]=n);return s}get_top_id(){if(this.tree)return this.tree.object_id}get_top_name(){if(this.tree)return this.tree.label}has_tree(){return this.tree!==void 0}parse_variable(e,t){let n=e.value,i="";typeof n=="number"?Number.isInteger(n)?i=`${n}`:i=`${parseFloat(n.toFixed(5))}`:typeof n=="bigint"||typeof n=="boolean"||typeof n=="string"?i=`${n}`:typeof n>"u"?i="null":Array.isArray(n)?i=`Array[${n.length}]`:n instanceof Map?n instanceof No?i=`${n.class_name}`:i=`Dictionary[${n.size}]`:i=`${n.type_name()}${n.stringify_value()}`;let s=[];n&&(s=(typeof n.sub_values=="function"&&!(n instanceof Lo)?n.sub_values():Array.isArray(n)?n.map((c,u)=>({name:`${u}`,value:c})):n instanceof Map?Array.from(n.keys()).map(c=>{let u=typeof c.rendered_value=="function"?c.rendered_value():`${c}`,h=n.get(c);return{name:u,value:h}}):[])?.map(c=>this.parse_variable(c,t)));let o=new Hh(e.name,n,t,s,s.length===0?Gr.TreeItemCollapsibleState.None:Gr.TreeItemCollapsibleState.Collapsed);return o.description=i,o.properties.forEach(a=>{a.parent=o}),o.description=i,n instanceof Lo?(o.contextValue="remote_object",o.object_id=Number(n.id)):typeof n=="number"||typeof n=="bigint"||typeof n=="boolean"||typeof n=="string"?o.contextValue="editable_value":(Array.isArray(n)||n instanceof Map&&!(n instanceof No))&&o.properties.forEach(a=>a.changes_parent=!0),o}},Hh=class extends Gr.TreeItem{constructor(t,n,i,s,o){super(t,o);this.label=t;this.value=n;this.object_id=i;this.properties=s;this.collapsibleState=o}changes_parent;parent};var gn=Te("debugger",{output:"Godot Debugger"}),ot,Qc=class{constructor(e){this.context=e;gn.info("Initializing Godot Debugger"),this.restore_pinned_file(),e.subscriptions.push(Ze.debug.registerDebugConfigurationProvider("godot",this),Ze.debug.registerDebugAdapterDescriptorFactory("godot",this),Ze.window.registerTreeDataProvider("inspectNode",this.inspectorProvider),Ze.window.registerTreeDataProvider("activeSceneTree",this.sceneTreeProvider),Ze.window.registerFileDecorationProvider(this),Ke("debugger.inspectNode",this.inspect_node.bind(this)),Ke("debugger.refreshSceneTree",this.refresh_scene_tree.bind(this)),Ke("debugger.refreshInspector",this.refresh_inspector.bind(this)),Ke("debugger.editValue",this.edit_value.bind(this)),Ke("debugger.debugCurrentFile",this.debug_current_file.bind(this)),Ke("debugger.debugPinnedFile",this.debug_pinned_file.bind(this)),Ke("debugger.pinFile",this.pin_file.bind(this)),Ke("debugger.unpinFile",this.unpin_file.bind(this)),Ke("debugger.openPinnedFile",this.open_pinned_file.bind(this)))}session;inspectorProvider=new Xc;sceneTreeProvider=new Nc;_onDidChangeFileDecorations=new Ze.EventEmitter;get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}provideFileDecoration(e,t){if(e.scheme==="file"&&ot&&e.fsPath===ot.fsPath)return{badge:"\u{1F588}"}}async createDebugAdapterDescriptor(e){gn.info("Creating debug session");let t=await en();return gn.info(`Project version identified as ${t}`),t.startsWith("4")?this.session=new Yc:this.session=new $c,this.context.subscriptions.push(this.session),this.session.sceneTree=this.sceneTreeProvider,new Ze.DebugAdapterInlineImplementation(this.session)}resolveDebugConfiguration(e,t,n){if(t.request||(t.request="launch"),t.request==="launch"&&(t.address||(t.address="127.0.0.1"),t.port||(t.port=-1),t.project||(t.project="${workspaceFolder}")),typeof t.port!="number"||t.port<-1||t.port>65535){Ze.window.showErrorMessage("Can't launch debug session: 'port' must be a number between -1 and 65535.","Ok");return}if(t.address.includes("://")){Ze.window.showErrorMessage("Can't launch debug session: 'address' cannot include a protocol.","Ok");return}return t}debug_current_file(){gn.info("Attempting to debug current file");let e=Ze.workspace.getConfiguration("launch",Ze.window.activeTextEditor.document.uri).get("configurations"),t=e.filter(a=>a.request==="launch"),n=e.filter(a=>a.scene==="current"),i=Ze.window.activeTextEditor.document.fileName;if(i.endsWith(".gd")){let a=i.replace(".gd",".tscn");if(!Kh.existsSync(a)){gn.warn(`Can't find associated scene for '${i}', aborting debug`),Ze.window.showWarningMessage(`Can't find associated scene file for '${i}'`);return}i=a}let s={name:`Debug ${i} : 'File'}`,type:"godot",request:"launch",scene:"current"},o=n[0]??t[0]??e[0]??s;o.scene=i,gn.info(`Starting debug session for '${i}'`),Ze.debug.startDebugging(Ze.workspace.workspaceFolders[0],o)}debug_pinned_file(){gn.info("Attempting to debug pinned scene");let e=Ze.workspace.getConfiguration("launch",ot).get("configurations"),t=e.filter(a=>a.request==="launch"),n=e.filter(a=>a.scene==="pinned");if(!ot){gn.warn("No pinned scene found, aborting debug"),Ze.window.showWarningMessage("No pinned scene found");return}let i=ot.fsPath;if(i.endsWith(".gd")){let a=i.replace(".gd",".tscn");if(!Kh.existsSync(a)){gn.warn(`Can't find associated scene for '${i}', aborting debug`),Ze.window.showWarningMessage(`Can't find associated scene file for '${i}'`);return}i=a}let s={name:`Debug ${i} : 'File'}`,type:"godot",request:"launch",scene:"pinned"},o=n[0]??t[0]??e[0]??s;o.scene=i,gn.info(`Starting debug session for '${i}'`),Ze.debug.startDebugging(Ze.workspace.workspaceFolders[0],o)}pin_file(e){e===void 0&&(e=Ze.window.activeTextEditor.document.uri),gn.info(`Pinning debug target file: '${e.fsPath}'`),ln("pinnedScene",[e.fsPath]),ot&&this._onDidChangeFileDecorations.fire(ot),ot=e,this.context.workspaceState.update("pinnedScene",ot),this._onDidChangeFileDecorations.fire(e)}unpin_file(e){gn.info(`Unpinning debug target file: '${ot}'`),ln("pinnedScene",[]);let t=ot;ot=void 0,this.context.workspaceState.update("pinnedScene",ot),this._onDidChangeFileDecorations.fire(t)}restore_pinned_file(){ot=this.context.workspaceState.get("pinnedScene",void 0),ot&&(gn.info(`Restoring pinned debug target file: '${ot.fsPath}'`),ln("pinnedScene",[ot.fsPath]))}open_pinned_file(){gn.info(`Opening pinned debug target file: '${ot}'`),ot&&Ze.window.showTextDocument(ot)}inspect_node(e){this.session?.controller.request_inspect_object(BigInt(e.object_id)),this.session?.inspect_callbacks.set(BigInt(e.object_id),(t,n)=>{this.inspectorProvider.fill_tree(e.label,t,e.object_id,n)})}refresh_scene_tree(){this.session?.controller.request_scene_tree()}refresh_inspector(){if(this.inspectorProvider.has_tree()){let e=this.inspectorProvider.get_top_name(),t=this.inspectorProvider.get_top_id();this.session?.controller.request_inspect_object(BigInt(t)),this.session?.inspect_callbacks.set(BigInt(t),(n,i)=>{this.inspectorProvider.fill_tree(e,n,t,i)})}}edit_value(e){let t=e.value,n=typeof t,i=n==="number"&&!Number.isInteger(t);Ze.window.showInputBox({value:`${e.description}`}).then(s=>{let o;switch(n){case"string":o=s;break;case"number":if(i){if(o=parseFloat(s),isNaN(o))return}else if(o=parseInt(s),isNaN(o))return;break;case"boolean":if(s.toLowerCase()==="true"||s.toLowerCase()==="false")o=s.toLowerCase()==="true";else if(s==="0"||s==="1")o=s==="1";else return}if(e.changes_parent){let u=[e.parent],h=0;for(;u[h].changes_parent;)u.push(u[h++].parent);let v=this.inspectorProvider.get_changed_value(u,e,o);this.session?.controller.set_object_property(BigInt(e.object_id),u[h].label,v)}else this.session?.controller.set_object_property(BigInt(e.object_id),e.label,o);let a=this.inspectorProvider.get_top_name(),c=this.inspectorProvider.get_top_id();this.session?.controller.request_inspect_object(BigInt(c)),this.session?.inspect_callbacks.set(BigInt(c),(u,h)=>{this.inspectorProvider.fill_tree(a,u,c,h)})})}};var Vy=Se(require("vscode"));var Zc=require("vscode"),Jc=Se(require("fs")),ks=Se($y()),Ts=Se(jy());var By=["and","as","await","break","breakpoint","class_name","class","const","continue","elif","else","enum","export","extends","for","if","in","is","master","mastersync","match","not","onready","or","pass","puppet","puppetsync","remote","remotesync","return","setget","signal","static","tool","var","while","yield"],Uy=["**","<<",">>","==","!=",">=","<=","&&","||","+=","-=","*=","/=","%=","**=","&=","^=","|=","<<=",">>=",":=","->","-","+","/","*",">","<","-","%"];var mF=Te("formatter.tm");function uI(r){return new Promise((e,t)=>{Jc.readFile(r,(n,i)=>n?t(n):e(i))})}var zy=tn("syntaxes/GDScript.tmLanguage.json").fsPath,lI=tn("resources/onig.wasm").fsPath,dI=Jc.readFileSync(lI).buffer,fI=new ks.Registry({onigLib:Ts.loadWASM(dI).then(()=>({createOnigScanner(r){return new Ts.OnigScanner(r)},createOnigString(r){return new Ts.OnigString(r)}})),loadGrammar:r=>r==="source.gdscript"?uI(zy).then(e=>ks.parseRawGrammar(e.toString(),zy)):null});function hI(r){if(r.scopes.includes("string.quoted.gdscript")&&(r.string=!0),r.scopes.includes("meta.function.parameters.gdscript")&&(r.param=!0),r.scopes.includes("meta.literal.nodepath.gdscript")&&(r.skip=!0),By.includes(r.value)){r.type="keyword";return}if(Uy.includes(r.value)){r.type="symbol";return}if(r.scopes.includes("keyword.language.gdscript")){r.type="keyword";return}if(r.scopes.includes("constant.language.gdscript")){r.type="constant";return}if(r.scopes.includes("variable.other.gdscript")){r.type="variable";return}}function pI(r,e){let t=r[e],n=r[e-1],i=t.value,s=n?.value;if(!s)return"";if(i==="#")return" ";if(n.skip&&t.skip)return"";if(t.param){if(s==="-"&&r[e-2]?.value===",")return"";if(i==="%"||s==="%")return" ";if(i==="="||s==="="||i===":="||s===":=")return"";if(n?.type==="symbol"||t.type==="symbol")return" "}if(i===":"){if(["var","const"].includes(r[e-2]?.value))return r[e+1]?.value!=="="||r[e+1]?.value!=="="?"":" ";if(n?.type==="keyword")return""}return s==="@"||s==="-"&&r[e-2]?.value==="("||s===":"&&i==="="||i==="("&&(s==="export"||s==="func"||s==="assert")?"":s===")"&&t.type==="keyword"?" ":s==="["&&t.type==="symbol"?"":s===":"||s===";"||s==="#"||i==="="||s==="="?" ":r[e-2]?.value==="="&&["+","-"].includes(s)||s==="("?"":i==="{"||i==="\\"||i==="{}"||n?.type==="keyword"||t.type==="keyword"||n?.type==="symbol"||t.type==="symbol"||s===","?" ":""}var Qh=null;fI.loadGrammar("source.gdscript").then(r=>{Qh=r});function Gy(r){if(!Qh)return[];let e=[],t=null,n=!0;for(let i=0;i<r.lineCount;i++){let s=r.lineAt(i);if(s.isEmptyOrWhitespace){n?e.push(Zc.TextEdit.delete(s.rangeIncludingLineBreak)):i<r.lineCount-1&&r.lineAt(i+1).isEmptyOrWhitespace&&e.push(Zc.TextEdit.delete(s.rangeIncludingLineBreak));continue}if(n=!1,s.text[s.firstNonWhitespaceCharacterIndex]==="#")continue;let o="";t=Qh.tokenizeLine(s.text,t?.ruleStack??ks.INITIAL);let a=s.text.slice(0,s.firstNonWhitespaceCharacterIndex);o+=a;let c=t.tokens[0];s.text.slice(c.startIndex,c.endIndex).trim()===""&&t.tokens.shift();let u=[];for(let h of t.tokens){let v={scopes:h.scopes,original:s.text.slice(h.startIndex,h.endIndex),value:s.text.slice(h.startIndex,h.endIndex).trim()};hI(v),!(!v.string&&v.value.trim()==="")&&u.push(v)}for(let h=0;h<u.length;h++)h>0&&u[h-1].string===!0&&u[h].string===!0?o+=u[h].original:o+=pI(u,h)+u[h].value.trim();e.push(Zc.TextEdit.replace(s.range,o))}return e}var yF=Te("formatter"),eu=class{constructor(e){this.context=e;let t={language:"gdscript",scheme:"file"};e.subscriptions.push(Vy.languages.registerDocumentFormattingEditProvider(t,this))}provideDocumentFormattingEdits(e){return Gy(e)}};var it={};function gI(r){op(r),it.context=r,it.lsp=new Io(r),it.debug=new Qc(r),it.scenePreviewProvider=new Yo(r),it.linkProvider=new Xo(r),it.hoverProvider=new Qo(r),it.inlayProvider=new Zo(r),it.formattingProvider=new eu(r),it.docsProvider=new ic(r),it.definitionProvider=new Go(r),r.subscriptions.push(Ke("openEditor",wI),Ke("copyResourcePath",bI),Ke("listGodotClasses",vI),Ke("switchSceneScript",yI),Ke("getGodotPath",RI)),ln("godotFiles",["gdscript","gdscene","gdresource","gdshader"]),ln("sceneLikeFiles",["gdscript","gdscene"]),en().then(async()=>{mI()})}async function mI(){let r=await en(),e=`editorPath.godot${r[0]}`,t=Ve(e),n=Pn(t,r[0]);switch(n.status){case"SUCCESS":break;case"WRONG_VERSION":{let i=`The specified Godot executable, '${t}' is the wrong version. 
				The current project uses Godot v${r}, but the specified executable is Godot v${n.version}.
				Extension features will not work correctly unless this is fixed.`;pn(i,e);break}case"INVALID_EXE":{let i=`The specified Godot executable, '${t}' is invalid. 
				Extension features will not work correctly unless this is fixed.`;pn(i,e);break}}}function _I(){return new Promise((r,e)=>{it.lsp.client.stop(),r()})}function bI(r){r||(r=Vn.window.activeTextEditor.document.uri);let e=rr.dirname(iu(r.fsPath));if(e===null)return;let t=rr.normalize(rr.relative(e,r.fsPath));t=t.split(rr.sep).join(rr.posix.sep),t="res://"+t,Vn.env.clipboard.writeText(t)}async function vI(){await it.lsp.client.list_classes()}async function yI(){let r=Vn.window.activeTextEditor.document.uri.fsPath;r.endsWith(".tscn")?r=r.replace(".tscn",".gd"):r.endsWith(".gd")&&(r=r.replace(".gd",".tscn"));let e=await zo(r);e&&Vn.window.showTextDocument(e)}async function wI(){let r=await ki(),e=await en(),t=`editorPath.godot${e[0]}`,n=Ve(t).replace(/^"/,"").replace(/"$/,""),i=Pn(n,e[0]);switch(i.status){case"SUCCESS":{let s=`"${n}" --path "${r}" -e`;Ve("editor.verbose")&&(s+=" -v");let o=Vn.window.terminals.find(u=>u.name==="Godot Editor");o&&o.dispose();let a={name:"Godot Editor",iconPath:tn("resources/godot_icon.svg"),pty:new Zh(s),isTransient:!0},c=Vn.window.createTerminal(a);Ve("editor.revealTerminal")&&c.show();break}case"WRONG_VERSION":{let s=`Cannot launch Godot editor: The current project uses Godot v${e}, but the specified Godot executable is version ${i.version}`;pn(s,t);break}case"INVALID_EXE":{let s=`Cannot launch Godot editor: '${t}' value of '${n}' is not a valid Godot executable`;pn(s,t);break}}}async function RI(){let r=await en();if(r===void 0)return;let e=`editorPath.godot${r[0]}`;return Ve(e).replace(/^"/,"").replace(/"$/,"")}var Zh=class{constructor(e){this.command=e}writeEmitter=new Vn.EventEmitter;onDidWrite=this.writeEmitter.event;closeEmitter=new Vn.EventEmitter;onDidClose=this.closeEmitter.event;open(e){let t=qr("GodotEditor",this.command,{shell:!0,detached:!0});this.writeEmitter.fire(`Starting Godot Editor process...\r
`),t.stdout.on("data",n=>{n.toString().trim()&&this.writeEmitter.fire(n+`\r
`)}),t.stderr.on("data",n=>{n.toString().trim()&&this.writeEmitter.fire(n+`\r
`)}),t.on("close",n=>{this.writeEmitter.fire(`Godot Editor stopped with exit code: ${n}\r
`)})}close(){vr("GodotEditor")}};0&&(module.exports={activate,deactivate,globals});
//! I do not understand why this is necessary
//! if you don't touch this csharp object, it's not imported or something, idk
/*! Bundled license information:

prismjs/prism.js:
  (**
   * Prism: Lightweight, robust, elegant syntax highlighting
   *
   * @license MIT <https://opensource.org/licenses/MIT>
   * @author Lea Verou <https://lea.verou.me>
   * @namespace
   * @public
   *)
*/
